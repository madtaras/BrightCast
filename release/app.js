function parseBoolean(value,valueOnFailure){switch(value){case!0:case"true":case 1:case"1":case"on":case"yes":value=!0;break;case!1:case"false":case 0:case"0":case"off":case"no":value=!1;break;default:value=void 0!==valueOnFailure?valueOnFailure:null}return value}function guid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=16*Math.random()|0;return("x"==c?r:3&r|8).toString(16)})}function getRandomIntFromTo(min,max){var rand=min-.5+Math.random()*(max-min+1);return rand=Math.round(rand)}function secondsTohhmmss(totalSeconds,divider){divider||(divider=":");var hours=Math.floor(totalSeconds/3600),minutes=Math.floor((totalSeconds-3600*hours)/60),seconds=totalSeconds-3600*hours-60*minutes;seconds=Math.floor(seconds);var result="";return hours&&(result+=10>hours?"0"+hours:hours,result+=divider),result+=hours&&10>minutes?"0"+minutes:minutes,result+=divider,result+=10>seconds?"0"+seconds:seconds}function enteredOrExited(changeType){return changeType===Movement.ENTERED||changeType===Movement.EXITED}function escapeQuotes(value){return'"'+value.replace(/"/,'\\"')+'"'}function validateAttribute(attribute){if("string"!=typeof attribute)throw Error("Invalid request opion. attribute must be a non-zero length string.");if(attribute=attribute.trim(),!attribute)throw Error("Invalid request opion. attribute must be a non-zero length string.");if(!attribute.match(attributeFilterPattern))throw Error("Invalid request option. invalid attribute name: "+attribute);return attribute}function validateElementAttributes(attribs){if(!attribs.trim().length)throw Error("Invalid request option: elementAttributes must contain at least one attribute.");for(var lowerAttributes={},attributes={},tokens=attribs.split(/\s+/),i=0;i<tokens.length;i++){var name=tokens[i];if(name){var name=validateAttribute(name),nameLower=name.toLowerCase();if(lowerAttributes[nameLower])throw Error("Invalid request option: observing multiple case variations of the same attribute is not supported.");attributes[name]=!0,lowerAttributes[nameLower]=!0}}return Object.keys(attributes)}function elementFilterAttributes(selectors){var attributes={};return selectors.forEach(function(selector){selector.qualifiers.forEach(function(qualifier){attributes[qualifier.attrName]=!0})}),Object.keys(attributes)}!function(){"use strict";function MaterialTab(tab,ctx){if(tab){if(ctx.element_.classList.contains(ctx.CssClasses_.MDL_JS_RIPPLE_EFFECT)){var rippleContainer=document.createElement("span");rippleContainer.classList.add(ctx.CssClasses_.MDL_RIPPLE_CONTAINER),rippleContainer.classList.add(ctx.CssClasses_.MDL_JS_RIPPLE_EFFECT);var ripple=document.createElement("span");ripple.classList.add(ctx.CssClasses_.MDL_RIPPLE),rippleContainer.appendChild(ripple),tab.appendChild(rippleContainer)}tab.addEventListener("click",function(e){e.preventDefault();var href=tab.href.split("#")[1],panel=ctx.element_.querySelector("#"+href);ctx.resetTabState_(),ctx.resetPanelState_(),tab.classList.add(ctx.CssClasses_.ACTIVE_CLASS),panel.classList.add(ctx.CssClasses_.ACTIVE_CLASS)})}}function MaterialLayoutTab(tab,tabs,panels,layout){if(layout.tabBar_.classList.contains(layout.CssClasses_.JS_RIPPLE_EFFECT)){var rippleContainer=document.createElement("span");rippleContainer.classList.add(layout.CssClasses_.RIPPLE_CONTAINER),rippleContainer.classList.add(layout.CssClasses_.JS_RIPPLE_EFFECT);var ripple=document.createElement("span");ripple.classList.add(layout.CssClasses_.RIPPLE),rippleContainer.appendChild(ripple),tab.appendChild(rippleContainer)}tab.addEventListener("click",function(e){e.preventDefault();var href=tab.href.split("#")[1],panel=layout.content_.querySelector("#"+href);layout.resetTabState_(tabs),layout.resetPanelState_(panels),tab.classList.add(layout.CssClasses_.IS_ACTIVE),panel.classList.add(layout.CssClasses_.IS_ACTIVE)})}var componentHandler={upgradeDom:function(optJsClass,optCssClass){},upgradeElement:function(element,optJsClass){},upgradeElements:function(elements){},upgradeAllRegistered:function(){},registerUpgradedCallback:function(jsClass,callback){},register:function(config){},downgradeElements:function(nodes){}};componentHandler=function(){function findRegisteredClass_(name,optReplace){for(var i=0;i<registeredComponents_.length;i++)if(registeredComponents_[i].className===name)return"undefined"!=typeof optReplace&&(registeredComponents_[i]=optReplace),registeredComponents_[i];return!1}function getUpgradedListOfElement_(element){var dataUpgraded=element.getAttribute("data-upgraded");return null===dataUpgraded?[""]:dataUpgraded.split(",")}function isElementUpgraded_(element,jsClass){var upgradedList=getUpgradedListOfElement_(element);return-1!==upgradedList.indexOf(jsClass)}function upgradeDomInternal(optJsClass,optCssClass){if("undefined"==typeof optJsClass&&"undefined"==typeof optCssClass)for(var i=0;i<registeredComponents_.length;i++)upgradeDomInternal(registeredComponents_[i].className,registeredComponents_[i].cssClass);else{var jsClass=optJsClass;if("undefined"==typeof optCssClass){var registeredClass=findRegisteredClass_(jsClass);registeredClass&&(optCssClass=registeredClass.cssClass)}for(var elements=document.querySelectorAll("."+optCssClass),n=0;n<elements.length;n++)upgradeElementInternal(elements[n],jsClass)}}function upgradeElementInternal(element,optJsClass){if(!("object"==typeof element&&element instanceof Element))throw new Error("Invalid argument provided to upgrade MDL element.");var upgradedList=getUpgradedListOfElement_(element),classesToUpgrade=[];if(optJsClass)isElementUpgraded_(element,optJsClass)||classesToUpgrade.push(findRegisteredClass_(optJsClass));else{var classList=element.classList;registeredComponents_.forEach(function(component){classList.contains(component.cssClass)&&-1===classesToUpgrade.indexOf(component)&&!isElementUpgraded_(element,component.className)&&classesToUpgrade.push(component)})}for(var registeredClass,i=0,n=classesToUpgrade.length;n>i;i++){if(registeredClass=classesToUpgrade[i],!registeredClass)throw new Error("Unable to find a registered component for the given class.");upgradedList.push(registeredClass.className),element.setAttribute("data-upgraded",upgradedList.join(","));var instance=new registeredClass.classConstructor(element);instance[componentConfigProperty_]=registeredClass,createdComponents_.push(instance);for(var j=0,m=registeredClass.callbacks.length;m>j;j++)registeredClass.callbacks[j](element);registeredClass.widget&&(element[registeredClass.className]=instance);var ev=document.createEvent("Events");ev.initEvent("mdl-componentupgraded",!0,!0),element.dispatchEvent(ev)}}function upgradeElementsInternal(elements){Array.isArray(elements)||(elements="function"==typeof elements.item?Array.prototype.slice.call(elements):[elements]);for(var element,i=0,n=elements.length;n>i;i++)element=elements[i],element instanceof HTMLElement&&(upgradeElementInternal(element),element.children.length>0&&upgradeElementsInternal(element.children))}function registerInternal(config){var widgetMissing="undefined"==typeof config.widget&&"undefined"==typeof config.widget,widget=!0;widgetMissing||(widget=config.widget||config.widget);var newConfig={classConstructor:config.constructor||config.constructor,className:config.classAsString||config.classAsString,cssClass:config.cssClass||config.cssClass,widget:widget,callbacks:[]};if(registeredComponents_.forEach(function(item){if(item.cssClass===newConfig.cssClass)throw new Error("The provided cssClass has already been registered: "+item.cssClass);if(item.className===newConfig.className)throw new Error("The provided className has already been registered")}),config.constructor.prototype.hasOwnProperty(componentConfigProperty_))throw new Error("MDL component classes must not have "+componentConfigProperty_+" defined as a property.");var found=findRegisteredClass_(config.classAsString,newConfig);found||registeredComponents_.push(newConfig)}function registerUpgradedCallbackInternal(jsClass,callback){var regClass=findRegisteredClass_(jsClass);regClass&&regClass.callbacks.push(callback)}function upgradeAllRegisteredInternal(){for(var n=0;n<registeredComponents_.length;n++)upgradeDomInternal(registeredComponents_[n].className)}function findCreatedComponentByNodeInternal(node){for(var n=0;n<createdComponents_.length;n++){var component=createdComponents_[n];if(component.element_===node)return component}}function deconstructComponentInternal(component){if(component&&component[componentConfigProperty_].classConstructor.prototype.hasOwnProperty(downgradeMethod_)){component[downgradeMethod_]();var componentIndex=createdComponents_.indexOf(component);createdComponents_.splice(componentIndex,1);var upgrades=component.element_.getAttribute("data-upgraded").split(","),componentPlace=upgrades.indexOf(component[componentConfigProperty_].classAsString);upgrades.splice(componentPlace,1),component.element_.setAttribute("data-upgraded",upgrades.join(","));var ev=document.createEvent("Events");ev.initEvent("mdl-componentdowngraded",!0,!0),component.element_.dispatchEvent(ev)}}function downgradeNodesInternal(nodes){var downgradeNode=function(node){deconstructComponentInternal(findCreatedComponentByNodeInternal(node))};if(nodes instanceof Array||nodes instanceof NodeList)for(var n=0;n<nodes.length;n++)downgradeNode(nodes[n]);else{if(!(nodes instanceof Node))throw new Error("Invalid argument provided to downgrade MDL nodes.");downgradeNode(nodes)}}var registeredComponents_=[],createdComponents_=[],downgradeMethod_="mdlDowngrade",componentConfigProperty_="mdlComponentConfigInternal_";return{upgradeDom:upgradeDomInternal,upgradeElement:upgradeElementInternal,upgradeElements:upgradeElementsInternal,upgradeAllRegistered:upgradeAllRegisteredInternal,registerUpgradedCallback:registerUpgradedCallbackInternal,register:registerInternal,downgradeElements:downgradeNodesInternal}}(),componentHandler.ComponentConfigPublic,componentHandler.ComponentConfig,componentHandler.Component,componentHandler.upgradeDom=componentHandler.upgradeDom,componentHandler.upgradeElement=componentHandler.upgradeElement,componentHandler.upgradeElements=componentHandler.upgradeElements,componentHandler.upgradeAllRegistered=componentHandler.upgradeAllRegistered,componentHandler.registerUpgradedCallback=componentHandler.registerUpgradedCallback,componentHandler.register=componentHandler.register,componentHandler.downgradeElements=componentHandler.downgradeElements,window.componentHandler=componentHandler,window.componentHandler=componentHandler,window.addEventListener("load",function(){"classList"in document.createElement("div")&&"querySelector"in document&&"addEventListener"in window&&Array.prototype.forEach?(document.documentElement.classList.add("mdl-js"),componentHandler.upgradeAllRegistered()):(componentHandler.upgradeElement=function(){},componentHandler.register=function(){})}),Date.now||(Date.now=function(){return(new Date).getTime()},Date.now=Date.now);for(var vendors=["webkit","moz"],i=0;i<vendors.length&&!window.requestAnimationFrame;++i){var vp=vendors[i];window.requestAnimationFrame=window[vp+"RequestAnimationFrame"],window.cancelAnimationFrame=window[vp+"CancelAnimationFrame"]||window[vp+"CancelRequestAnimationFrame"],window.requestAnimationFrame=window.requestAnimationFrame,window.cancelAnimationFrame=window.cancelAnimationFrame}if(/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent)||!window.requestAnimationFrame||!window.cancelAnimationFrame){var lastTime=0;window.requestAnimationFrame=function(callback){var now=Date.now(),nextTime=Math.max(lastTime+16,now);return setTimeout(function(){callback(lastTime=nextTime)},nextTime-now)},window.cancelAnimationFrame=clearTimeout,window.requestAnimationFrame=window.requestAnimationFrame,window.cancelAnimationFrame=window.cancelAnimationFrame}var MaterialButton=function(element){this.element_=element,this.init()};window.MaterialButton=MaterialButton,MaterialButton.prototype.Constant_={},MaterialButton.prototype.CssClasses_={RIPPLE_EFFECT:"mdl-js-ripple-effect",RIPPLE_CONTAINER:"mdl-button__ripple-container",RIPPLE:"mdl-ripple"},MaterialButton.prototype.blurHandler_=function(event){event&&this.element_.blur()},MaterialButton.prototype.disable=function(){this.element_.disabled=!0},MaterialButton.prototype.disable=MaterialButton.prototype.disable,MaterialButton.prototype.enable=function(){this.element_.disabled=!1},MaterialButton.prototype.enable=MaterialButton.prototype.enable,MaterialButton.prototype.init=function(){if(this.element_){if(this.element_.classList.contains(this.CssClasses_.RIPPLE_EFFECT)){var rippleContainer=document.createElement("span");rippleContainer.classList.add(this.CssClasses_.RIPPLE_CONTAINER),this.rippleElement_=document.createElement("span"),this.rippleElement_.classList.add(this.CssClasses_.RIPPLE),rippleContainer.appendChild(this.rippleElement_),this.boundRippleBlurHandler=this.blurHandler_.bind(this),this.rippleElement_.addEventListener("mouseup",this.boundRippleBlurHandler),this.element_.appendChild(rippleContainer)}this.boundButtonBlurHandler=this.blurHandler_.bind(this),this.element_.addEventListener("mouseup",this.boundButtonBlurHandler),this.element_.addEventListener("mouseleave",this.boundButtonBlurHandler)}},MaterialButton.prototype.mdlDowngrade_=function(){this.rippleElement_&&this.rippleElement_.removeEventListener("mouseup",this.boundRippleBlurHandler),this.element_.removeEventListener("mouseup",this.boundButtonBlurHandler),this.element_.removeEventListener("mouseleave",this.boundButtonBlurHandler)},MaterialButton.prototype.mdlDowngrade=MaterialButton.prototype.mdlDowngrade_,MaterialButton.prototype.mdlDowngrade=MaterialButton.prototype.mdlDowngrade,componentHandler.register({constructor:MaterialButton,classAsString:"MaterialButton",cssClass:"mdl-js-button",widget:!0});var MaterialCheckbox=function(element){this.element_=element,this.init()};window.MaterialCheckbox=MaterialCheckbox,MaterialCheckbox.prototype.Constant_={TINY_TIMEOUT:.001},MaterialCheckbox.prototype.CssClasses_={INPUT:"mdl-checkbox__input",BOX_OUTLINE:"mdl-checkbox__box-outline",FOCUS_HELPER:"mdl-checkbox__focus-helper",TICK_OUTLINE:"mdl-checkbox__tick-outline",RIPPLE_EFFECT:"mdl-js-ripple-effect",RIPPLE_IGNORE_EVENTS:"mdl-js-ripple-effect--ignore-events",RIPPLE_CONTAINER:"mdl-checkbox__ripple-container",RIPPLE_CENTER:"mdl-ripple--center",RIPPLE:"mdl-ripple",IS_FOCUSED:"is-focused",IS_DISABLED:"is-disabled",IS_CHECKED:"is-checked",IS_UPGRADED:"is-upgraded"},MaterialCheckbox.prototype.onChange_=function(event){this.updateClasses_()},MaterialCheckbox.prototype.onFocus_=function(event){this.element_.classList.add(this.CssClasses_.IS_FOCUSED)},MaterialCheckbox.prototype.onBlur_=function(event){this.element_.classList.remove(this.CssClasses_.IS_FOCUSED)},MaterialCheckbox.prototype.onMouseUp_=function(event){this.blur_()},MaterialCheckbox.prototype.updateClasses_=function(){this.checkDisabled(),this.checkToggleState()},MaterialCheckbox.prototype.blur_=function(){window.setTimeout(function(){this.inputElement_.blur()}.bind(this),this.Constant_.TINY_TIMEOUT)},MaterialCheckbox.prototype.checkToggleState=function(){this.inputElement_.checked?this.element_.classList.add(this.CssClasses_.IS_CHECKED):this.element_.classList.remove(this.CssClasses_.IS_CHECKED)},MaterialCheckbox.prototype.checkToggleState=MaterialCheckbox.prototype.checkToggleState,MaterialCheckbox.prototype.checkDisabled=function(){this.inputElement_.disabled?this.element_.classList.add(this.CssClasses_.IS_DISABLED):this.element_.classList.remove(this.CssClasses_.IS_DISABLED)},MaterialCheckbox.prototype.checkDisabled=MaterialCheckbox.prototype.checkDisabled,MaterialCheckbox.prototype.disable=function(){this.inputElement_.disabled=!0,this.updateClasses_()},MaterialCheckbox.prototype.disable=MaterialCheckbox.prototype.disable,MaterialCheckbox.prototype.enable=function(){this.inputElement_.disabled=!1,this.updateClasses_()},MaterialCheckbox.prototype.enable=MaterialCheckbox.prototype.enable,MaterialCheckbox.prototype.check=function(){this.inputElement_.checked=!0,this.updateClasses_()},MaterialCheckbox.prototype.check=MaterialCheckbox.prototype.check,MaterialCheckbox.prototype.uncheck=function(){this.inputElement_.checked=!1,this.updateClasses_()},MaterialCheckbox.prototype.uncheck=MaterialCheckbox.prototype.uncheck,MaterialCheckbox.prototype.init=function(){if(this.element_){this.inputElement_=this.element_.querySelector("."+this.CssClasses_.INPUT);var boxOutline=document.createElement("span");boxOutline.classList.add(this.CssClasses_.BOX_OUTLINE);var tickContainer=document.createElement("span");tickContainer.classList.add(this.CssClasses_.FOCUS_HELPER);var tickOutline=document.createElement("span");if(tickOutline.classList.add(this.CssClasses_.TICK_OUTLINE),boxOutline.appendChild(tickOutline),this.element_.appendChild(tickContainer),this.element_.appendChild(boxOutline),this.element_.classList.contains(this.CssClasses_.RIPPLE_EFFECT)){this.element_.classList.add(this.CssClasses_.RIPPLE_IGNORE_EVENTS),this.rippleContainerElement_=document.createElement("span"),this.rippleContainerElement_.classList.add(this.CssClasses_.RIPPLE_CONTAINER),this.rippleContainerElement_.classList.add(this.CssClasses_.RIPPLE_EFFECT),this.rippleContainerElement_.classList.add(this.CssClasses_.RIPPLE_CENTER),this.boundRippleMouseUp=this.onMouseUp_.bind(this),this.rippleContainerElement_.addEventListener("mouseup",this.boundRippleMouseUp);var ripple=document.createElement("span");ripple.classList.add(this.CssClasses_.RIPPLE),this.rippleContainerElement_.appendChild(ripple),this.element_.appendChild(this.rippleContainerElement_)}this.boundInputOnChange=this.onChange_.bind(this),this.boundInputOnFocus=this.onFocus_.bind(this),this.boundInputOnBlur=this.onBlur_.bind(this),this.boundElementMouseUp=this.onMouseUp_.bind(this),this.inputElement_.addEventListener("change",this.boundInputOnChange),this.inputElement_.addEventListener("focus",this.boundInputOnFocus),this.inputElement_.addEventListener("blur",this.boundInputOnBlur),this.element_.addEventListener("mouseup",this.boundElementMouseUp),this.updateClasses_(),this.element_.classList.add(this.CssClasses_.IS_UPGRADED)}},MaterialCheckbox.prototype.mdlDowngrade_=function(){this.rippleContainerElement_&&this.rippleContainerElement_.removeEventListener("mouseup",this.boundRippleMouseUp),this.inputElement_.removeEventListener("change",this.boundInputOnChange),this.inputElement_.removeEventListener("focus",this.boundInputOnFocus),this.inputElement_.removeEventListener("blur",this.boundInputOnBlur),this.element_.removeEventListener("mouseup",this.boundElementMouseUp)},MaterialCheckbox.prototype.mdlDowngrade=MaterialCheckbox.prototype.mdlDowngrade_,MaterialCheckbox.prototype.mdlDowngrade=MaterialCheckbox.prototype.mdlDowngrade,componentHandler.register({constructor:MaterialCheckbox,classAsString:"MaterialCheckbox",cssClass:"mdl-js-checkbox",widget:!0});var MaterialIconToggle=function(element){this.element_=element,this.init()};window.MaterialIconToggle=MaterialIconToggle,MaterialIconToggle.prototype.Constant_={TINY_TIMEOUT:.001},MaterialIconToggle.prototype.CssClasses_={INPUT:"mdl-icon-toggle__input",JS_RIPPLE_EFFECT:"mdl-js-ripple-effect",RIPPLE_IGNORE_EVENTS:"mdl-js-ripple-effect--ignore-events",RIPPLE_CONTAINER:"mdl-icon-toggle__ripple-container",RIPPLE_CENTER:"mdl-ripple--center",RIPPLE:"mdl-ripple",IS_FOCUSED:"is-focused",IS_DISABLED:"is-disabled",IS_CHECKED:"is-checked"},MaterialIconToggle.prototype.onChange_=function(event){this.updateClasses_()},MaterialIconToggle.prototype.onFocus_=function(event){this.element_.classList.add(this.CssClasses_.IS_FOCUSED)},MaterialIconToggle.prototype.onBlur_=function(event){this.element_.classList.remove(this.CssClasses_.IS_FOCUSED)},MaterialIconToggle.prototype.onMouseUp_=function(event){this.blur_()},MaterialIconToggle.prototype.updateClasses_=function(){this.checkDisabled(),this.checkToggleState()},MaterialIconToggle.prototype.blur_=function(){window.setTimeout(function(){this.inputElement_.blur()}.bind(this),this.Constant_.TINY_TIMEOUT)},MaterialIconToggle.prototype.checkToggleState=function(){this.inputElement_.checked?this.element_.classList.add(this.CssClasses_.IS_CHECKED):this.element_.classList.remove(this.CssClasses_.IS_CHECKED)},MaterialIconToggle.prototype.checkToggleState=MaterialIconToggle.prototype.checkToggleState,MaterialIconToggle.prototype.checkDisabled=function(){this.inputElement_.disabled?this.element_.classList.add(this.CssClasses_.IS_DISABLED):this.element_.classList.remove(this.CssClasses_.IS_DISABLED)},MaterialIconToggle.prototype.checkDisabled=MaterialIconToggle.prototype.checkDisabled,MaterialIconToggle.prototype.disable=function(){this.inputElement_.disabled=!0,this.updateClasses_()},MaterialIconToggle.prototype.disable=MaterialIconToggle.prototype.disable,MaterialIconToggle.prototype.enable=function(){this.inputElement_.disabled=!1,this.updateClasses_()},MaterialIconToggle.prototype.enable=MaterialIconToggle.prototype.enable,MaterialIconToggle.prototype.check=function(){this.inputElement_.checked=!0,this.updateClasses_()},MaterialIconToggle.prototype.check=MaterialIconToggle.prototype.check,MaterialIconToggle.prototype.uncheck=function(){this.inputElement_.checked=!1,this.updateClasses_()},MaterialIconToggle.prototype.uncheck=MaterialIconToggle.prototype.uncheck,MaterialIconToggle.prototype.init=function(){if(this.element_){if(this.inputElement_=this.element_.querySelector("."+this.CssClasses_.INPUT),this.element_.classList.contains(this.CssClasses_.JS_RIPPLE_EFFECT)){this.element_.classList.add(this.CssClasses_.RIPPLE_IGNORE_EVENTS),this.rippleContainerElement_=document.createElement("span"),this.rippleContainerElement_.classList.add(this.CssClasses_.RIPPLE_CONTAINER),this.rippleContainerElement_.classList.add(this.CssClasses_.JS_RIPPLE_EFFECT),this.rippleContainerElement_.classList.add(this.CssClasses_.RIPPLE_CENTER),this.boundRippleMouseUp=this.onMouseUp_.bind(this),this.rippleContainerElement_.addEventListener("mouseup",this.boundRippleMouseUp);var ripple=document.createElement("span");ripple.classList.add(this.CssClasses_.RIPPLE),this.rippleContainerElement_.appendChild(ripple),this.element_.appendChild(this.rippleContainerElement_)}this.boundInputOnChange=this.onChange_.bind(this),this.boundInputOnFocus=this.onFocus_.bind(this),this.boundInputOnBlur=this.onBlur_.bind(this),this.boundElementOnMouseUp=this.onMouseUp_.bind(this),this.inputElement_.addEventListener("change",this.boundInputOnChange),this.inputElement_.addEventListener("focus",this.boundInputOnFocus),this.inputElement_.addEventListener("blur",this.boundInputOnBlur),this.element_.addEventListener("mouseup",this.boundElementOnMouseUp),this.updateClasses_(),this.element_.classList.add("is-upgraded")}},MaterialIconToggle.prototype.mdlDowngrade_=function(){this.rippleContainerElement_&&this.rippleContainerElement_.removeEventListener("mouseup",this.boundRippleMouseUp),this.inputElement_.removeEventListener("change",this.boundInputOnChange),this.inputElement_.removeEventListener("focus",this.boundInputOnFocus),this.inputElement_.removeEventListener("blur",this.boundInputOnBlur),this.element_.removeEventListener("mouseup",this.boundElementOnMouseUp)},MaterialIconToggle.prototype.mdlDowngrade=MaterialIconToggle.prototype.mdlDowngrade_,MaterialIconToggle.prototype.mdlDowngrade=MaterialIconToggle.prototype.mdlDowngrade,componentHandler.register({constructor:MaterialIconToggle,classAsString:"MaterialIconToggle",cssClass:"mdl-js-icon-toggle",widget:!0});var MaterialMenu=function(element){this.element_=element,this.init()};window.MaterialMenu=MaterialMenu,MaterialMenu.prototype.Constant_={TRANSITION_DURATION_SECONDS:.3,TRANSITION_DURATION_FRACTION:.8,CLOSE_TIMEOUT:150},MaterialMenu.prototype.Keycodes_={ENTER:13,ESCAPE:27,SPACE:32,UP_ARROW:38,DOWN_ARROW:40},MaterialMenu.prototype.CssClasses_={CONTAINER:"mdl-menu__container",OUTLINE:"mdl-menu__outline",ITEM:"mdl-menu__item",ITEM_RIPPLE_CONTAINER:"mdl-menu__item-ripple-container",RIPPLE_EFFECT:"mdl-js-ripple-effect",RIPPLE_IGNORE_EVENTS:"mdl-js-ripple-effect--ignore-events",RIPPLE:"mdl-ripple",IS_UPGRADED:"is-upgraded",IS_VISIBLE:"is-visible",IS_ANIMATING:"is-animating",BOTTOM_LEFT:"mdl-menu--bottom-left",BOTTOM_RIGHT:"mdl-menu--bottom-right",TOP_LEFT:"mdl-menu--top-left",TOP_RIGHT:"mdl-menu--top-right",UNALIGNED:"mdl-menu--unaligned"},MaterialMenu.prototype.init=function(){if(this.element_){var container=document.createElement("div");container.classList.add(this.CssClasses_.CONTAINER),this.element_.parentElement.insertBefore(container,this.element_),this.element_.parentElement.removeChild(this.element_),container.appendChild(this.element_),this.container_=container;var outline=document.createElement("div");outline.classList.add(this.CssClasses_.OUTLINE),this.outline_=outline,container.insertBefore(outline,this.element_);var forElId=this.element_.getAttribute("for"),forEl=null;forElId&&(forEl=document.getElementById(forElId),forEl&&(this.forElement_=forEl,forEl.addEventListener("click",this.handleForClick_.bind(this)),forEl.addEventListener("keydown",this.handleForKeyboardEvent_.bind(this))));var items=this.element_.querySelectorAll("."+this.CssClasses_.ITEM);this.boundItemKeydown_=this.handleItemKeyboardEvent_.bind(this),this.boundItemClick_=this.handleItemClick_.bind(this);for(var i=0;i<items.length;i++)items[i].addEventListener("click",this.boundItemClick_),items[i].tabIndex="-1",items[i].addEventListener("keydown",this.boundItemKeydown_);if(this.element_.classList.contains(this.CssClasses_.RIPPLE_EFFECT))for(this.element_.classList.add(this.CssClasses_.RIPPLE_IGNORE_EVENTS),i=0;i<items.length;i++){var item=items[i],rippleContainer=document.createElement("span");rippleContainer.classList.add(this.CssClasses_.ITEM_RIPPLE_CONTAINER);var ripple=document.createElement("span");ripple.classList.add(this.CssClasses_.RIPPLE),rippleContainer.appendChild(ripple),item.appendChild(rippleContainer),item.classList.add(this.CssClasses_.RIPPLE_EFFECT)}this.element_.classList.contains(this.CssClasses_.BOTTOM_LEFT)&&this.outline_.classList.add(this.CssClasses_.BOTTOM_LEFT),this.element_.classList.contains(this.CssClasses_.BOTTOM_RIGHT)&&this.outline_.classList.add(this.CssClasses_.BOTTOM_RIGHT),this.element_.classList.contains(this.CssClasses_.TOP_LEFT)&&this.outline_.classList.add(this.CssClasses_.TOP_LEFT),this.element_.classList.contains(this.CssClasses_.TOP_RIGHT)&&this.outline_.classList.add(this.CssClasses_.TOP_RIGHT),this.element_.classList.contains(this.CssClasses_.UNALIGNED)&&this.outline_.classList.add(this.CssClasses_.UNALIGNED),container.classList.add(this.CssClasses_.IS_UPGRADED)}},MaterialMenu.prototype.handleForClick_=function(evt){if(this.element_&&this.forElement_){var rect=this.forElement_.getBoundingClientRect(),forRect=this.forElement_.parentElement.getBoundingClientRect();this.element_.classList.contains(this.CssClasses_.UNALIGNED)||(this.element_.classList.contains(this.CssClasses_.BOTTOM_RIGHT)?(this.container_.style.right=forRect.right-rect.right+"px",this.container_.style.top=this.forElement_.offsetTop+this.forElement_.offsetHeight+"px"):this.element_.classList.contains(this.CssClasses_.TOP_LEFT)?(this.container_.style.left=this.forElement_.offsetLeft+"px",this.container_.style.bottom=forRect.bottom-rect.top+"px"):this.element_.classList.contains(this.CssClasses_.TOP_RIGHT)?(this.container_.style.right=forRect.right-rect.right+"px",this.container_.style.bottom=forRect.bottom-rect.top+"px"):(this.container_.style.left=this.forElement_.offsetLeft+"px",this.container_.style.top=this.forElement_.offsetTop+this.forElement_.offsetHeight+"px"))}this.toggle(evt)},MaterialMenu.prototype.handleForKeyboardEvent_=function(evt){if(this.element_&&this.container_&&this.forElement_){var items=this.element_.querySelectorAll("."+this.CssClasses_.ITEM+":not([disabled])");items&&items.length>0&&this.container_.classList.contains(this.CssClasses_.IS_VISIBLE)&&(evt.keyCode===this.Keycodes_.UP_ARROW?(evt.preventDefault(),items[items.length-1].focus()):evt.keyCode===this.Keycodes_.DOWN_ARROW&&(evt.preventDefault(),items[0].focus()))}},MaterialMenu.prototype.handleItemKeyboardEvent_=function(evt){if(this.element_&&this.container_){var items=this.element_.querySelectorAll("."+this.CssClasses_.ITEM+":not([disabled])");if(items&&items.length>0&&this.container_.classList.contains(this.CssClasses_.IS_VISIBLE)){var currentIndex=Array.prototype.slice.call(items).indexOf(evt.target);if(evt.keyCode===this.Keycodes_.UP_ARROW)evt.preventDefault(),currentIndex>0?items[currentIndex-1].focus():items[items.length-1].focus();else if(evt.keyCode===this.Keycodes_.DOWN_ARROW)evt.preventDefault(),items.length>currentIndex+1?items[currentIndex+1].focus():items[0].focus();else if(evt.keyCode===this.Keycodes_.SPACE||evt.keyCode===this.Keycodes_.ENTER){evt.preventDefault();var e=new MouseEvent("mousedown");evt.target.dispatchEvent(e),e=new MouseEvent("mouseup"),evt.target.dispatchEvent(e),evt.target.click()}else evt.keyCode===this.Keycodes_.ESCAPE&&(evt.preventDefault(),this.hide())}}},MaterialMenu.prototype.handleItemClick_=function(evt){evt.target.hasAttribute("disabled")?evt.stopPropagation():(this.closing_=!0,window.setTimeout(function(evt){this.hide(),this.closing_=!1}.bind(this),this.Constant_.CLOSE_TIMEOUT))},MaterialMenu.prototype.applyClip_=function(height,width){this.element_.classList.contains(this.CssClasses_.UNALIGNED)?this.element_.style.clip="":this.element_.classList.contains(this.CssClasses_.BOTTOM_RIGHT)?this.element_.style.clip="rect(0 "+width+"px 0 "+width+"px)":this.element_.classList.contains(this.CssClasses_.TOP_LEFT)?this.element_.style.clip="rect("+height+"px 0 "+height+"px 0)":this.element_.classList.contains(this.CssClasses_.TOP_RIGHT)?this.element_.style.clip="rect("+height+"px "+width+"px "+height+"px "+width+"px)":this.element_.style.clip=""},MaterialMenu.prototype.addAnimationEndListener_=function(){var cleanup=function(){this.element_.removeEventListener("transitionend",cleanup),this.element_.removeEventListener("webkitTransitionEnd",cleanup),this.element_.classList.remove(this.CssClasses_.IS_ANIMATING)}.bind(this);this.element_.addEventListener("transitionend",cleanup),this.element_.addEventListener("webkitTransitionEnd",cleanup)},MaterialMenu.prototype.show=function(evt){if(this.element_&&this.container_&&this.outline_){var height=this.element_.getBoundingClientRect().height,width=this.element_.getBoundingClientRect().width;this.container_.style.width=width+"px",this.container_.style.height=height+"px",this.outline_.style.width=width+"px",this.outline_.style.height=height+"px";for(var transitionDuration=this.Constant_.TRANSITION_DURATION_SECONDS*this.Constant_.TRANSITION_DURATION_FRACTION,items=this.element_.querySelectorAll("."+this.CssClasses_.ITEM),i=0;i<items.length;i++){var itemDelay=null;itemDelay=this.element_.classList.contains(this.CssClasses_.TOP_LEFT)||this.element_.classList.contains(this.CssClasses_.TOP_RIGHT)?(height-items[i].offsetTop-items[i].offsetHeight)/height*transitionDuration+"s":items[i].offsetTop/height*transitionDuration+"s",items[i].style.transitionDelay=itemDelay}this.applyClip_(height,width),window.requestAnimationFrame(function(){this.element_.classList.add(this.CssClasses_.IS_ANIMATING),this.element_.style.clip="rect(0 "+width+"px "+height+"px 0)",this.container_.classList.add(this.CssClasses_.IS_VISIBLE)}.bind(this)),this.addAnimationEndListener_();var callback=function(e){e===evt||this.closing_||e.target.parentNode===this.element_||(document.removeEventListener("click",callback),this.hide())}.bind(this);document.addEventListener("click",callback)}},MaterialMenu.prototype.show=MaterialMenu.prototype.show,MaterialMenu.prototype.hide=function(){if(this.element_&&this.container_&&this.outline_){for(var items=this.element_.querySelectorAll("."+this.CssClasses_.ITEM),i=0;i<items.length;i++)items[i].style.transitionDelay=null;var rect=this.element_.getBoundingClientRect(),height=rect.height,width=rect.width;this.element_.classList.add(this.CssClasses_.IS_ANIMATING),
this.applyClip_(height,width),this.container_.classList.remove(this.CssClasses_.IS_VISIBLE),this.addAnimationEndListener_()}},MaterialMenu.prototype.hide=MaterialMenu.prototype.hide,MaterialMenu.prototype.toggle=function(evt){this.container_.classList.contains(this.CssClasses_.IS_VISIBLE)?this.hide():this.show(evt)},MaterialMenu.prototype.toggle=MaterialMenu.prototype.toggle,MaterialMenu.prototype.mdlDowngrade_=function(){for(var items=this.element_.querySelectorAll("."+this.CssClasses_.ITEM),i=0;i<items.length;i++)items[i].removeEventListener("click",this.boundItemClick_),items[i].removeEventListener("keydown",this.boundItemKeydown_)},MaterialMenu.prototype.mdlDowngrade=MaterialMenu.prototype.mdlDowngrade_,MaterialMenu.prototype.mdlDowngrade=MaterialMenu.prototype.mdlDowngrade,componentHandler.register({constructor:MaterialMenu,classAsString:"MaterialMenu",cssClass:"mdl-js-menu",widget:!0});var MaterialProgress=function(element){this.element_=element,this.init()};window.MaterialProgress=MaterialProgress,MaterialProgress.prototype.Constant_={},MaterialProgress.prototype.CssClasses_={INDETERMINATE_CLASS:"mdl-progress__indeterminate"},MaterialProgress.prototype.setProgress=function(p){this.element_.classList.contains(this.CssClasses_.INDETERMINATE_CLASS)||(this.progressbar_.style.width=p+"%")},MaterialProgress.prototype.setProgress=MaterialProgress.prototype.setProgress,MaterialProgress.prototype.setBuffer=function(p){this.bufferbar_.style.width=p+"%",this.auxbar_.style.width=100-p+"%"},MaterialProgress.prototype.setBuffer=MaterialProgress.prototype.setBuffer,MaterialProgress.prototype.init=function(){if(this.element_){var el=document.createElement("div");el.className="progressbar bar bar1",this.element_.appendChild(el),this.progressbar_=el,el=document.createElement("div"),el.className="bufferbar bar bar2",this.element_.appendChild(el),this.bufferbar_=el,el=document.createElement("div"),el.className="auxbar bar bar3",this.element_.appendChild(el),this.auxbar_=el,this.progressbar_.style.width="0%",this.bufferbar_.style.width="100%",this.auxbar_.style.width="0%",this.element_.classList.add("is-upgraded")}},MaterialProgress.prototype.mdlDowngrade_=function(){for(;this.element_.firstChild;)this.element_.removeChild(this.element_.firstChild)},MaterialProgress.prototype.mdlDowngrade=MaterialProgress.prototype.mdlDowngrade_,MaterialProgress.prototype.mdlDowngrade=MaterialProgress.prototype.mdlDowngrade,componentHandler.register({constructor:MaterialProgress,classAsString:"MaterialProgress",cssClass:"mdl-js-progress",widget:!0});var MaterialRadio=function(element){this.element_=element,this.init()};window.MaterialRadio=MaterialRadio,MaterialRadio.prototype.Constant_={TINY_TIMEOUT:.001},MaterialRadio.prototype.CssClasses_={IS_FOCUSED:"is-focused",IS_DISABLED:"is-disabled",IS_CHECKED:"is-checked",IS_UPGRADED:"is-upgraded",JS_RADIO:"mdl-js-radio",RADIO_BTN:"mdl-radio__button",RADIO_OUTER_CIRCLE:"mdl-radio__outer-circle",RADIO_INNER_CIRCLE:"mdl-radio__inner-circle",RIPPLE_EFFECT:"mdl-js-ripple-effect",RIPPLE_IGNORE_EVENTS:"mdl-js-ripple-effect--ignore-events",RIPPLE_CONTAINER:"mdl-radio__ripple-container",RIPPLE_CENTER:"mdl-ripple--center",RIPPLE:"mdl-ripple"},MaterialRadio.prototype.onChange_=function(event){for(var radios=document.getElementsByClassName(this.CssClasses_.JS_RADIO),i=0;i<radios.length;i++){var button=radios[i].querySelector("."+this.CssClasses_.RADIO_BTN);button.getAttribute("name")===this.btnElement_.getAttribute("name")&&radios[i].MaterialRadio.updateClasses_()}},MaterialRadio.prototype.onFocus_=function(event){this.element_.classList.add(this.CssClasses_.IS_FOCUSED)},MaterialRadio.prototype.onBlur_=function(event){this.element_.classList.remove(this.CssClasses_.IS_FOCUSED)},MaterialRadio.prototype.onMouseup_=function(event){this.blur_()},MaterialRadio.prototype.updateClasses_=function(){this.checkDisabled(),this.checkToggleState()},MaterialRadio.prototype.blur_=function(){window.setTimeout(function(){this.btnElement_.blur()}.bind(this),this.Constant_.TINY_TIMEOUT)},MaterialRadio.prototype.checkDisabled=function(){this.btnElement_.disabled?this.element_.classList.add(this.CssClasses_.IS_DISABLED):this.element_.classList.remove(this.CssClasses_.IS_DISABLED)},MaterialRadio.prototype.checkDisabled=MaterialRadio.prototype.checkDisabled,MaterialRadio.prototype.checkToggleState=function(){this.btnElement_.checked?this.element_.classList.add(this.CssClasses_.IS_CHECKED):this.element_.classList.remove(this.CssClasses_.IS_CHECKED)},MaterialRadio.prototype.checkToggleState=MaterialRadio.prototype.checkToggleState,MaterialRadio.prototype.disable=function(){this.btnElement_.disabled=!0,this.updateClasses_()},MaterialRadio.prototype.disable=MaterialRadio.prototype.disable,MaterialRadio.prototype.enable=function(){this.btnElement_.disabled=!1,this.updateClasses_()},MaterialRadio.prototype.enable=MaterialRadio.prototype.enable,MaterialRadio.prototype.check=function(){this.btnElement_.checked=!0,this.updateClasses_()},MaterialRadio.prototype.check=MaterialRadio.prototype.check,MaterialRadio.prototype.uncheck=function(){this.btnElement_.checked=!1,this.updateClasses_()},MaterialRadio.prototype.uncheck=MaterialRadio.prototype.uncheck,MaterialRadio.prototype.init=function(){if(this.element_){this.btnElement_=this.element_.querySelector("."+this.CssClasses_.RADIO_BTN),this.boundChangeHandler_=this.onChange_.bind(this),this.boundFocusHandler_=this.onChange_.bind(this),this.boundBlurHandler_=this.onBlur_.bind(this),this.boundMouseUpHandler_=this.onMouseup_.bind(this);var outerCircle=document.createElement("span");outerCircle.classList.add(this.CssClasses_.RADIO_OUTER_CIRCLE);var innerCircle=document.createElement("span");innerCircle.classList.add(this.CssClasses_.RADIO_INNER_CIRCLE),this.element_.appendChild(outerCircle),this.element_.appendChild(innerCircle);var rippleContainer;if(this.element_.classList.contains(this.CssClasses_.RIPPLE_EFFECT)){this.element_.classList.add(this.CssClasses_.RIPPLE_IGNORE_EVENTS),rippleContainer=document.createElement("span"),rippleContainer.classList.add(this.CssClasses_.RIPPLE_CONTAINER),rippleContainer.classList.add(this.CssClasses_.RIPPLE_EFFECT),rippleContainer.classList.add(this.CssClasses_.RIPPLE_CENTER),rippleContainer.addEventListener("mouseup",this.boundMouseUpHandler_);var ripple=document.createElement("span");ripple.classList.add(this.CssClasses_.RIPPLE),rippleContainer.appendChild(ripple),this.element_.appendChild(rippleContainer)}this.btnElement_.addEventListener("change",this.boundChangeHandler_),this.btnElement_.addEventListener("focus",this.boundFocusHandler_),this.btnElement_.addEventListener("blur",this.boundBlurHandler_),this.element_.addEventListener("mouseup",this.boundMouseUpHandler_),this.updateClasses_(),this.element_.classList.add(this.CssClasses_.IS_UPGRADED)}},MaterialRadio.prototype.mdlDowngrade_=function(){var rippleContainer=this.element_.querySelector("."+this.CssClasses_.RIPPLE_CONTAINER);this.btnElement_.removeEventListener("change",this.boundChangeHandler_),this.btnElement_.removeEventListener("focus",this.boundFocusHandler_),this.btnElement_.removeEventListener("blur",this.boundBlurHandler_),this.element_.removeEventListener("mouseup",this.boundMouseUpHandler_),rippleContainer&&(rippleContainer.removeEventListener("mouseup",this.boundMouseUpHandler_),this.element_.removeChild(rippleContainer))},MaterialRadio.prototype.mdlDowngrade=MaterialRadio.prototype.mdlDowngrade_,MaterialRadio.prototype.mdlDowngrade=MaterialRadio.prototype.mdlDowngrade,componentHandler.register({constructor:MaterialRadio,classAsString:"MaterialRadio",cssClass:"mdl-js-radio",widget:!0});var MaterialSlider=function(element){this.element_=element,this.isIE_=window.navigator.msPointerEnabled,this.init()};window.MaterialSlider=MaterialSlider,MaterialSlider.prototype.Constant_={},MaterialSlider.prototype.CssClasses_={IE_CONTAINER:"mdl-slider__ie-container",SLIDER_CONTAINER:"mdl-slider__container",BACKGROUND_FLEX:"mdl-slider__background-flex",BACKGROUND_LOWER:"mdl-slider__background-lower",BACKGROUND_UPPER:"mdl-slider__background-upper",IS_LOWEST_VALUE:"is-lowest-value",IS_UPGRADED:"is-upgraded"},MaterialSlider.prototype.onInput_=function(event){this.updateValueStyles_()},MaterialSlider.prototype.onChange_=function(event){this.updateValueStyles_()},MaterialSlider.prototype.onMouseUp_=function(event){event.target.blur()},MaterialSlider.prototype.onContainerMouseDown_=function(event){if(event.target===this.element_.parentElement){event.preventDefault();var newEvent=new MouseEvent("mousedown",{target:event.target,buttons:event.buttons,clientX:event.clientX,clientY:this.element_.getBoundingClientRect().y});this.element_.dispatchEvent(newEvent)}},MaterialSlider.prototype.updateValueStyles_=function(){var fraction=(this.element_.value-this.element_.min)/(this.element_.max-this.element_.min);0===fraction?this.element_.classList.add(this.CssClasses_.IS_LOWEST_VALUE):this.element_.classList.remove(this.CssClasses_.IS_LOWEST_VALUE),this.isIE_||(this.backgroundLower_.style.flex=fraction,this.backgroundLower_.style.webkitFlex=fraction,this.backgroundUpper_.style.flex=1-fraction,this.backgroundUpper_.style.webkitFlex=1-fraction)},MaterialSlider.prototype.disable=function(){this.element_.disabled=!0},MaterialSlider.prototype.disable=MaterialSlider.prototype.disable,MaterialSlider.prototype.enable=function(){this.element_.disabled=!1},MaterialSlider.prototype.enable=MaterialSlider.prototype.enable,MaterialSlider.prototype.change=function(value){"undefined"!=typeof value&&(this.element_.value=value),this.updateValueStyles_()},MaterialSlider.prototype.change=MaterialSlider.prototype.change,MaterialSlider.prototype.init=function(){if(this.element_){if(this.isIE_){var containerIE=document.createElement("div");containerIE.classList.add(this.CssClasses_.IE_CONTAINER),this.element_.parentElement.insertBefore(containerIE,this.element_),this.element_.parentElement.removeChild(this.element_),containerIE.appendChild(this.element_)}else{var container=document.createElement("div");container.classList.add(this.CssClasses_.SLIDER_CONTAINER),this.element_.parentElement.insertBefore(container,this.element_),this.element_.parentElement.removeChild(this.element_),container.appendChild(this.element_);var backgroundFlex=document.createElement("div");backgroundFlex.classList.add(this.CssClasses_.BACKGROUND_FLEX),container.appendChild(backgroundFlex),this.backgroundLower_=document.createElement("div"),this.backgroundLower_.classList.add(this.CssClasses_.BACKGROUND_LOWER),backgroundFlex.appendChild(this.backgroundLower_),this.backgroundUpper_=document.createElement("div"),this.backgroundUpper_.classList.add(this.CssClasses_.BACKGROUND_UPPER),backgroundFlex.appendChild(this.backgroundUpper_)}this.boundInputHandler=this.onInput_.bind(this),this.boundChangeHandler=this.onChange_.bind(this),this.boundMouseUpHandler=this.onMouseUp_.bind(this),this.boundContainerMouseDownHandler=this.onContainerMouseDown_.bind(this),this.element_.addEventListener("input",this.boundInputHandler),this.element_.addEventListener("change",this.boundChangeHandler),this.element_.addEventListener("mouseup",this.boundMouseUpHandler),this.element_.parentElement.addEventListener("mousedown",this.boundContainerMouseDownHandler),this.updateValueStyles_(),this.element_.classList.add(this.CssClasses_.IS_UPGRADED)}},MaterialSlider.prototype.mdlDowngrade_=function(){this.element_.removeEventListener("input",this.boundInputHandler),this.element_.removeEventListener("change",this.boundChangeHandler),this.element_.removeEventListener("mouseup",this.boundMouseUpHandler),this.element_.parentElement.removeEventListener("mousedown",this.boundContainerMouseDownHandler)},MaterialSlider.prototype.mdlDowngrade=MaterialSlider.prototype.mdlDowngrade_,MaterialSlider.prototype.mdlDowngrade=MaterialSlider.prototype.mdlDowngrade,componentHandler.register({constructor:MaterialSlider,classAsString:"MaterialSlider",cssClass:"mdl-js-slider",widget:!0});var MaterialSpinner=function(element){this.element_=element,this.init()};window.MaterialSpinner=MaterialSpinner,MaterialSpinner.prototype.Constant_={MDL_SPINNER_LAYER_COUNT:4},MaterialSpinner.prototype.CssClasses_={MDL_SPINNER_LAYER:"mdl-spinner__layer",MDL_SPINNER_CIRCLE_CLIPPER:"mdl-spinner__circle-clipper",MDL_SPINNER_CIRCLE:"mdl-spinner__circle",MDL_SPINNER_GAP_PATCH:"mdl-spinner__gap-patch",MDL_SPINNER_LEFT:"mdl-spinner__left",MDL_SPINNER_RIGHT:"mdl-spinner__right"},MaterialSpinner.prototype.createLayer=function(index){var layer=document.createElement("div");layer.classList.add(this.CssClasses_.MDL_SPINNER_LAYER),layer.classList.add(this.CssClasses_.MDL_SPINNER_LAYER+"-"+index);var leftClipper=document.createElement("div");leftClipper.classList.add(this.CssClasses_.MDL_SPINNER_CIRCLE_CLIPPER),leftClipper.classList.add(this.CssClasses_.MDL_SPINNER_LEFT);var gapPatch=document.createElement("div");gapPatch.classList.add(this.CssClasses_.MDL_SPINNER_GAP_PATCH);var rightClipper=document.createElement("div");rightClipper.classList.add(this.CssClasses_.MDL_SPINNER_CIRCLE_CLIPPER),rightClipper.classList.add(this.CssClasses_.MDL_SPINNER_RIGHT);for(var circleOwners=[leftClipper,gapPatch,rightClipper],i=0;i<circleOwners.length;i++){var circle=document.createElement("div");circle.classList.add(this.CssClasses_.MDL_SPINNER_CIRCLE),circleOwners[i].appendChild(circle)}layer.appendChild(leftClipper),layer.appendChild(gapPatch),layer.appendChild(rightClipper),this.element_.appendChild(layer)},MaterialSpinner.prototype.createLayer=MaterialSpinner.prototype.createLayer,MaterialSpinner.prototype.stop=function(){this.element_.classList.remove("is-active")},MaterialSpinner.prototype.stop=MaterialSpinner.prototype.stop,MaterialSpinner.prototype.start=function(){this.element_.classList.add("is-active")},MaterialSpinner.prototype.start=MaterialSpinner.prototype.start,MaterialSpinner.prototype.init=function(){if(this.element_){for(var i=1;i<=this.Constant_.MDL_SPINNER_LAYER_COUNT;i++)this.createLayer(i);this.element_.classList.add("is-upgraded")}},componentHandler.register({constructor:MaterialSpinner,classAsString:"MaterialSpinner",cssClass:"mdl-js-spinner",widget:!0});var MaterialSwitch=function(element){this.element_=element,this.init()};window.MaterialSwitch=MaterialSwitch,MaterialSwitch.prototype.Constant_={TINY_TIMEOUT:.001},MaterialSwitch.prototype.CssClasses_={INPUT:"mdl-switch__input",TRACK:"mdl-switch__track",THUMB:"mdl-switch__thumb",FOCUS_HELPER:"mdl-switch__focus-helper",RIPPLE_EFFECT:"mdl-js-ripple-effect",RIPPLE_IGNORE_EVENTS:"mdl-js-ripple-effect--ignore-events",RIPPLE_CONTAINER:"mdl-switch__ripple-container",RIPPLE_CENTER:"mdl-ripple--center",RIPPLE:"mdl-ripple",IS_FOCUSED:"is-focused",IS_DISABLED:"is-disabled",IS_CHECKED:"is-checked"},MaterialSwitch.prototype.onChange_=function(event){this.updateClasses_()},MaterialSwitch.prototype.onFocus_=function(event){this.element_.classList.add(this.CssClasses_.IS_FOCUSED)},MaterialSwitch.prototype.onBlur_=function(event){this.element_.classList.remove(this.CssClasses_.IS_FOCUSED)},MaterialSwitch.prototype.onMouseUp_=function(event){this.blur_()},MaterialSwitch.prototype.updateClasses_=function(){this.checkDisabled(),this.checkToggleState()},MaterialSwitch.prototype.blur_=function(){window.setTimeout(function(){this.inputElement_.blur()}.bind(this),this.Constant_.TINY_TIMEOUT)},MaterialSwitch.prototype.checkDisabled=function(){this.inputElement_.disabled?this.element_.classList.add(this.CssClasses_.IS_DISABLED):this.element_.classList.remove(this.CssClasses_.IS_DISABLED)},MaterialSwitch.prototype.checkDisabled=MaterialSwitch.prototype.checkDisabled,MaterialSwitch.prototype.checkToggleState=function(){this.inputElement_.checked?this.element_.classList.add(this.CssClasses_.IS_CHECKED):this.element_.classList.remove(this.CssClasses_.IS_CHECKED)},MaterialSwitch.prototype.checkToggleState=MaterialSwitch.prototype.checkToggleState,MaterialSwitch.prototype.disable=function(){this.inputElement_.disabled=!0,this.updateClasses_()},MaterialSwitch.prototype.disable=MaterialSwitch.prototype.disable,MaterialSwitch.prototype.enable=function(){this.inputElement_.disabled=!1,this.updateClasses_()},MaterialSwitch.prototype.enable=MaterialSwitch.prototype.enable,MaterialSwitch.prototype.on=function(){this.inputElement_.checked=!0,this.updateClasses_()},MaterialSwitch.prototype.on=MaterialSwitch.prototype.on,MaterialSwitch.prototype.off=function(){this.inputElement_.checked=!1,this.updateClasses_()},MaterialSwitch.prototype.off=MaterialSwitch.prototype.off,MaterialSwitch.prototype.init=function(){if(this.element_){this.inputElement_=this.element_.querySelector("."+this.CssClasses_.INPUT);var track=document.createElement("div");track.classList.add(this.CssClasses_.TRACK);var thumb=document.createElement("div");thumb.classList.add(this.CssClasses_.THUMB);var focusHelper=document.createElement("span");if(focusHelper.classList.add(this.CssClasses_.FOCUS_HELPER),thumb.appendChild(focusHelper),this.element_.appendChild(track),this.element_.appendChild(thumb),this.boundMouseUpHandler=this.onMouseUp_.bind(this),this.element_.classList.contains(this.CssClasses_.RIPPLE_EFFECT)){this.element_.classList.add(this.CssClasses_.RIPPLE_IGNORE_EVENTS),this.rippleContainerElement_=document.createElement("span"),this.rippleContainerElement_.classList.add(this.CssClasses_.RIPPLE_CONTAINER),this.rippleContainerElement_.classList.add(this.CssClasses_.RIPPLE_EFFECT),this.rippleContainerElement_.classList.add(this.CssClasses_.RIPPLE_CENTER),this.rippleContainerElement_.addEventListener("mouseup",this.boundMouseUpHandler);var ripple=document.createElement("span");ripple.classList.add(this.CssClasses_.RIPPLE),this.rippleContainerElement_.appendChild(ripple),this.element_.appendChild(this.rippleContainerElement_)}this.boundChangeHandler=this.onChange_.bind(this),this.boundFocusHandler=this.onFocus_.bind(this),this.boundBlurHandler=this.onBlur_.bind(this),this.inputElement_.addEventListener("change",this.boundChangeHandler),this.inputElement_.addEventListener("focus",this.boundFocusHandler),this.inputElement_.addEventListener("blur",this.boundBlurHandler),this.element_.addEventListener("mouseup",this.boundMouseUpHandler),this.updateClasses_(),this.element_.classList.add("is-upgraded")}},MaterialSwitch.prototype.mdlDowngrade_=function(){this.rippleContainerElement_&&this.rippleContainerElement_.removeEventListener("mouseup",this.boundMouseUpHandler),this.inputElement_.removeEventListener("change",this.boundChangeHandler),this.inputElement_.removeEventListener("focus",this.boundFocusHandler),this.inputElement_.removeEventListener("blur",this.boundBlurHandler),this.element_.removeEventListener("mouseup",this.boundMouseUpHandler)},MaterialSwitch.prototype.mdlDowngrade=MaterialSwitch.prototype.mdlDowngrade_,MaterialSwitch.prototype.mdlDowngrade=MaterialSwitch.prototype.mdlDowngrade,componentHandler.register({constructor:MaterialSwitch,classAsString:"MaterialSwitch",cssClass:"mdl-js-switch",widget:!0});var MaterialTabs=function(element){this.element_=element,this.init()};window.MaterialTabs=MaterialTabs,MaterialTabs.prototype.Constant_={},MaterialTabs.prototype.CssClasses_={TAB_CLASS:"mdl-tabs__tab",PANEL_CLASS:"mdl-tabs__panel",ACTIVE_CLASS:"is-active",UPGRADED_CLASS:"is-upgraded",MDL_JS_RIPPLE_EFFECT:"mdl-js-ripple-effect",MDL_RIPPLE_CONTAINER:"mdl-tabs__ripple-container",MDL_RIPPLE:"mdl-ripple",MDL_JS_RIPPLE_EFFECT_IGNORE_EVENTS:"mdl-js-ripple-effect--ignore-events"},MaterialTabs.prototype.initTabs_=function(){this.element_.classList.contains(this.CssClasses_.MDL_JS_RIPPLE_EFFECT)&&this.element_.classList.add(this.CssClasses_.MDL_JS_RIPPLE_EFFECT_IGNORE_EVENTS),this.tabs_=this.element_.querySelectorAll("."+this.CssClasses_.TAB_CLASS),this.panels_=this.element_.querySelectorAll("."+this.CssClasses_.PANEL_CLASS);for(var i=0;i<this.tabs_.length;i++)new MaterialTab(this.tabs_[i],this);this.element_.classList.add(this.CssClasses_.UPGRADED_CLASS)},MaterialTabs.prototype.resetTabState_=function(){for(var k=0;k<this.tabs_.length;k++)this.tabs_[k].classList.remove(this.CssClasses_.ACTIVE_CLASS)},MaterialTabs.prototype.resetPanelState_=function(){for(var j=0;j<this.panels_.length;j++)this.panels_[j].classList.remove(this.CssClasses_.ACTIVE_CLASS)},MaterialTabs.prototype.init=function(){this.element_&&this.initTabs_()},componentHandler.register({constructor:MaterialTabs,classAsString:"MaterialTabs",cssClass:"mdl-js-tabs"});var MaterialTextfield=function(element){this.element_=element,this.maxRows=this.Constant_.NO_MAX_ROWS,this.init()};window.MaterialTextfield=MaterialTextfield,MaterialTextfield.prototype.Constant_={NO_MAX_ROWS:-1,MAX_ROWS_ATTRIBUTE:"maxrows"},MaterialTextfield.prototype.CssClasses_={LABEL:"mdl-textfield__label",INPUT:"mdl-textfield__input",IS_DIRTY:"is-dirty",IS_FOCUSED:"is-focused",IS_DISABLED:"is-disabled",IS_INVALID:"is-invalid",IS_UPGRADED:"is-upgraded"},MaterialTextfield.prototype.onKeyDown_=function(event){var currentRowCount=event.target.value.split("\n").length;13===event.keyCode&&currentRowCount>=this.maxRows&&event.preventDefault()},MaterialTextfield.prototype.onFocus_=function(event){this.element_.classList.add(this.CssClasses_.IS_FOCUSED)},MaterialTextfield.prototype.onBlur_=function(event){this.element_.classList.remove(this.CssClasses_.IS_FOCUSED)},MaterialTextfield.prototype.updateClasses_=function(){this.checkDisabled(),this.checkValidity(),this.checkDirty()},MaterialTextfield.prototype.checkDisabled=function(){this.input_.disabled?this.element_.classList.add(this.CssClasses_.IS_DISABLED):this.element_.classList.remove(this.CssClasses_.IS_DISABLED)},MaterialTextfield.prototype.checkDisabled=MaterialTextfield.prototype.checkDisabled,MaterialTextfield.prototype.checkValidity=function(){this.input_.validity&&(this.input_.validity.valid?this.element_.classList.remove(this.CssClasses_.IS_INVALID):this.element_.classList.add(this.CssClasses_.IS_INVALID))},MaterialTextfield.prototype.checkValidity=MaterialTextfield.prototype.checkValidity,MaterialTextfield.prototype.checkDirty=function(){this.input_.value&&this.input_.value.length>0?this.element_.classList.add(this.CssClasses_.IS_DIRTY):this.element_.classList.remove(this.CssClasses_.IS_DIRTY)},MaterialTextfield.prototype.checkDirty=MaterialTextfield.prototype.checkDirty,MaterialTextfield.prototype.disable=function(){this.input_.disabled=!0,this.updateClasses_()},MaterialTextfield.prototype.disable=MaterialTextfield.prototype.disable,MaterialTextfield.prototype.enable=function(){this.input_.disabled=!1,this.updateClasses_()},MaterialTextfield.prototype.enable=MaterialTextfield.prototype.enable,MaterialTextfield.prototype.change=function(value){this.input_.value=value||"",this.updateClasses_()},MaterialTextfield.prototype.change=MaterialTextfield.prototype.change,MaterialTextfield.prototype.init=function(){if(this.element_&&(this.label_=this.element_.querySelector("."+this.CssClasses_.LABEL),this.input_=this.element_.querySelector("."+this.CssClasses_.INPUT),this.input_)){this.input_.hasAttribute(this.Constant_.MAX_ROWS_ATTRIBUTE)&&(this.maxRows=parseInt(this.input_.getAttribute(this.Constant_.MAX_ROWS_ATTRIBUTE),10),isNaN(this.maxRows)&&(this.maxRows=this.Constant_.NO_MAX_ROWS)),this.boundUpdateClassesHandler=this.updateClasses_.bind(this),this.boundFocusHandler=this.onFocus_.bind(this),this.boundBlurHandler=this.onBlur_.bind(this),this.input_.addEventListener("input",this.boundUpdateClassesHandler),this.input_.addEventListener("focus",this.boundFocusHandler),this.input_.addEventListener("blur",this.boundBlurHandler),this.maxRows!==this.Constant_.NO_MAX_ROWS&&(this.boundKeyDownHandler=this.onKeyDown_.bind(this),this.input_.addEventListener("keydown",this.boundKeyDownHandler));var invalid=this.element_.classList.contains(this.CssClasses_.IS_INVALID);this.updateClasses_(),this.element_.classList.add(this.CssClasses_.IS_UPGRADED),invalid&&this.element_.classList.add(this.CssClasses_.IS_INVALID)}},MaterialTextfield.prototype.mdlDowngrade_=function(){this.input_.removeEventListener("input",this.boundUpdateClassesHandler),this.input_.removeEventListener("focus",this.boundFocusHandler),this.input_.removeEventListener("blur",this.boundBlurHandler),this.boundKeyDownHandler&&this.input_.removeEventListener("keydown",this.boundKeyDownHandler)},MaterialTextfield.prototype.mdlDowngrade=MaterialTextfield.prototype.mdlDowngrade_,MaterialTextfield.prototype.mdlDowngrade=MaterialTextfield.prototype.mdlDowngrade,componentHandler.register({constructor:MaterialTextfield,classAsString:"MaterialTextfield",cssClass:"mdl-js-textfield",widget:!0});var MaterialTooltip=function(element){this.element_=element,this.init()};window.MaterialTooltip=MaterialTooltip,MaterialTooltip.prototype.Constant_={},MaterialTooltip.prototype.CssClasses_={IS_ACTIVE:"is-active"},MaterialTooltip.prototype.handleMouseEnter_=function(event){event.stopPropagation();var props=event.target.getBoundingClientRect(),left=props.left+props.width/2,marginLeft=-1*(this.element_.offsetWidth/2);0>left+marginLeft?(this.element_.style.left=0,this.element_.style.marginLeft=0):(this.element_.style.left=left+"px",this.element_.style.marginLeft=marginLeft+"px"),this.element_.style.top=props.top+props.height+10+"px",this.element_.classList.add(this.CssClasses_.IS_ACTIVE),window.addEventListener("scroll",this.boundMouseLeaveHandler,!1),window.addEventListener("touchmove",this.boundMouseLeaveHandler,!1)},MaterialTooltip.prototype.handleMouseLeave_=function(event){event.stopPropagation(),this.element_.classList.remove(this.CssClasses_.IS_ACTIVE),window.removeEventListener("scroll",this.boundMouseLeaveHandler),window.removeEventListener("touchmove",this.boundMouseLeaveHandler,!1)},MaterialTooltip.prototype.init=function(){if(this.element_){var forElId=this.element_.getAttribute("for");forElId&&(this.forElement_=document.getElementById(forElId)),this.forElement_&&(this.forElement_.hasAttribute("tabindex")||this.forElement_.setAttribute("tabindex","0"),this.boundMouseEnterHandler=this.handleMouseEnter_.bind(this),this.boundMouseLeaveHandler=this.handleMouseLeave_.bind(this),this.forElement_.addEventListener("mouseenter",this.boundMouseEnterHandler,!1),this.forElement_.addEventListener("click",this.boundMouseEnterHandler,!1),this.forElement_.addEventListener("blur",this.boundMouseLeaveHandler),this.forElement_.addEventListener("touchstart",this.boundMouseEnterHandler,!1),this.forElement_.addEventListener("mouseleave",this.boundMouseLeaveHandler))}},MaterialTooltip.prototype.mdlDowngrade_=function(){this.forElement_&&(this.forElement_.removeEventListener("mouseenter",this.boundMouseEnterHandler,!1),this.forElement_.removeEventListener("click",this.boundMouseEnterHandler,!1),this.forElement_.removeEventListener("touchstart",this.boundMouseEnterHandler,!1),this.forElement_.removeEventListener("mouseleave",this.boundMouseLeaveHandler))},MaterialTooltip.prototype.mdlDowngrade=MaterialTooltip.prototype.mdlDowngrade_,MaterialTooltip.prototype.mdlDowngrade=MaterialTooltip.prototype.mdlDowngrade,componentHandler.register({constructor:MaterialTooltip,classAsString:"MaterialTooltip",cssClass:"mdl-tooltip"});var MaterialLayout=function(element){this.element_=element,this.init()};window.MaterialLayout=MaterialLayout,MaterialLayout.prototype.Constant_={MAX_WIDTH:"(max-width: 1024px)",TAB_SCROLL_PIXELS:100,MENU_ICON:"menu",CHEVRON_LEFT:"chevron_left",CHEVRON_RIGHT:"chevron_right"},MaterialLayout.prototype.Mode_={STANDARD:0,SEAMED:1,WATERFALL:2,SCROLL:3},MaterialLayout.prototype.CssClasses_={CONTAINER:"mdl-layout__container",HEADER:"mdl-layout__header",DRAWER:"mdl-layout__drawer",CONTENT:"mdl-layout__content",DRAWER_BTN:"mdl-layout__drawer-button",ICON:"material-icons",JS_RIPPLE_EFFECT:"mdl-js-ripple-effect",RIPPLE_CONTAINER:"mdl-layout__tab-ripple-container",RIPPLE:"mdl-ripple",RIPPLE_IGNORE_EVENTS:"mdl-js-ripple-effect--ignore-events",HEADER_SEAMED:"mdl-layout__header--seamed",HEADER_WATERFALL:"mdl-layout__header--waterfall",HEADER_SCROLL:"mdl-layout__header--scroll",FIXED_HEADER:"mdl-layout--fixed-header",OBFUSCATOR:"mdl-layout__obfuscator",TAB_BAR:"mdl-layout__tab-bar",TAB_CONTAINER:"mdl-layout__tab-bar-container",TAB:"mdl-layout__tab",TAB_BAR_BUTTON:"mdl-layout__tab-bar-button",TAB_BAR_LEFT_BUTTON:"mdl-layout__tab-bar-left-button",TAB_BAR_RIGHT_BUTTON:"mdl-layout__tab-bar-right-button",PANEL:"mdl-layout__tab-panel",HAS_DRAWER:"has-drawer",HAS_TABS:"has-tabs",HAS_SCROLLING_HEADER:"has-scrolling-header",CASTING_SHADOW:"is-casting-shadow",IS_COMPACT:"is-compact",IS_SMALL_SCREEN:"is-small-screen",IS_DRAWER_OPEN:"is-visible",IS_ACTIVE:"is-active",IS_UPGRADED:"is-upgraded",IS_ANIMATING:"is-animating",ON_LARGE_SCREEN:"mdl-layout--large-screen-only",ON_SMALL_SCREEN:"mdl-layout--small-screen-only"},MaterialLayout.prototype.contentScrollHandler_=function(){this.header_.classList.contains(this.CssClasses_.IS_ANIMATING)||(this.content_.scrollTop>0&&!this.header_.classList.contains(this.CssClasses_.IS_COMPACT)?(this.header_.classList.add(this.CssClasses_.CASTING_SHADOW),this.header_.classList.add(this.CssClasses_.IS_COMPACT),this.header_.classList.add(this.CssClasses_.IS_ANIMATING)):this.content_.scrollTop<=0&&this.header_.classList.contains(this.CssClasses_.IS_COMPACT)&&(this.header_.classList.remove(this.CssClasses_.CASTING_SHADOW),this.header_.classList.remove(this.CssClasses_.IS_COMPACT),this.header_.classList.add(this.CssClasses_.IS_ANIMATING)))},MaterialLayout.prototype.screenSizeHandler_=function(){this.screenSizeMediaQuery_.matches?this.element_.classList.add(this.CssClasses_.IS_SMALL_SCREEN):(this.element_.classList.remove(this.CssClasses_.IS_SMALL_SCREEN),this.drawer_&&(this.drawer_.classList.remove(this.CssClasses_.IS_DRAWER_OPEN),this.obfuscator_.classList.remove(this.CssClasses_.IS_DRAWER_OPEN)))},MaterialLayout.prototype.drawerToggleHandler_=function(){this.drawer_.classList.toggle(this.CssClasses_.IS_DRAWER_OPEN),this.obfuscator_.classList.toggle(this.CssClasses_.IS_DRAWER_OPEN)},MaterialLayout.prototype.headerTransitionEndHandler_=function(){this.header_.classList.remove(this.CssClasses_.IS_ANIMATING)},MaterialLayout.prototype.headerClickHandler_=function(){this.header_.classList.contains(this.CssClasses_.IS_COMPACT)&&(this.header_.classList.remove(this.CssClasses_.IS_COMPACT),this.header_.classList.add(this.CssClasses_.IS_ANIMATING))},MaterialLayout.prototype.resetTabState_=function(tabBar){for(var k=0;k<tabBar.length;k++)tabBar[k].classList.remove(this.CssClasses_.IS_ACTIVE)},MaterialLayout.prototype.resetPanelState_=function(panels){for(var j=0;j<panels.length;j++)panels[j].classList.remove(this.CssClasses_.IS_ACTIVE)},MaterialLayout.prototype.init=function(){if(this.element_){var container=document.createElement("div");container.classList.add(this.CssClasses_.CONTAINER),this.element_.parentElement.insertBefore(container,this.element_),this.element_.parentElement.removeChild(this.element_),container.appendChild(this.element_);for(var directChildren=this.element_.childNodes,numChildren=directChildren.length,c=0;numChildren>c;c++){var child=directChildren[c];child.classList&&child.classList.contains(this.CssClasses_.HEADER)&&(this.header_=child),child.classList&&child.classList.contains(this.CssClasses_.DRAWER)&&(this.drawer_=child),child.classList&&child.classList.contains(this.CssClasses_.CONTENT)&&(this.content_=child)}this.header_&&(this.tabBar_=this.header_.querySelector("."+this.CssClasses_.TAB_BAR));var mode=this.Mode_.STANDARD;if(this.header_&&(this.header_.classList.contains(this.CssClasses_.HEADER_SEAMED)?mode=this.Mode_.SEAMED:this.header_.classList.contains(this.CssClasses_.HEADER_WATERFALL)?(mode=this.Mode_.WATERFALL,this.header_.addEventListener("transitionend",this.headerTransitionEndHandler_.bind(this)),this.header_.addEventListener("click",this.headerClickHandler_.bind(this))):this.header_.classList.contains(this.CssClasses_.HEADER_SCROLL)&&(mode=this.Mode_.SCROLL,container.classList.add(this.CssClasses_.HAS_SCROLLING_HEADER)),
mode===this.Mode_.STANDARD?(this.header_.classList.add(this.CssClasses_.CASTING_SHADOW),this.tabBar_&&this.tabBar_.classList.add(this.CssClasses_.CASTING_SHADOW)):mode===this.Mode_.SEAMED||mode===this.Mode_.SCROLL?(this.header_.classList.remove(this.CssClasses_.CASTING_SHADOW),this.tabBar_&&this.tabBar_.classList.remove(this.CssClasses_.CASTING_SHADOW)):mode===this.Mode_.WATERFALL&&(this.content_.addEventListener("scroll",this.contentScrollHandler_.bind(this)),this.contentScrollHandler_())),this.drawer_){var drawerButton=this.element_.querySelector("."+this.CssClasses_.DRAWER_BTN);if(!drawerButton){drawerButton=document.createElement("div"),drawerButton.classList.add(this.CssClasses_.DRAWER_BTN);var drawerButtonIcon=document.createElement("i");drawerButtonIcon.classList.add(this.CssClasses_.ICON),drawerButtonIcon.textContent=this.Constant_.MENU_ICON,drawerButton.appendChild(drawerButtonIcon)}this.drawer_.classList.contains(this.CssClasses_.ON_LARGE_SCREEN)?drawerButton.classList.add(this.CssClasses_.ON_LARGE_SCREEN):this.drawer_.classList.contains(this.CssClasses_.ON_SMALL_SCREEN)&&drawerButton.classList.add(this.CssClasses_.ON_SMALL_SCREEN),drawerButton.addEventListener("click",this.drawerToggleHandler_.bind(this)),this.element_.classList.add(this.CssClasses_.HAS_DRAWER),this.element_.classList.contains(this.CssClasses_.FIXED_HEADER)?this.header_.insertBefore(drawerButton,this.header_.firstChild):this.element_.insertBefore(drawerButton,this.content_);var obfuscator=document.createElement("div");obfuscator.classList.add(this.CssClasses_.OBFUSCATOR),this.element_.appendChild(obfuscator),obfuscator.addEventListener("click",this.drawerToggleHandler_.bind(this)),this.obfuscator_=obfuscator}if(this.screenSizeMediaQuery_=window.matchMedia(this.Constant_.MAX_WIDTH),this.screenSizeMediaQuery_.addListener(this.screenSizeHandler_.bind(this)),this.screenSizeHandler_(),this.header_&&this.tabBar_){this.element_.classList.add(this.CssClasses_.HAS_TABS);var tabContainer=document.createElement("div");tabContainer.classList.add(this.CssClasses_.TAB_CONTAINER),this.header_.insertBefore(tabContainer,this.tabBar_),this.header_.removeChild(this.tabBar_);var leftButton=document.createElement("div");leftButton.classList.add(this.CssClasses_.TAB_BAR_BUTTON),leftButton.classList.add(this.CssClasses_.TAB_BAR_LEFT_BUTTON);var leftButtonIcon=document.createElement("i");leftButtonIcon.classList.add(this.CssClasses_.ICON),leftButtonIcon.textContent=this.Constant_.CHEVRON_LEFT,leftButton.appendChild(leftButtonIcon),leftButton.addEventListener("click",function(){this.tabBar_.scrollLeft-=this.Constant_.TAB_SCROLL_PIXELS}.bind(this));var rightButton=document.createElement("div");rightButton.classList.add(this.CssClasses_.TAB_BAR_BUTTON),rightButton.classList.add(this.CssClasses_.TAB_BAR_RIGHT_BUTTON);var rightButtonIcon=document.createElement("i");rightButtonIcon.classList.add(this.CssClasses_.ICON),rightButtonIcon.textContent=this.Constant_.CHEVRON_RIGHT,rightButton.appendChild(rightButtonIcon),rightButton.addEventListener("click",function(){this.tabBar_.scrollLeft+=this.Constant_.TAB_SCROLL_PIXELS}.bind(this)),tabContainer.appendChild(leftButton),tabContainer.appendChild(this.tabBar_),tabContainer.appendChild(rightButton);var tabScrollHandler=function(){this.tabBar_.scrollLeft>0?leftButton.classList.add(this.CssClasses_.IS_ACTIVE):leftButton.classList.remove(this.CssClasses_.IS_ACTIVE),this.tabBar_.scrollLeft<this.tabBar_.scrollWidth-this.tabBar_.offsetWidth?rightButton.classList.add(this.CssClasses_.IS_ACTIVE):rightButton.classList.remove(this.CssClasses_.IS_ACTIVE)}.bind(this);this.tabBar_.addEventListener("scroll",tabScrollHandler),tabScrollHandler(),this.tabBar_.classList.contains(this.CssClasses_.JS_RIPPLE_EFFECT)&&this.tabBar_.classList.add(this.CssClasses_.RIPPLE_IGNORE_EVENTS);for(var tabs=this.tabBar_.querySelectorAll("."+this.CssClasses_.TAB),panels=this.content_.querySelectorAll("."+this.CssClasses_.PANEL),i=0;i<tabs.length;i++)new MaterialLayoutTab(tabs[i],tabs,panels,this)}this.element_.classList.add(this.CssClasses_.IS_UPGRADED)}},componentHandler.register({constructor:MaterialLayout,classAsString:"MaterialLayout",cssClass:"mdl-js-layout"});var MaterialDataTable=function(element){this.element_=element,this.init()};window.MaterialDataTable=MaterialDataTable,MaterialDataTable.prototype.Constant_={},MaterialDataTable.prototype.CssClasses_={DATA_TABLE:"mdl-data-table",SELECTABLE:"mdl-data-table--selectable",SELECT_ELEMENT:"mdl-data-table__select",IS_SELECTED:"is-selected",IS_UPGRADED:"is-upgraded"},MaterialDataTable.prototype.selectRow_=function(checkbox,row,opt_rows){return row?function(){checkbox.checked?row.classList.add(this.CssClasses_.IS_SELECTED):row.classList.remove(this.CssClasses_.IS_SELECTED)}.bind(this):opt_rows?function(){var i,el;if(checkbox.checked)for(i=0;i<opt_rows.length;i++)el=opt_rows[i].querySelector("td").querySelector(".mdl-checkbox"),el.MaterialCheckbox.check(),opt_rows[i].classList.add(this.CssClasses_.IS_SELECTED);else for(i=0;i<opt_rows.length;i++)el=opt_rows[i].querySelector("td").querySelector(".mdl-checkbox"),el.MaterialCheckbox.uncheck(),opt_rows[i].classList.remove(this.CssClasses_.IS_SELECTED)}.bind(this):void 0},MaterialDataTable.prototype.createCheckbox_=function(row,opt_rows){var label=document.createElement("label"),labelClasses=["mdl-checkbox","mdl-js-checkbox","mdl-js-ripple-effect",this.CssClasses_.SELECT_ELEMENT];label.className=labelClasses.join(" ");var checkbox=document.createElement("input");return checkbox.type="checkbox",checkbox.classList.add("mdl-checkbox__input"),checkbox.addEventListener("change",this.selectRow_(checkbox,row,opt_rows)),label.appendChild(checkbox),componentHandler.upgradeElement(label,"MaterialCheckbox"),label},MaterialDataTable.prototype.init=function(){if(this.element_){var firstHeader=this.element_.querySelector("th"),rows=this.element_.querySelector("tbody").querySelectorAll("tr");if(this.element_.classList.contains(this.CssClasses_.SELECTABLE)){var th=document.createElement("th"),headerCheckbox=this.createCheckbox_(null,rows);th.appendChild(headerCheckbox),firstHeader.parentElement.insertBefore(th,firstHeader);for(var i=0;i<rows.length;i++){var firstCell=rows[i].querySelector("td");if(firstCell){var td=document.createElement("td"),rowCheckbox=this.createCheckbox_(rows[i]);td.appendChild(rowCheckbox),rows[i].insertBefore(td,firstCell)}}}this.element_.classList.add(this.CssClasses_.IS_UPGRADED)}},componentHandler.register({constructor:MaterialDataTable,classAsString:"MaterialDataTable",cssClass:"mdl-js-data-table"});var MaterialRipple=function(element){this.element_=element,this.init()};window.MaterialRipple=MaterialRipple,MaterialRipple.prototype.Constant_={INITIAL_SCALE:"scale(0.0001, 0.0001)",INITIAL_SIZE:"1px",INITIAL_OPACITY:"0.4",FINAL_OPACITY:"0",FINAL_SCALE:""},MaterialRipple.prototype.CssClasses_={RIPPLE_CENTER:"mdl-ripple--center",RIPPLE_EFFECT_IGNORE_EVENTS:"mdl-js-ripple-effect--ignore-events",RIPPLE:"mdl-ripple",IS_ANIMATING:"is-animating",IS_VISIBLE:"is-visible"},MaterialRipple.prototype.downHandler_=function(event){if(!this.rippleElement_.style.width&&!this.rippleElement_.style.height){var rect=this.element_.getBoundingClientRect();this.boundHeight=rect.height,this.boundWidth=rect.width,this.rippleSize_=2*Math.sqrt(rect.width*rect.width+rect.height*rect.height)+2,this.rippleElement_.style.width=this.rippleSize_+"px",this.rippleElement_.style.height=this.rippleSize_+"px"}if(this.rippleElement_.classList.add(this.CssClasses_.IS_VISIBLE),"mousedown"===event.type&&this.ignoringMouseDown_)this.ignoringMouseDown_=!1;else{"touchstart"===event.type&&(this.ignoringMouseDown_=!0);var frameCount=this.getFrameCount();if(frameCount>0)return;this.setFrameCount(1);var x,y,bound=event.currentTarget.getBoundingClientRect();if(0===event.clientX&&0===event.clientY)x=Math.round(bound.width/2),y=Math.round(bound.height/2);else{var clientX=event.clientX?event.clientX:event.touches[0].clientX,clientY=event.clientY?event.clientY:event.touches[0].clientY;x=Math.round(clientX-bound.left),y=Math.round(clientY-bound.top)}this.setRippleXY(x,y),this.setRippleStyles(!0),window.requestAnimationFrame(this.animFrameHandler.bind(this))}},MaterialRipple.prototype.upHandler_=function(event){event&&2!==event.detail&&this.rippleElement_.classList.remove(this.CssClasses_.IS_VISIBLE),window.setTimeout(function(){this.rippleElement_.classList.remove(this.CssClasses_.IS_VISIBLE)}.bind(this),0)},MaterialRipple.prototype.init=function(){if(this.element_){var recentering=this.element_.classList.contains(this.CssClasses_.RIPPLE_CENTER);this.element_.classList.contains(this.CssClasses_.RIPPLE_EFFECT_IGNORE_EVENTS)||(this.rippleElement_=this.element_.querySelector("."+this.CssClasses_.RIPPLE),this.frameCount_=0,this.rippleSize_=0,this.x_=0,this.y_=0,this.ignoringMouseDown_=!1,this.boundDownHandler=this.downHandler_.bind(this),this.element_.addEventListener("mousedown",this.boundDownHandler),this.element_.addEventListener("touchstart",this.boundDownHandler),this.boundUpHandler=this.upHandler_.bind(this),this.element_.addEventListener("mouseup",this.boundUpHandler),this.element_.addEventListener("mouseleave",this.boundUpHandler),this.element_.addEventListener("touchend",this.boundUpHandler),this.element_.addEventListener("blur",this.boundUpHandler),this.getFrameCount=function(){return this.frameCount_},this.setFrameCount=function(fC){this.frameCount_=fC},this.getRippleElement=function(){return this.rippleElement_},this.setRippleXY=function(newX,newY){this.x_=newX,this.y_=newY},this.setRippleStyles=function(start){if(null!==this.rippleElement_){var transformString,scale,size,offset="translate("+this.x_+"px, "+this.y_+"px)";start?(scale=this.Constant_.INITIAL_SCALE,size=this.Constant_.INITIAL_SIZE):(scale=this.Constant_.FINAL_SCALE,size=this.rippleSize_+"px",recentering&&(offset="translate("+this.boundWidth/2+"px, "+this.boundHeight/2+"px)")),transformString="translate(-50%, -50%) "+offset+scale,this.rippleElement_.style.webkitTransform=transformString,this.rippleElement_.style.msTransform=transformString,this.rippleElement_.style.transform=transformString,start?this.rippleElement_.classList.remove(this.CssClasses_.IS_ANIMATING):this.rippleElement_.classList.add(this.CssClasses_.IS_ANIMATING)}},this.animFrameHandler=function(){this.frameCount_-- >0?window.requestAnimationFrame(this.animFrameHandler.bind(this)):this.setRippleStyles(!1)})}},MaterialRipple.prototype.mdlDowngrade_=function(){this.element_.removeEventListener("mousedown",this.boundDownHandler),this.element_.removeEventListener("touchstart",this.boundDownHandler),this.element_.removeEventListener("mouseup",this.boundUpHandler),this.element_.removeEventListener("mouseleave",this.boundUpHandler),this.element_.removeEventListener("touchend",this.boundUpHandler),this.element_.removeEventListener("blur",this.boundUpHandler)},MaterialRipple.prototype.mdlDowngrade=MaterialRipple.prototype.mdlDowngrade_,MaterialRipple.prototype.mdlDowngrade=MaterialRipple.prototype.mdlDowngrade,componentHandler.register({constructor:MaterialRipple,classAsString:"MaterialRipple",cssClass:"mdl-js-ripple-effect",widget:!1})}(),function(namespace){function show(toastConfig){previousToast&&hideToast(previousToast);var currentToastConfig=cloneObject(localToastConfig);overrideObjectProperties(currentToastConfig,toastConfig),toastConfig=null;var currentToast=createToastAndInsertToastMessage(currentToastConfig);currentToastConfig.actionInnerText&&currentToastConfig.actionCallback&&insertToastButton(currentToastConfig,currentToast),overrideObjectProperties(currentToast.style,currentToastConfig.style),document.body.appendChild(currentToast);var toastComputedStyles=window.getComputedStyle(currentToast);toastComputedStyles.height===toastComputedStyles.lineHeight?currentToast.classList.add("singleline"):currentToast.classList.add("multiline"),currentToast.classList.add("madtaras-toast-fade-in"),currentToast.addEventListener("click",function(){hideToast(currentToast)}),setTimeout(function(){hideToast(currentToast)},currentToastConfig.duration),previousToast=currentToast}function hideToast(toast){toast&&(toast.addEventListener("webkitAnimationEnd",function(){deleteToast(toast)}),toast.addEventListener("animationend",function(){deleteToast(toast)}),toast.classList.add("madtaras-toast-fade-out"))}function deleteToast(toast){toast&&(toast.remove(),toast=null)}function createToastAndInsertToastMessage(currentToastConfig){var currentToast=document.createElement("div");return currentToast.className="madtaras-toast",currentToast.insertAdjacentHTML("afterbegin",'<span class="madtaras-toast_text">'+currentToastConfig.innerText+"</span>"),currentToast}function insertToastButton(currentToastConfig,currentToast){currentToast.insertAdjacentHTML("beforeend",'<span class="madtaras-toast_action-btn">'+currentToastConfig.actionInnerText+"</span>"),currentToast.querySelector(".madtaras-toast_action-btn").addEventListener("click",function(){deleteToast(currentToast),currentToastConfig.actionCallback()})}function cloneObject(objectToClone){return JSON.parse(JSON.stringify(objectToClone))}function changeConfig(toastConfig){overrideObjectProperties(localToastConfig,toastConfig)}function overrideObjectProperties(theTarget,theSource){if(theSource.hasOwnProperty("style"))for(var styleProperty in theSource.style)theSource.style.hasOwnProperty(styleProperty)&&(theTarget.style[styleProperty]=theSource.style[styleProperty]);for(var property in theSource)theSource.hasOwnProperty(property)&&"style"!==property&&(theTarget[property]=theSource[property])}var previousToast,localToastConfig={duration:3e3,style:{}};namespace.show=show,namespace.changeConfig=changeConfig}(this.madtarasToast=this.madtarasToast||{}),!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.Slideout=t()}}(function(){return function i(t,e,n){function o(r,a){if(!e[r]){if(!t[r]){var u="function"==typeof require&&require;if(!a&&u)return u(r,!0);if(s)return s(r,!0);var l=new Error("Cannot find module '"+r+"'");throw l.code="MODULE_NOT_FOUND",l}var f=e[r]={exports:{}};t[r][0].call(f.exports,function(e){var n=t[r][1][e];return o(n?n:e)},f,f.exports,i,t,e,n)}return e[r].exports}for(var s="function"==typeof require&&require,r=0;r<n.length;r++)o(n[r]);return o}({1:[function(t,e,n){"use strict";function c(t,e){for(var n in e)e[n]&&(t[n]=e[n]);return t}function p(t,e){t.prototype=c(t.prototype||{},e.prototype)}function d(t){t=t||{},this._startOffsetX=0,this._currentOffsetX=0,this._opening=!1,this._moved=!1,this._opened=!1,this._preventOpen=!1,this._touch=void 0===t.touch?!0:t.touch&&!0,this.panel=t.panel,this.menu=t.menu,-1===this.panel.className.search("slideout-panel")&&(this.panel.className+=" slideout-panel"),-1===this.menu.className.search("slideout-menu")&&(this.menu.className+=" slideout-menu"),this._fx=t.fx||"ease",this._duration=parseInt(t.duration,10)||300,this._tolerance=parseInt(t.tolerance,10)||70,this._padding=this._translateTo=parseInt(t.padding,10)||256,this._orientation="right"===t.side?-1:1,this._translateTo*=this._orientation,this._touch&&this._initTouchEvents()}var s,i=t("decouple"),o=t("emitter"),r=!1,a=window.document,u=a.documentElement,l=window.navigator.msPointerEnabled,f={start:l?"MSPointerDown":"touchstart",move:l?"MSPointerMove":"touchmove",end:l?"MSPointerUp":"touchend"},h=function(){var t=/^(Webkit|Khtml|Moz|ms|O)(?=[A-Z])/,e=a.getElementsByTagName("script")[0].style;for(var n in e)if(t.test(n))return"-"+n.match(t)[0].toLowerCase()+"-";return"WebkitOpacity"in e?"-webkit-":"KhtmlOpacity"in e?"-khtml-":""}();p(d,o),d.prototype.open=function(){var t=this;return this.emit("beforeopen"),-1===u.className.search("slideout-open")&&(u.className+=" slideout-open"),this._setTransition(),this._translateXTo(this._translateTo),this._opened=!0,setTimeout(function(){t.panel.style.transition=t.panel.style["-webkit-transition"]="",t.emit("open")},this._duration+50),this},d.prototype.close=function(){var t=this;return this.isOpen()||this._opening?(this.emit("beforeclose"),this._setTransition(),this._translateXTo(0),this._opened=!1,setTimeout(function(){u.className=u.className.replace(/ slideout-open/,""),t.panel.style.transition=t.panel.style["-webkit-transition"]=t.panel.style[h+"transform"]=t.panel.style.transform="",t.emit("close")},this._duration+50),this):this},d.prototype.toggle=function(){return this.isOpen()?this.close():this.open()},d.prototype.isOpen=function(){return this._opened},d.prototype._translateXTo=function(t){return this._currentOffsetX=t,this.panel.style[h+"transform"]=this.panel.style.transform="translateX("+t+"px)",this},d.prototype._setTransition=function(){return this.panel.style[h+"transition"]=this.panel.style.transition=h+"transform "+this._duration+"ms "+this._fx,this},d.prototype._initTouchEvents=function(){var t=this;return this._onScrollFn=i(a,"scroll",function(){t._moved||(clearTimeout(s),r=!0,s=setTimeout(function(){r=!1},250))}),this._preventMove=function(e){t._moved&&e.preventDefault()},a.addEventListener(f.move,this._preventMove),this._resetTouchFn=function(e){"undefined"!=typeof e.touches&&(t._moved=!1,t._opening=!1,t._startOffsetX=e.touches[0].pageX,t._preventOpen=!t._touch||!t.isOpen()&&0!==t.menu.clientWidth)},this.panel.addEventListener(f.start,this._resetTouchFn),this._onTouchCancelFn=function(){t._moved=!1,t._opening=!1},this.panel.addEventListener("touchcancel",this._onTouchCancelFn),this._onTouchEndFn=function(){t._moved&&(t._opening&&Math.abs(t._currentOffsetX)>t._tolerance?t.open():t.close()),t._moved=!1},this.panel.addEventListener(f.end,this._onTouchEndFn),this._onTouchMoveFn=function(e){if(!r&&!t._preventOpen&&"undefined"!=typeof e.touches){var n=e.touches[0].clientX-t._startOffsetX,i=t._currentOffsetX=n;if(!(Math.abs(i)>t._padding)&&Math.abs(n)>20){t._opening=!0;var o=n*t._orientation;if(t._opened&&o>0||!t._opened&&0>o)return;0>=o&&(i=n+t._padding*t._orientation,t._opening=!1),t._moved||-1!==u.className.search("slideout-open")||(u.className+=" slideout-open"),t.panel.style[h+"transform"]=t.panel.style.transform="translateX("+i+"px)",t.emit("translate",i),t._moved=!0}}},this.panel.addEventListener(f.move,this._onTouchMoveFn),this},d.prototype.enableTouch=function(){return this._touch=!0,this},d.prototype.disableTouch=function(){return this._touch=!1,this},d.prototype.destroy=function(){return this.close(),a.removeEventListener(f.move,this._preventMove),this.panel.removeEventListener(f.start,this._resetTouchFn),this.panel.removeEventListener("touchcancel",this._onTouchCancelFn),this.panel.removeEventListener(f.end,this._onTouchEndFn),this.panel.removeEventListener(f.move,this._onTouchMoveFn),a.removeEventListener("scroll",this._onScrollFn),this.open=this.close=function(){},this},e.exports=d},{decouple:2,emitter:3}],2:[function(t,e,n){"use strict";function o(t,e,n){function r(t){o=t,a()}function a(){s||(i(u),s=!0)}function u(){n.call(t,o),s=!1}var o,s=!1;return t.addEventListener(e,r,!1),r}var i=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}();e.exports=o},{}],3:[function(t,e,n){"use strict";var i=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")};n.__esModule=!0;var o=function(){function t(){i(this,t)}return t.prototype.on=function(t,n){return this._eventCollection=this._eventCollection||{},this._eventCollection[t]=this._eventCollection[t]||[],this._eventCollection[t].push(n),this},t.prototype.once=function n(t,e){function i(){n.off(t,i),e.apply(this,arguments)}var n=this;return i.listener=e,this.on(t,i),this},t.prototype.off=function(t,e){var n=void 0;return this._eventCollection&&(n=this._eventCollection[t])?(n.forEach(function(t,i){(t===e||t.listener===e)&&n.splice(i,1)}),0===n.length&&delete this._eventCollection[t],this):this},t.prototype.emit=function s(t){for(var e=this,n=arguments.length,i=Array(n>1?n-1:0),o=1;n>o;o++)i[o-1]=arguments[o];var s=void 0;return this._eventCollection&&(s=this._eventCollection[t])?(s=s.slice(0),s.forEach(function(t){return t.apply(e,i)}),this):this},t}();n["default"]=o,e.exports=n["default"]},{}]},{},[1])(1)});var __extends=this.__extends||function(d,b){function __(){this.constructor=d}for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p]);__.prototype=b.prototype,d.prototype=new __},MutationObserverCtor;if(MutationObserverCtor="undefined"!=typeof WebKitMutationObserver?WebKitMutationObserver:MutationObserver,void 0===MutationObserverCtor)throw console.error("DOM Mutation Observers are required."),console.error("https://developer.mozilla.org/en-US/docs/DOM/MutationObserver"),Error("DOM Mutation Observers are required");var NodeMap=function(){function NodeMap(){this.nodes=[],this.values=[]}return NodeMap.prototype.isIndex=function(s){return+s===s>>>0},NodeMap.prototype.nodeId=function(node){var id=node[NodeMap.ID_PROP];return id||(id=node[NodeMap.ID_PROP]=NodeMap.nextId_++),id},NodeMap.prototype.set=function(node,value){var id=this.nodeId(node);this.nodes[id]=node,this.values[id]=value},NodeMap.prototype.get=function(node){var id=this.nodeId(node);return this.values[id]},NodeMap.prototype.has=function(node){return this.nodeId(node)in this.nodes},NodeMap.prototype["delete"]=function(node){var id=this.nodeId(node);delete this.nodes[id],this.values[id]=void 0},NodeMap.prototype.keys=function(){var nodes=[];for(var id in this.nodes)this.isIndex(id)&&nodes.push(this.nodes[id]);return nodes},NodeMap.ID_PROP="__mutation_summary_node_map_id__",NodeMap.nextId_=1,NodeMap}(),Movement;!function(Movement){Movement[Movement.STAYED_OUT=0]="STAYED_OUT",Movement[Movement.ENTERED=1]="ENTERED",Movement[Movement.STAYED_IN=2]="STAYED_IN",Movement[Movement.REPARENTED=3]="REPARENTED",Movement[Movement.REORDERED=4]="REORDERED",Movement[Movement.EXITED=5]="EXITED"}(Movement||(Movement={}));var NodeChange=function(){function NodeChange(node,childList,attributes,characterData,oldParentNode,added,attributeOldValues,characterDataOldValue){void 0===childList&&(childList=!1),void 0===attributes&&(attributes=!1),void 0===characterData&&(characterData=!1),void 0===oldParentNode&&(oldParentNode=null),void 0===added&&(added=!1),void 0===attributeOldValues&&(attributeOldValues=null),void 0===characterDataOldValue&&(characterDataOldValue=null),this.node=node,this.childList=childList,this.attributes=attributes,this.characterData=characterData,this.oldParentNode=oldParentNode,this.added=added,this.attributeOldValues=attributeOldValues,this.characterDataOldValue=characterDataOldValue,this.isCaseInsensitive=this.node.nodeType===Node.ELEMENT_NODE&&this.node instanceof HTMLElement&&this.node.ownerDocument instanceof HTMLDocument}return NodeChange.prototype.getAttributeOldValue=function(name){return this.attributeOldValues?(this.isCaseInsensitive&&(name=name.toLowerCase()),this.attributeOldValues[name]):void 0},NodeChange.prototype.getAttributeNamesMutated=function(){var names=[];if(!this.attributeOldValues)return names;for(var name in this.attributeOldValues)names.push(name);return names},NodeChange.prototype.attributeMutated=function(name,oldValue){this.attributes=!0,this.attributeOldValues=this.attributeOldValues||{},name in this.attributeOldValues||(this.attributeOldValues[name]=oldValue)},NodeChange.prototype.characterDataMutated=function(oldValue){this.characterData||(this.characterData=!0,this.characterDataOldValue=oldValue)},NodeChange.prototype.removedFromParent=function(parent){this.childList=!0,this.added||this.oldParentNode?this.added=!1:this.oldParentNode=parent},NodeChange.prototype.insertedIntoParent=function(){this.childList=!0,this.added=!0},NodeChange.prototype.getOldParent=function(){if(this.childList){if(this.oldParentNode)return this.oldParentNode;if(this.added)return null}return this.node.parentNode},NodeChange}(),ChildListChange=function(){function ChildListChange(){this.added=new NodeMap,this.removed=new NodeMap,this.maybeMoved=new NodeMap,this.oldPrevious=new NodeMap,this.moved=void 0}return ChildListChange}(),TreeChanges=function(_super){function TreeChanges(rootNode,mutations){_super.call(this),this.rootNode=rootNode,this.reachableCache=void 0,this.wasReachableCache=void 0,this.anyParentsChanged=!1,this.anyAttributesChanged=!1,this.anyCharacterDataChanged=!1;for(var m=0;m<mutations.length;m++){var mutation=mutations[m];switch(mutation.type){case"childList":this.anyParentsChanged=!0;for(var i=0;i<mutation.removedNodes.length;i++){var node=mutation.removedNodes[i];this.getChange(node).removedFromParent(mutation.target)}for(var i=0;i<mutation.addedNodes.length;i++){var node=mutation.addedNodes[i];this.getChange(node).insertedIntoParent()}break;case"attributes":this.anyAttributesChanged=!0;var change=this.getChange(mutation.target);change.attributeMutated(mutation.attributeName,mutation.oldValue);break;case"characterData":this.anyCharacterDataChanged=!0;var change=this.getChange(mutation.target);change.characterDataMutated(mutation.oldValue)}}}return __extends(TreeChanges,_super),TreeChanges.prototype.getChange=function(node){var change=this.get(node);return change||(change=new NodeChange(node),this.set(node,change)),change},TreeChanges.prototype.getOldParent=function(node){var change=this.get(node);return change?change.getOldParent():node.parentNode},TreeChanges.prototype.getIsReachable=function(node){if(node===this.rootNode)return!0;if(!node)return!1;this.reachableCache=this.reachableCache||new NodeMap;var isReachable=this.reachableCache.get(node);return void 0===isReachable&&(isReachable=this.getIsReachable(node.parentNode),this.reachableCache.set(node,isReachable)),isReachable},TreeChanges.prototype.getWasReachable=function(node){if(node===this.rootNode)return!0;if(!node)return!1;this.wasReachableCache=this.wasReachableCache||new NodeMap;var wasReachable=this.wasReachableCache.get(node);return void 0===wasReachable&&(wasReachable=this.getWasReachable(this.getOldParent(node)),this.wasReachableCache.set(node,wasReachable)),wasReachable},TreeChanges.prototype.reachabilityChange=function(node){return this.getIsReachable(node)?this.getWasReachable(node)?Movement.STAYED_IN:Movement.ENTERED:this.getWasReachable(node)?Movement.EXITED:Movement.STAYED_OUT},TreeChanges}(NodeMap),MutationProjection=function(){function MutationProjection(rootNode,mutations,selectors,calcReordered,calcOldPreviousSibling){this.rootNode=rootNode,this.mutations=mutations,this.selectors=selectors,this.calcReordered=calcReordered,this.calcOldPreviousSibling=calcOldPreviousSibling,this.treeChanges=new TreeChanges(rootNode,mutations),this.entered=[],this.exited=[],this.stayedIn=new NodeMap,this.visited=new NodeMap,this.childListChangeMap=void 0,this.characterDataOnly=void 0,this.matchCache=void 0,this.processMutations()}return MutationProjection.prototype.processMutations=function(){if(this.treeChanges.anyParentsChanged||this.treeChanges.anyAttributesChanged)for(var changedNodes=this.treeChanges.keys(),i=0;i<changedNodes.length;i++)this.visitNode(changedNodes[i],void 0)},MutationProjection.prototype.visitNode=function(node,parentReachable){if(!this.visited.has(node)){this.visited.set(node,!0);var change=this.treeChanges.get(node),reachable=parentReachable;if((change&&change.childList||void 0==reachable)&&(reachable=this.treeChanges.reachabilityChange(node)),reachable!==Movement.STAYED_OUT){if(this.matchabilityChange(node),reachable===Movement.ENTERED)this.entered.push(node);else if(reachable===Movement.EXITED)this.exited.push(node),this.ensureHasOldPreviousSiblingIfNeeded(node);else if(reachable===Movement.STAYED_IN){var movement=Movement.STAYED_IN;change&&change.childList&&(change.oldParentNode!==node.parentNode?(movement=Movement.REPARENTED,this.ensureHasOldPreviousSiblingIfNeeded(node)):this.calcReordered&&this.wasReordered(node)&&(movement=Movement.REORDERED)),this.stayedIn.set(node,movement)}if(reachable!==Movement.STAYED_IN)for(var child=node.firstChild;child;child=child.nextSibling)this.visitNode(child,reachable)}}},MutationProjection.prototype.ensureHasOldPreviousSiblingIfNeeded=function(node){if(this.calcOldPreviousSibling){this.processChildlistChanges();var parentNode=node.parentNode,nodeChange=this.treeChanges.get(node);nodeChange&&nodeChange.oldParentNode&&(parentNode=nodeChange.oldParentNode);var change=this.childListChangeMap.get(parentNode);change||(change=new ChildListChange,this.childListChangeMap.set(parentNode,change)),change.oldPrevious.has(node)||change.oldPrevious.set(node,node.previousSibling)}},MutationProjection.prototype.getChanged=function(summary,selectors,characterDataOnly){this.selectors=selectors,this.characterDataOnly=characterDataOnly;for(var i=0;i<this.entered.length;i++){var node=this.entered[i],matchable=this.matchabilityChange(node);(matchable===Movement.ENTERED||matchable===Movement.STAYED_IN)&&summary.added.push(node)}for(var stayedInNodes=this.stayedIn.keys(),i=0;i<stayedInNodes.length;i++){var node=stayedInNodes[i],matchable=this.matchabilityChange(node);if(matchable===Movement.ENTERED)summary.added.push(node);else if(matchable===Movement.EXITED)summary.removed.push(node);else if(matchable===Movement.STAYED_IN&&(summary.reparented||summary.reordered)){var movement=this.stayedIn.get(node);summary.reparented&&movement===Movement.REPARENTED?summary.reparented.push(node):summary.reordered&&movement===Movement.REORDERED&&summary.reordered.push(node)}}for(var i=0;i<this.exited.length;i++){var node=this.exited[i],matchable=this.matchabilityChange(node);(matchable===Movement.EXITED||matchable===Movement.STAYED_IN)&&summary.removed.push(node)}},MutationProjection.prototype.getOldParentNode=function(node){var change=this.treeChanges.get(node);if(change&&change.childList)return change.oldParentNode?change.oldParentNode:null;var reachabilityChange=this.treeChanges.reachabilityChange(node);if(reachabilityChange===Movement.STAYED_OUT||reachabilityChange===Movement.ENTERED)throw Error("getOldParentNode requested on invalid node.");return node.parentNode},MutationProjection.prototype.getOldPreviousSibling=function(node){var parentNode=node.parentNode,nodeChange=this.treeChanges.get(node);nodeChange&&nodeChange.oldParentNode&&(parentNode=nodeChange.oldParentNode);var change=this.childListChangeMap.get(parentNode);if(!change)throw Error("getOldPreviousSibling requested on invalid node.");return change.oldPrevious.get(node)},MutationProjection.prototype.getOldAttribute=function(element,attrName){var change=this.treeChanges.get(element);if(!change||!change.attributes)throw Error("getOldAttribute requested on invalid node.");var value=change.getAttributeOldValue(attrName);if(void 0===value)throw Error("getOldAttribute requested for unchanged attribute name.");return value},MutationProjection.prototype.attributeChangedNodes=function(includeAttributes){if(!this.treeChanges.anyAttributesChanged)return{};var attributeFilter,caseInsensitiveFilter;if(includeAttributes){attributeFilter={},caseInsensitiveFilter={};for(var i=0;i<includeAttributes.length;i++){var attrName=includeAttributes[i];attributeFilter[attrName]=!0,caseInsensitiveFilter[attrName.toLowerCase()]=attrName}}for(var result={},nodes=this.treeChanges.keys(),i=0;i<nodes.length;i++){var node=nodes[i],change=this.treeChanges.get(node);if(change.attributes&&Movement.STAYED_IN===this.treeChanges.reachabilityChange(node)&&Movement.STAYED_IN===this.matchabilityChange(node))for(var element=node,changedAttrNames=change.getAttributeNamesMutated(),j=0;j<changedAttrNames.length;j++){var attrName=changedAttrNames[j];if(!attributeFilter||attributeFilter[attrName]||change.isCaseInsensitive&&caseInsensitiveFilter[attrName]){var oldValue=change.getAttributeOldValue(attrName);oldValue!==element.getAttribute(attrName)&&(caseInsensitiveFilter&&change.isCaseInsensitive&&(attrName=caseInsensitiveFilter[attrName]),
result[attrName]=result[attrName]||[],result[attrName].push(element))}}}return result},MutationProjection.prototype.getOldCharacterData=function(node){var change=this.treeChanges.get(node);if(!change||!change.characterData)throw Error("getOldCharacterData requested on invalid node.");return change.characterDataOldValue},MutationProjection.prototype.getCharacterDataChanged=function(){if(!this.treeChanges.anyCharacterDataChanged)return[];for(var nodes=this.treeChanges.keys(),result=[],i=0;i<nodes.length;i++){var target=nodes[i];if(Movement.STAYED_IN===this.treeChanges.reachabilityChange(target)){var change=this.treeChanges.get(target);change.characterData&&target.textContent!=change.characterDataOldValue&&result.push(target)}}return result},MutationProjection.prototype.computeMatchabilityChange=function(selector,el){this.matchCache||(this.matchCache=[]),this.matchCache[selector.uid]||(this.matchCache[selector.uid]=new NodeMap);var cache=this.matchCache[selector.uid],result=cache.get(el);return void 0===result&&(result=selector.matchabilityChange(el,this.treeChanges.get(el)),cache.set(el,result)),result},MutationProjection.prototype.matchabilityChange=function(node){var _this=this;if(this.characterDataOnly)switch(node.nodeType){case Node.COMMENT_NODE:case Node.TEXT_NODE:return Movement.STAYED_IN;default:return Movement.STAYED_OUT}if(!this.selectors)return Movement.STAYED_IN;if(node.nodeType!==Node.ELEMENT_NODE)return Movement.STAYED_OUT;for(var el=node,matchChanges=this.selectors.map(function(selector){return _this.computeMatchabilityChange(selector,el)}),accum=Movement.STAYED_OUT,i=0;accum!==Movement.STAYED_IN&&i<matchChanges.length;){switch(matchChanges[i]){case Movement.STAYED_IN:accum=Movement.STAYED_IN;break;case Movement.ENTERED:accum=accum===Movement.EXITED?Movement.STAYED_IN:Movement.ENTERED;break;case Movement.EXITED:accum=accum===Movement.ENTERED?Movement.STAYED_IN:Movement.EXITED}i++}return accum},MutationProjection.prototype.getChildlistChange=function(el){var change=this.childListChangeMap.get(el);return change||(change=new ChildListChange,this.childListChangeMap.set(el,change)),change},MutationProjection.prototype.processChildlistChanges=function(){function recordOldPrevious(node,previous){!node||change.oldPrevious.has(node)||change.added.has(node)||change.maybeMoved.has(node)||previous&&(change.added.has(previous)||change.maybeMoved.has(previous))||change.oldPrevious.set(node,previous)}if(!this.childListChangeMap){this.childListChangeMap=new NodeMap;for(var i=0;i<this.mutations.length;i++){var mutation=this.mutations[i];if("childList"==mutation.type&&(this.treeChanges.reachabilityChange(mutation.target)===Movement.STAYED_IN||this.calcOldPreviousSibling)){for(var change=this.getChildlistChange(mutation.target),oldPrevious=mutation.previousSibling,j=0;j<mutation.removedNodes.length;j++){var node=mutation.removedNodes[j];recordOldPrevious(node,oldPrevious),change.added.has(node)?change.added["delete"](node):(change.removed.set(node,!0),change.maybeMoved["delete"](node)),oldPrevious=node}recordOldPrevious(mutation.nextSibling,oldPrevious);for(var j=0;j<mutation.addedNodes.length;j++){var node=mutation.addedNodes[j];change.removed.has(node)?(change.removed["delete"](node),change.maybeMoved.set(node,!0)):change.added.set(node,!0)}}}}},MutationProjection.prototype.wasReordered=function(node){function isMoved(node){if(!node)return!1;if(!change.maybeMoved.has(node))return!1;var didMove=change.moved.get(node);return void 0!==didMove?didMove:(pendingMoveDecision.has(node)?didMove=!0:(pendingMoveDecision.set(node,!0),didMove=getPrevious(node)!==getOldPrevious(node)),pendingMoveDecision.has(node)?(pendingMoveDecision["delete"](node),change.moved.set(node,didMove)):didMove=change.moved.get(node),didMove)}function getOldPrevious(node){var oldPrevious=oldPreviousCache.get(node);if(void 0!==oldPrevious)return oldPrevious;for(oldPrevious=change.oldPrevious.get(node);oldPrevious&&(change.removed.has(oldPrevious)||isMoved(oldPrevious));)oldPrevious=getOldPrevious(oldPrevious);return void 0===oldPrevious&&(oldPrevious=node.previousSibling),oldPreviousCache.set(node,oldPrevious),oldPrevious}function getPrevious(node){if(previousCache.has(node))return previousCache.get(node);for(var previous=node.previousSibling;previous&&(change.added.has(previous)||isMoved(previous));)previous=previous.previousSibling;return previousCache.set(node,previous),previous}if(!this.treeChanges.anyParentsChanged)return!1;this.processChildlistChanges();var parentNode=node.parentNode,nodeChange=this.treeChanges.get(node);nodeChange&&nodeChange.oldParentNode&&(parentNode=nodeChange.oldParentNode);var change=this.childListChangeMap.get(parentNode);if(!change)return!1;if(change.moved)return change.moved.get(node);change.moved=new NodeMap;var pendingMoveDecision=new NodeMap,oldPreviousCache=new NodeMap,previousCache=new NodeMap;return change.maybeMoved.keys().forEach(isMoved),change.moved.get(node)},MutationProjection}(),Summary=function(){function Summary(projection,query){var _this=this;if(this.projection=projection,this.added=[],this.removed=[],this.reparented=query.all||query.element||query.characterData?[]:void 0,this.reordered=query.all?[]:void 0,projection.getChanged(this,query.elementFilter,query.characterData),query.all||query.attribute||query.attributeList){var filter=query.attribute?[query.attribute]:query.attributeList,attributeChanged=projection.attributeChangedNodes(filter);query.attribute?this.valueChanged=attributeChanged[query.attribute]||[]:(this.attributeChanged=attributeChanged,query.attributeList&&query.attributeList.forEach(function(attrName){_this.attributeChanged.hasOwnProperty(attrName)||(_this.attributeChanged[attrName]=[])}))}if(query.all||query.characterData){var characterDataChanged=projection.getCharacterDataChanged();query.characterData?this.valueChanged=characterDataChanged:this.characterDataChanged=characterDataChanged}this.reordered&&(this.getOldPreviousSibling=projection.getOldPreviousSibling.bind(projection))}return Summary.prototype.getOldParentNode=function(node){return this.projection.getOldParentNode(node)},Summary.prototype.getOldAttribute=function(node,name){return this.projection.getOldAttribute(node,name)},Summary.prototype.getOldCharacterData=function(node){return this.projection.getOldCharacterData(node)},Summary.prototype.getOldPreviousSibling=function(node){return this.projection.getOldPreviousSibling(node)},Summary}(),validNameInitialChar=/[a-zA-Z_]+/,validNameNonInitialChar=/[a-zA-Z0-9_\-]+/,Qualifier=function(){function Qualifier(){}return Qualifier.prototype.matches=function(oldValue){if(null===oldValue)return!1;if(void 0===this.attrValue)return!0;if(!this.contains)return this.attrValue==oldValue;for(var tokens=oldValue.split(" "),i=0;i<tokens.length;i++)if(this.attrValue===tokens[i])return!0;return!1},Qualifier.prototype.toString=function(){return"class"===this.attrName&&this.contains?"."+this.attrValue:"id"!==this.attrName||this.contains?this.contains?"["+this.attrName+"~="+escapeQuotes(this.attrValue)+"]":"attrValue"in this?"["+this.attrName+"="+escapeQuotes(this.attrValue)+"]":"["+this.attrName+"]":"#"+this.attrValue},Qualifier}(),Selector=function(){function Selector(){this.uid=Selector.nextUid++,this.qualifiers=[]}return Object.defineProperty(Selector.prototype,"caseInsensitiveTagName",{get:function(){return this.tagName.toUpperCase()},enumerable:!0,configurable:!0}),Object.defineProperty(Selector.prototype,"selectorString",{get:function(){return this.tagName+this.qualifiers.join("")},enumerable:!0,configurable:!0}),Selector.prototype.isMatching=function(el){return el[Selector.matchesSelector](this.selectorString)},Selector.prototype.wasMatching=function(el,change,isMatching){if(!change||!change.attributes)return isMatching;var tagName=change.isCaseInsensitive?this.caseInsensitiveTagName:this.tagName;if("*"!==tagName&&tagName!==el.tagName)return!1;for(var attributeOldValues=[],anyChanged=!1,i=0;i<this.qualifiers.length;i++){var qualifier=this.qualifiers[i],oldValue=change.getAttributeOldValue(qualifier.attrName);attributeOldValues.push(oldValue),anyChanged=anyChanged||void 0!==oldValue}if(!anyChanged)return isMatching;for(var i=0;i<this.qualifiers.length;i++){var qualifier=this.qualifiers[i],oldValue=attributeOldValues[i];if(void 0===oldValue&&(oldValue=el.getAttribute(qualifier.attrName)),!qualifier.matches(oldValue))return!1}return!0},Selector.prototype.matchabilityChange=function(el,change){var isMatching=this.isMatching(el);return isMatching?this.wasMatching(el,change,isMatching)?Movement.STAYED_IN:Movement.ENTERED:this.wasMatching(el,change,isMatching)?Movement.EXITED:Movement.STAYED_OUT},Selector.parseSelectors=function(input){function newSelector(){currentSelector&&(currentQualifier&&(currentSelector.qualifiers.push(currentQualifier),currentQualifier=void 0),selectors.push(currentSelector)),currentSelector=new Selector}function newQualifier(){currentQualifier&&currentSelector.qualifiers.push(currentQualifier),currentQualifier=new Qualifier}for(var currentSelector,currentQualifier,valueQuoteChar,selectors=[],WHITESPACE=/\s/,SYNTAX_ERROR="Invalid or unsupported selector syntax.",SELECTOR=1,TAG_NAME=2,QUALIFIER=3,QUALIFIER_NAME_FIRST_CHAR=4,QUALIFIER_NAME=5,ATTR_NAME_FIRST_CHAR=6,ATTR_NAME=7,EQUIV_OR_ATTR_QUAL_END=8,EQUAL=9,ATTR_QUAL_END=10,VALUE_FIRST_CHAR=11,VALUE=12,QUOTED_VALUE=13,SELECTOR_SEPARATOR=14,state=SELECTOR,i=0;i<input.length;){var c=input[i++];switch(state){case SELECTOR:if(c.match(validNameInitialChar)){newSelector(),currentSelector.tagName=c,state=TAG_NAME;break}if("*"==c){newSelector(),currentSelector.tagName="*",state=QUALIFIER;break}if("."==c){newSelector(),newQualifier(),currentSelector.tagName="*",currentQualifier.attrName="class",currentQualifier.contains=!0,state=QUALIFIER_NAME_FIRST_CHAR;break}if("#"==c){newSelector(),newQualifier(),currentSelector.tagName="*",currentQualifier.attrName="id",state=QUALIFIER_NAME_FIRST_CHAR;break}if("["==c){newSelector(),newQualifier(),currentSelector.tagName="*",currentQualifier.attrName="",state=ATTR_NAME_FIRST_CHAR;break}if(c.match(WHITESPACE))break;throw Error(SYNTAX_ERROR);case TAG_NAME:if(c.match(validNameNonInitialChar)){currentSelector.tagName+=c;break}if("."==c){newQualifier(),currentQualifier.attrName="class",currentQualifier.contains=!0,state=QUALIFIER_NAME_FIRST_CHAR;break}if("#"==c){newQualifier(),currentQualifier.attrName="id",state=QUALIFIER_NAME_FIRST_CHAR;break}if("["==c){newQualifier(),currentQualifier.attrName="",state=ATTR_NAME_FIRST_CHAR;break}if(c.match(WHITESPACE)){state=SELECTOR_SEPARATOR;break}if(","==c){state=SELECTOR;break}throw Error(SYNTAX_ERROR);case QUALIFIER:if("."==c){newQualifier(),currentQualifier.attrName="class",currentQualifier.contains=!0,state=QUALIFIER_NAME_FIRST_CHAR;break}if("#"==c){newQualifier(),currentQualifier.attrName="id",state=QUALIFIER_NAME_FIRST_CHAR;break}if("["==c){newQualifier(),currentQualifier.attrName="",state=ATTR_NAME_FIRST_CHAR;break}if(c.match(WHITESPACE)){state=SELECTOR_SEPARATOR;break}if(","==c){state=SELECTOR;break}throw Error(SYNTAX_ERROR);case QUALIFIER_NAME_FIRST_CHAR:if(c.match(validNameInitialChar)){currentQualifier.attrValue=c,state=QUALIFIER_NAME;break}throw Error(SYNTAX_ERROR);case QUALIFIER_NAME:if(c.match(validNameNonInitialChar)){currentQualifier.attrValue+=c;break}if("."==c){newQualifier(),currentQualifier.attrName="class",currentQualifier.contains=!0,state=QUALIFIER_NAME_FIRST_CHAR;break}if("#"==c){newQualifier(),currentQualifier.attrName="id",state=QUALIFIER_NAME_FIRST_CHAR;break}if("["==c){newQualifier(),state=ATTR_NAME_FIRST_CHAR;break}if(c.match(WHITESPACE)){state=SELECTOR_SEPARATOR;break}if(","==c){state=SELECTOR;break}throw Error(SYNTAX_ERROR);case ATTR_NAME_FIRST_CHAR:if(c.match(validNameInitialChar)){currentQualifier.attrName=c,state=ATTR_NAME;break}if(c.match(WHITESPACE))break;throw Error(SYNTAX_ERROR);case ATTR_NAME:if(c.match(validNameNonInitialChar)){currentQualifier.attrName+=c;break}if(c.match(WHITESPACE)){state=EQUIV_OR_ATTR_QUAL_END;break}if("~"==c){currentQualifier.contains=!0,state=EQUAL;break}if("="==c){currentQualifier.attrValue="",state=VALUE_FIRST_CHAR;break}if("]"==c){state=QUALIFIER;break}throw Error(SYNTAX_ERROR);case EQUIV_OR_ATTR_QUAL_END:if("~"==c){currentQualifier.contains=!0,state=EQUAL;break}if("="==c){currentQualifier.attrValue="",state=VALUE_FIRST_CHAR;break}if("]"==c){state=QUALIFIER;break}if(c.match(WHITESPACE))break;throw Error(SYNTAX_ERROR);case EQUAL:if("="==c){currentQualifier.attrValue="",state=VALUE_FIRST_CHAR;break}throw Error(SYNTAX_ERROR);case ATTR_QUAL_END:if("]"==c){state=QUALIFIER;break}if(c.match(WHITESPACE))break;throw Error(SYNTAX_ERROR);case VALUE_FIRST_CHAR:if(c.match(WHITESPACE))break;if('"'==c||"'"==c){valueQuoteChar=c,state=QUOTED_VALUE;break}currentQualifier.attrValue+=c,state=VALUE;break;case VALUE:if(c.match(WHITESPACE)){state=ATTR_QUAL_END;break}if("]"==c){state=QUALIFIER;break}if("'"==c||'"'==c)throw Error(SYNTAX_ERROR);currentQualifier.attrValue+=c;break;case QUOTED_VALUE:if(c==valueQuoteChar){state=ATTR_QUAL_END;break}currentQualifier.attrValue+=c;break;case SELECTOR_SEPARATOR:if(c.match(WHITESPACE))break;if(","==c){state=SELECTOR;break}throw Error(SYNTAX_ERROR)}}switch(state){case SELECTOR:case TAG_NAME:case QUALIFIER:case QUALIFIER_NAME:case SELECTOR_SEPARATOR:newSelector();break;default:throw Error(SYNTAX_ERROR)}if(!selectors.length)throw Error(SYNTAX_ERROR);return selectors},Selector.nextUid=1,Selector.matchesSelector=function(){var element=document.createElement("div");return"function"==typeof element.webkitMatchesSelector?"webkitMatchesSelector":"function"==typeof element.mozMatchesSelector?"mozMatchesSelector":"function"==typeof element.msMatchesSelector?"msMatchesSelector":"matchesSelector"}(),Selector}(),attributeFilterPattern=/^([a-zA-Z:_]+[a-zA-Z0-9_\-:\.]*)$/,MutationSummary=function(){function MutationSummary(opts){var _this=this;this.connected=!1,this.options=MutationSummary.validateOptions(opts),this.observerOptions=MutationSummary.createObserverOptions(this.options.queries),this.root=this.options.rootNode,this.callback=this.options.callback,this.elementFilter=Array.prototype.concat.apply([],this.options.queries.map(function(query){return query.elementFilter?query.elementFilter:[]})),this.elementFilter.length||(this.elementFilter=void 0),this.calcReordered=this.options.queries.some(function(query){return query.all}),this.queryValidators=[],MutationSummary.createQueryValidator&&(this.queryValidators=this.options.queries.map(function(query){return MutationSummary.createQueryValidator(_this.root,query)})),this.observer=new MutationObserverCtor(function(mutations){_this.observerCallback(mutations)}),this.reconnect()}return MutationSummary.createObserverOptions=function(queries){function observeAttributes(attributes){if(!observerOptions.attributes||attributeFilter){if(observerOptions.attributes=!0,observerOptions.attributeOldValue=!0,!attributes)return void(attributeFilter=void 0);attributeFilter=attributeFilter||{},attributes.forEach(function(attribute){attributeFilter[attribute]=!0,attributeFilter[attribute.toLowerCase()]=!0})}}var attributeFilter,observerOptions={childList:!0,subtree:!0};return queries.forEach(function(query){if(query.characterData)return observerOptions.characterData=!0,void(observerOptions.characterDataOldValue=!0);if(query.all)return observeAttributes(),observerOptions.characterData=!0,void(observerOptions.characterDataOldValue=!0);if(query.attribute)return void observeAttributes([query.attribute.trim()]);var attributes=elementFilterAttributes(query.elementFilter).concat(query.attributeList||[]);attributes.length&&observeAttributes(attributes)}),attributeFilter&&(observerOptions.attributeFilter=Object.keys(attributeFilter)),observerOptions},MutationSummary.validateOptions=function(options){for(var prop in options)if(!(prop in MutationSummary.optionKeys))throw Error("Invalid option: "+prop);if("function"!=typeof options.callback)throw Error("Invalid options: callback is required and must be a function");if(!options.queries||!options.queries.length)throw Error("Invalid options: queries must contain at least one query request object.");for(var opts={callback:options.callback,rootNode:options.rootNode||document,observeOwnChanges:!!options.observeOwnChanges,oldPreviousSibling:!!options.oldPreviousSibling,queries:[]},i=0;i<options.queries.length;i++){var request=options.queries[i];if(request.all){if(Object.keys(request).length>1)throw Error("Invalid request option. all has no options.");opts.queries.push({all:!0})}else if("attribute"in request){var query={attribute:validateAttribute(request.attribute)};if(query.elementFilter=Selector.parseSelectors("*["+query.attribute+"]"),Object.keys(request).length>1)throw Error("Invalid request option. attribute has no options.");opts.queries.push(query)}else if("element"in request){var requestOptionCount=Object.keys(request).length,query={element:request.element,elementFilter:Selector.parseSelectors(request.element)};if(request.hasOwnProperty("elementAttributes")&&(query.attributeList=validateElementAttributes(request.elementAttributes),requestOptionCount--),requestOptionCount>1)throw Error("Invalid request option. element only allows elementAttributes option.");opts.queries.push(query)}else{if(!request.characterData)throw Error("Invalid request option. Unknown query request.");if(Object.keys(request).length>1)throw Error("Invalid request option. characterData has no options.");opts.queries.push({characterData:!0})}}return opts},MutationSummary.prototype.createSummaries=function(mutations){if(!mutations||!mutations.length)return[];for(var projection=new MutationProjection(this.root,mutations,this.elementFilter,this.calcReordered,this.options.oldPreviousSibling),summaries=[],i=0;i<this.options.queries.length;i++)summaries.push(new Summary(projection,this.options.queries[i]));return summaries},MutationSummary.prototype.checkpointQueryValidators=function(){this.queryValidators.forEach(function(validator){validator&&validator.recordPreviousState()})},MutationSummary.prototype.runQueryValidators=function(summaries){this.queryValidators.forEach(function(validator,index){validator&&validator.validate(summaries[index])})},MutationSummary.prototype.changesToReport=function(summaries){return summaries.some(function(summary){var summaryProps=["added","removed","reordered","reparented","valueChanged","characterDataChanged"];if(summaryProps.some(function(prop){return summary[prop]&&summary[prop].length}))return!0;if(summary.attributeChanged){var attrNames=Object.keys(summary.attributeChanged),attrsChanged=attrNames.some(function(attrName){return!!summary.attributeChanged[attrName].length});if(attrsChanged)return!0}return!1})},MutationSummary.prototype.observerCallback=function(mutations){this.options.observeOwnChanges||this.observer.disconnect();var summaries=this.createSummaries(mutations);this.runQueryValidators(summaries),this.options.observeOwnChanges&&this.checkpointQueryValidators(),this.changesToReport(summaries)&&this.callback(summaries),!this.options.observeOwnChanges&&this.connected&&(this.checkpointQueryValidators(),this.observer.observe(this.root,this.observerOptions))},MutationSummary.prototype.reconnect=function(){if(this.connected)throw Error("Already connected");this.observer.observe(this.root,this.observerOptions),this.connected=!0,this.checkpointQueryValidators()},MutationSummary.prototype.takeSummaries=function(){if(!this.connected)throw Error("Not connected");var summaries=this.createSummaries(this.observer.takeRecords());return this.changesToReport(summaries)?summaries:void 0},MutationSummary.prototype.disconnect=function(){var summaries=this.takeSummaries();return this.observer.disconnect(),this.connected=!1,summaries},MutationSummary.NodeMap=NodeMap,MutationSummary.parseElementFilter=Selector.parseSelectors,MutationSummary.optionKeys={callback:!0,queries:!0,rootNode:!0,oldPreviousSibling:!0,observeOwnChanges:!0},MutationSummary}(),Arrive=function(r,n,q){function t(e,a,c){f.addMethod(a,c,e.unbindEvent),f.addMethod(a,c,e.unbindEventWithSelectorOrCallback),f.addMethod(a,c,e.unbindEventWithSelectorAndCallback)}function p(e){e.arrive=k.bindEvent,t(k,e,"unbindArrive"),e.leave=h.bindEvent,t(h,e,"unbindLeave")}if(r.MutationObserver&&"undefined"!=typeof HTMLElement){var w=0,f=function(){var e=HTMLElement.prototype.matches||HTMLElement.prototype.webkitMatchesSelector||HTMLElement.prototype.mozMatchesSelector||HTMLElement.prototype.msMatchesSelector;return{matchesSelector:function(a,c){return a instanceof HTMLElement&&e.call(a,c)},addMethod:function(a,c,d){var b=a[c];a[c]=function(){return d.length==arguments.length?d.apply(this,arguments):"function"==typeof b?b.apply(this,arguments):void 0}},callCallbacks:function(a){for(var d,c=0;d=a[c];c++)d.callback.call(d.elem)},checkChildNodesRecursively:function(a,c,d,b){for(var m,u=0;m=a[u];u++)d(m,c,b)&&b.push({callback:c.callback,elem:m}),0<m.childNodes.length&&f.checkChildNodesRecursively(m.childNodes,c,d,b)},mergeArrays:function(a,c){var b,d={};for(b in a)d[b]=a[b];for(b in c)d[b]=c[b];return d},toElementsArray:function(a){return"undefined"==typeof a||"number"==typeof a.length&&a!==r||(a=[a]),a}}}(),x=function(){var e=function(){this._eventsBucket=[],this._beforeRemoving=this._beforeAdding=null};return e.prototype.addEvent=function(a,c,d,b){return a={target:a,selector:c,options:d,callback:b,firedElems:[]},this._beforeAdding&&this._beforeAdding(a),this._eventsBucket.push(a),a},e.prototype.removeEvent=function(a){for(var d,c=this._eventsBucket.length-1;d=this._eventsBucket[c];c--)a(d)&&(this._beforeRemoving&&this._beforeRemoving(d),this._eventsBucket.splice(c,1))},e.prototype.beforeAdding=function(a){this._beforeAdding=a},e.prototype.beforeRemoving=function(a){this._beforeRemoving=a},e}(),v=function(e,a){var c=new x,d=this,b={fireOnAttributesModification:!1};return c.beforeAdding(function(b){var l,c=b.target;(c===r.document||c===r)&&(c=document.getElementsByTagName("html")[0]),l=new MutationObserver(function(d){a.call(this,d,b)});var g=e(b.options);l.observe(c,g),b.observer=l,b.me=d}),c.beforeRemoving(function(b){b.observer.disconnect()}),this.bindEvent=function(d,a,l){a=f.mergeArrays(b,a);for(var g=f.toElementsArray(this),e=0;e<g.length;e++)c.addEvent(g[e],d,a,l)},this.unbindEvent=function(){var b=f.toElementsArray(this);c.removeEvent(function(a){for(var d=0;d<b.length;d++)if(this===q||a.target===b[d])return!0;return!1})},this.unbindEventWithSelectorOrCallback=function(b){var d=f.toElementsArray(this);c.removeEvent("function"==typeof b?function(a){for(var c=0;c<d.length;c++)if((this===q||a.target===d[c])&&a.callback===b)return!0;return!1}:function(a){for(var c=0;c<d.length;c++)if((this===q||a.target===d[c])&&a.selector===b)return!0;return!1})},this.unbindEventWithSelectorAndCallback=function(b,a){var d=f.toElementsArray(this);c.removeEvent(function(c){for(var e=0;e<d.length;e++)if((this===q||c.target===d[e])&&c.selector===b&&c.callback===a)return!0;return!1})},this},k=new function(){function e(d,b,a){if(f.matchesSelector(d,b.selector)&&(d._id===q&&(d._id=w++),-1==b.firedElems.indexOf(d._id))){if(b.options.onceOnly){if(0!==b.firedElems.length)return;b.me.unbindEventWithSelectorAndCallback.call(b.target,b.selector,b.callback)}b.firedElems.push(d._id),a.push({callback:b.callback,elem:d})}}var a={fireOnAttributesModification:!1,onceOnly:!1,existing:!1};k=new v(function(a){var b={attributes:!1,childList:!0,subtree:!0};return a.fireOnAttributesModification&&(b.attributes=!0),b},function(a,b){a.forEach(function(a){var d=a.addedNodes,c=a.target,g=[];null!==d&&0<d.length?f.checkChildNodesRecursively(d,b,e,g):"attributes"===a.type&&e(c,b,g)&&g.push({callback:b.callback,elem:node}),f.callCallbacks(g)})});var c=k.bindEvent;return k.bindEvent=function(d,b,e){"undefined"==typeof e?(e=b,b=a):b=f.mergeArrays(a,b);var m=f.toElementsArray(this);if(b.existing){for(var l=[],g=0;g<m.length;g++)for(var k=m[g].querySelectorAll(d),h=0;h<k.length;h++)l.push({callback:e,elem:k[h]});if(b.onceOnly&&l.length)return e.call(l[0].elem);f.callCallbacks(l)}c.call(this,d,b,e)},k},h=new function(){function e(a,b){return f.matchesSelector(a,b.selector)}var a={};h=new v(function(a){return{childList:!0,subtree:!0}},function(a,b){a.forEach(function(a){a=a.removedNodes;var c=[];null!==a&&0<a.length&&f.checkChildNodesRecursively(a,b,e,c),f.callCallbacks(c)})});var c=h.bindEvent;return h.bindEvent=function(d,b,e){"undefined"==typeof e?(e=b,b=a):b=f.mergeArrays(a,b),c.call(this,d,b,e)},h};return n&&p(n.fn),p(HTMLElement.prototype),p(NodeList.prototype),p(HTMLCollection.prototype),p(HTMLDocument.prototype),p(Window.prototype),n={},t(k,n,"unbindAllArrive"),t(h,n,"unbindAllLeave"),n}}(this,"undefined"==typeof jQuery?null:jQuery,void 0);!function(g,c){"undefined"!=typeof module?module.exports=c():"function"==typeof define&&"object"==typeof define.amd?define(c):this[g]=c()}("Jets",function(){function g(c){if(!(this instanceof g))return new g(c);var a=this;["searchTag","contentTag"].forEach(function(b){var d=b.replace("Tag","");if(a[d+"_tag"]=document["querySelector"+("contentTag"==b?"All":"")](c[b]),a[d+"_param"]=c[b],!a[d+"_tag"])throw Error("Error! Could not find "+b+" element")});var b={searchSelector:"*AND",diacriticsMap:{}};if(a.options={},"columns addImportant searchSelector manualContentHandling diacriticsMap didSearch".split(" ").forEach(function(d){a.options[d]=c[d]||b[d]}),1<this.options.searchSelector.length){var d=a.options.searchSelector.trim();a.options.searchSelector=d.substr(0,1),a.options.searchSelectorMode=d.substr(1).toUpperCase()}var e,h=function(){e!=(e=a.search_tag.value)&&(a._applyCSS(),a.options.didSearch&&a.options.didSearch(a.search_tag.value))};a._onSearch=function(a){return"keydown"==a.type?setTimeout(h,0):void h()},a.destroy=function(){a._processEventListeners("remove"),a._destroy()},a._processEventListeners("add"),a._addStyleTag(),a._setJets(),a._applyCSS()}return g.prototype={constructor:g,_processEventListeners:function(c){["input","keydown","change"].forEach(function(a){this.search_tag[c+"EventListener"](a,this._onSearch)}.bind(this))},_applyCSS:function(){for(var c=this.replaceDiacritics(this.search_tag.value.trim().toLowerCase().replace(/\s\s+/g," ")),a=this.options.searchSelectorMode?c.split(" ").filter(function(a,c,b){return b.indexOf(a)==c}):[c],b="AND"==this.options.searchSelectorMode,d=[],e=0,h=a.length;h>e;e++)d.push((b?this.content_param+">":"")+":not([data-jets"+this.options.searchSelector+'="'+a[e]+'"])');a=(b?"":this.content_param+">")+d.join(b?",":"")+"{display:none"+(this.options.addImportant?"!important":"")+"}",this.styleTag.innerHTML=c.length?a:""},_addStyleTag:function(){this.styleTag=document.createElement("style"),document.head.appendChild(this.styleTag)},_getText:function(c){return c&&(c.innerText||c.textContent)||""},_getContentTags:function(c){return Array.prototype.slice.call(this.content_tag).reduce(function(a,b){return a.concat(Array.prototype.slice.call(b.querySelectorAll(c||":scope > *")))},[])},_setJets:function(c,a){for(var e,f,b=this,d=b._getContentTags(a?"":c),h=0;f=d[h];h++)(!f.hasAttribute("data-jets")||a)&&(e=this.options.manualContentHandling?this.options.manualContentHandling(f):b.options.columns&&b.options.columns.length?b.options.columns.map(function(a){return b._getText(f.children[a])}).join(" "):b._getText(f),f.setAttribute("data-jets",b.replaceDiacritics(e.trim().replace(/\s+/g," ").toLowerCase())))},replaceDiacritics:function(c){var b,a=this.options.diacriticsMap;for(b in a)if(a.hasOwnProperty(b))for(var d=0,e=a[b].length;e>d;d++)c=c.replace(new RegExp(a[b][d],"g"),b);return c},update:function(c){this._setJets(":scope > :not([data-jets])",c)},_destroy:function(){this.styleTag.parentNode&&document.head.removeChild(this.styleTag);for(var b,c=this._getContentTags(),a=0;b=c[a];a++)b.removeAttribute("data-jets")}},function(c,a){try{c.querySelector(":scope body")}catch(b){["querySelector","querySelectorAll"].forEach(function(b){var e=a[b];a[b]=function(a){if(/(^|,)\s*:scope/.test(a)){var f=this.id;return this.id="ID_"+Date.now(),a=a.replace(/((^|,)\s*):scope/g,"$1#"+this.id),a=c[b](a),this.id=f,a}return e.call(this,a)}})}}(window.document,Element.prototype),g});var Sha1=function(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.pad_[0]=128;for(var i=1;64>i;++i)this.pad_[i]=0;this.reset()};Sha1.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},Sha1.prototype.rotl_=function(w,r){return 4294967295&(w<<r|w>>>32-r)},Sha1.prototype.compress_=function(buf){for(var W=this.W_,i=0;64>i;i+=4){var w=buf[i]<<24|buf[i+1]<<16|buf[i+2]<<8|buf[i+3];W[i/4]=w}for(var i=16;80>i;i++)W[i]=this.rotl_(W[i-3]^W[i-8]^W[i-14]^W[i-16],1);for(var f,k,a=this.chain_[0],b=this.chain_[1],c=this.chain_[2],d=this.chain_[3],e=this.chain_[4],i=0;80>i;i++){40>i?20>i?(f=d^b&(c^d),k=1518500249):(f=b^c^d,k=1859775393):60>i?(f=b&c|d&(b|c),k=2400959708):(f=b^c^d,k=3395469782);var t=this.rotl_(a,5)+f+e+k+W[i]&4294967295;e=d,d=c,c=this.rotl_(b,30),b=a,a=t}this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+b&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+d&4294967295,this.chain_[4]=this.chain_[4]+e&4294967295},Sha1.prototype.update=function(bytes,opt_length){opt_length||(opt_length=bytes.length);var n=0;if(0==this.inbuf_)for(;opt_length>n+64;)this.compress_(bytes.slice(n,n+64)),n+=64,this.total_+=64;for(;opt_length>n;)if(this.buf_[this.inbuf_++]=bytes[n++],this.total_++,64==this.inbuf_)for(this.inbuf_=0,this.compress_(this.buf_);opt_length>n+64;)this.compress_(bytes.slice(n,n+64)),n+=64,this.total_+=64},Sha1.prototype.digest=function(){var digest=[],totalBits=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,64-(this.inbuf_-56));for(var i=63;i>=56;i--)this.buf_[i]=255&totalBits,totalBits>>>=8;this.compress_(this.buf_);for(var n=0,i=0;5>i;i++)for(var j=24;j>=0;j-=8)digest[n++]=this.chain_[i]>>j&255;return digest};var http=function(){function EventSource(){this.listeners_={}}function HttpServer(){EventSource.apply(this),this.readyState_=0}function HttpRequest(headers,socketId){this.version="HTTP/1.1",this.headers=headers,this.responseHeaders_={},this.headersSent=!1,this.socketId_=socketId,this.writes_=0,this.bytesRemaining=0,this.finished_=!1,this.readyState=1}function WebSocketServer(httpServer){EventSource.apply(this),httpServer.addEventListener("upgrade",this.upgradeToWebSocket_.bind(this))}function WebSocketRequest(httpRequest){HttpRequest.apply(this,[httpRequest.headers,httpRequest.socketId_]),httpRequest.socketId_=0}function WebSocketServerSocket(socketId){this.socketId_=socketId,EventSource.apply(this),this.readFromSocket_()}var socket=chrome.experimental&&chrome.experimental.socket||chrome.socket;if(!socket)return{};var responseMap={200:"OK",301:"Moved Permanently",304:"Not Modified",400:"Bad Request",401:"Unauthorized",403:"Forbidden",404:"Not Found",413:"Request Entity Too Large",414:"Request-URI Too Long",500:"Internal Server Error"},arrayBufferToString=function(buffer){for(var array=new Uint8Array(buffer),str="",i=0;i<array.length;++i)str+=String.fromCharCode(array[i]);return str},ary2utf8=function(){var patterns=[{pattern:"0xxxxxxx",bytes:1},{pattern:"110xxxxx",bytes:2},{pattern:"1110xxxx",bytes:3},{pattern:"11110xxx",bytes:4},{pattern:"111110xx",bytes:5},{pattern:"1111110x",bytes:6}];return patterns.forEach(function(item){item.header=item.pattern.replace(/[^10]/g,""),item.pattern01=item.pattern.replace(/[^10]/g,"0"),item.pattern01=parseInt(item.pattern01,2),item.mask_length=item.header.length,item.data_length=8-item.header.length;for(var mask="",i=0,len=item.mask_length;len>i;i++)mask+="1";for(var i=0,len=item.data_length;len>i;i++)mask+="0";item.mask=mask,item.mask=parseInt(item.mask,2)}),function(ary){for(var codes=[],cur=0;cur<ary.length;){
for(var first=ary[cur],pattern=null,i=0,len=patterns.length;len>i;i++)if((first&patterns[i].mask)==patterns[i].pattern01){pattern=patterns[i];break}if(null==pattern)throw"utf-8 decode error";var rest=ary.slice(cur+1,cur+pattern.bytes);cur+=pattern.bytes;var code="";code+=("00000000"+(first&(255^pattern.mask)).toString(2)).slice(-pattern.data_length);for(var i=0,len=rest.length;len>i;i++)code+=("00000000"+(rest[i]&parseInt("111111",2)).toString(2)).slice(-6);codes.push(parseInt(code,2))}return String.fromCharCode.apply(null,codes)}}(),utf82ary=function(){var patterns=[{pattern:"0xxxxxxx",bytes:1},{pattern:"110xxxxx",bytes:2},{pattern:"1110xxxx",bytes:3},{pattern:"11110xxx",bytes:4},{pattern:"111110xx",bytes:5},{pattern:"1111110x",bytes:6}];patterns.forEach(function(item){item.header=item.pattern.replace(/[^10]/g,""),item.mask_length=item.header.length,item.data_length=8-item.header.length,item.max_bit_length=6*(item.bytes-1)+item.data_length});var code2utf8array=function(code){for(var pattern=null,code01=code.toString(2),i=0,len=patterns.length;len>i;i++)if(code01.length<=patterns[i].max_bit_length){pattern=patterns[i];break}if(null==pattern)throw"utf-8 encode error";for(var ary=[],i=0,len=pattern.bytes-1;len>i;i++)ary.unshift(parseInt("10"+("000000"+code01.slice(-6)).slice(-6),2)),code01=code01.slice(0,-6);return ary.unshift(parseInt(pattern.header+("00000000"+code01).slice(-pattern.data_length),2)),ary};return function(str){for(var codes=[],i=0,len=str.length;len>i;i++){var code=str.charCodeAt(i);Array.prototype.push.apply(codes,code2utf8array(code))}return codes}}(),stringToArrayBuffer=function(string){for(var buffer=new ArrayBuffer(string.length),bufferView=new Uint8Array(buffer),i=0;i<string.length;i++)bufferView[i]=string.charCodeAt(i);return buffer};EventSource.prototype={addEventListener:function(type,callback){this.listeners_[type]||(this.listeners_[type]=[]),this.listeners_[type].push(callback)},removeEventListener:function(type,callback){if(this.listeners_[type])for(var i=this.listeners_[type].length-1;i>=0;i--)this.listeners_[type][i]==callback&&this.listeners_[type].splice(i,1)},dispatchEvent:function(type,var_args){if(!this.listeners_[type])return!1;for(var i=0;i<this.listeners_[type].length;i++)if(this.listeners_[type][i].apply(null,Array.prototype.slice.call(arguments,1)))return!0}},HttpServer.prototype={__proto__:EventSource.prototype,listen:function(port,opt_host){var t=this;socket.create("tcp",{},function(socketInfo){t.socketInfo_=socketInfo,socket.listen(t.socketInfo_.socketId,opt_host||"0.0.0.0",port,50,function(result){t.readyState_=1,t.acceptConnection_(t.socketInfo_.socketId)})})},acceptConnection_:function(socketId){var t=this;socket.accept(this.socketInfo_.socketId,function(acceptInfo){t.onConnection_(acceptInfo),t.acceptConnection_(socketId)})},onConnection_:function(acceptInfo){this.readRequestFromSocket_(acceptInfo.socketId)},readRequestFromSocket_:function(socketId){var t=this,requestData="",endIndex=0,onDataRead=function(readInfo){if(readInfo.resultCode<=0)return socket.disconnect(socketId),void socket.destroy(socketId);if(requestData+=arrayBufferToString(readInfo.data).replace(/\r\n/g,"\n"),endIndex=requestData.indexOf("\n\n",endIndex),-1==endIndex)return endIndex=requestData.length-1,void socket.read(socketId,onDataRead);var headers=requestData.substring(0,endIndex).split("\n"),headerMap={},requestLine=headers[0].split(" ");headerMap.method=requestLine[0],headerMap.url=requestLine[1],headerMap["Http-Version"]=requestLine[2];for(var i=1;i<headers.length;i++)requestLine=headers[i].split(":",2),2==requestLine.length&&(headerMap[requestLine[0]]=requestLine[1].trim());var request=new HttpRequest(headerMap,socketId);t.onRequest_(request)};socket.read(socketId,onDataRead)},onRequest_:function(request){var type=request.headers.Upgrade?"upgrade":"request",keepAlive="keep-alive"==request.headers.Connection;this.dispatchEvent(type,request)?keepAlive&&this.readRequestFromSocket_(request.socketId_):request.close()}};var extensionTypes={css:"text/css",html:"text/html",htm:"text/html",jpg:"image/jpeg",jpeg:"image/jpeg",js:"text/javascript",png:"image/png",svg:"image/svg+xml",txt:"text/plain"};return HttpRequest.prototype={__proto__:EventSource.prototype,close:function(){"keep-alive"!=this.headers.Connection&&(socket.disconnect(this.socketId_),socket.destroy(this.socketId_)),this.socketId_=0,this.readyState=3},writeHead:function(responseCode,responseHeaders){var headerString=this.version+" "+responseCode+" "+(responseMap[responseCode]||"Unknown");this.responseHeaders_=responseHeaders,"keep-alive"==this.headers.Connection&&(responseHeaders.Connection="keep-alive"),responseHeaders["Content-Length"]||"keep-alive"!=responseHeaders.Connection||(responseHeaders["Transfer-Encoding"]="chunked");for(var i in responseHeaders)headerString+="\r\n"+i+": "+responseHeaders[i];headerString+="\r\n\r\n",this.write_(stringToArrayBuffer(headerString))},write:function(data){if("chunked"==this.responseHeaders_["Transfer-Encoding"]){for(var newline="\r\n",byteLength=data instanceof ArrayBuffer?data.byteLength:data.length,chunkLength=byteLength.toString(16).toUpperCase()+newline,buffer=new ArrayBuffer(chunkLength.length+byteLength+newline.length),bufferView=new Uint8Array(buffer),i=0;i<chunkLength.length;i++)bufferView[i]=chunkLength.charCodeAt(i);if(data instanceof ArrayBuffer)bufferView.set(new Uint8Array(data),chunkLength.length);else for(var i=0;i<data.length;i++)bufferView[chunkLength.length+i]=data.charCodeAt(i);for(var i=0;i<newline.length;i++)bufferView[chunkLength.length+byteLength+i]=newline.charCodeAt(i);data=buffer}else data instanceof ArrayBuffer||(data=stringToArrayBuffer(data));this.write_(data)},end:function(opt_data){opt_data&&this.write(opt_data),"chunked"==this.responseHeaders_["Transfer-Encoding"]&&this.write(""),this.finished_=!0,this.checkFinished_()},serveUrl:function(url){var t=this,xhr=new XMLHttpRequest;xhr.onloadend=function(){var type="text/plain";if(this.getResponseHeader("Content-Type"))type=this.getResponseHeader("Content-Type");else if(-1!=url.indexOf(".")){var extension=url.substr(url.indexOf(".")+1);type=extensionTypes[extension]||type}console.log("Served "+url);var contentLength=this.getResponseHeader("Content-Length");200==xhr.status&&(contentLength=this.response&&this.response.byteLength||0),t.writeHead(this.status,{"Content-Type":type,"Content-Length":contentLength}),t.end(this.response)},xhr.open("GET",url,!0),xhr.responseType="arraybuffer",xhr.send()},write_:function(array){var t=this;this.bytesRemaining+=array.byteLength,socket.write(this.socketId_,array,function(writeInfo){return writeInfo.bytesWritten<0?void console.error("Error writing to socket, code "+writeInfo.bytesWritten):(t.bytesRemaining-=writeInfo.bytesWritten,void t.checkFinished_())})},checkFinished_:function(){!this.finished_||this.bytesRemaining>0||this.close()}},WebSocketServer.prototype={__proto__:EventSource.prototype,upgradeToWebSocket_:function(request){return"websocket"==request.headers.Upgrade&&request.headers["Sec-WebSocket-Key"]&&this.dispatchEvent("request",new WebSocketRequest(request))?(request.socketId_&&request.reject(),!0):!1}},WebSocketRequest.prototype={__proto__:HttpRequest.prototype,accept:function(){var clientKey=this.headers["Sec-WebSocket-Key"],toArray=function(str){for(var a=[],i=0;i<str.length;i++)a.push(str.charCodeAt(i));return a},toString=function(a){for(var str="",i=0;i<a.length;i++)str+=String.fromCharCode(a[i]);return str},magicStr="258EAFA5-E914-47DA-95CA-C5AB0DC85B11";clientKey+=magicStr;var sha1=new Sha1;sha1.reset(),sha1.update(toArray(clientKey));var responseKey=btoa(toString(sha1.digest())),responseHeader={Upgrade:"websocket",Connection:"Upgrade","Sec-WebSocket-Accept":responseKey};this.headers["Sec-WebSocket-Protocol"]&&(responseHeader["Sec-WebSocket-Protocol"]=this.headers["Sec-WebSocket-Protocol"]),this.writeHead(101,responseHeader);var socket=new WebSocketServerSocket(this.socketId_);return this.socketId_=0,socket},reject:function(){this.close()}},WebSocketServerSocket.prototype={__proto__:EventSource.prototype,send:function(data){"string"==typeof data||data instanceof String?this.sendFrame_(1,data):this.sendFrame_(2,data)},close:function(){this.sendFrame_(8),this.readyState=2},readFromSocket_:function(){var t=this,data=[],fragmentedOp=0,fragmentedMessages=[],onDataRead=function(readInfo){if(readInfo.resultCode<=0)return void t.close_();if(!readInfo.data.byteLength)return void socket.read(t.socketId_,onDataRead);for(var a=new Uint8Array(readInfo.data),i=0;i<a.length;i++)data.push(a[i]);for(;data.length;){var mask,length_code=-1,data_start=6,fin=(128&data[0])>>7,op=15&data[0];if(data.length>1&&(length_code=127&data[1]),length_code>125)if(126==length_code&&data.length>7||127==length_code&&data.length>14){if(126==length_code)length_code=256*data[2]+data[3],mask=data.slice(4,8),data_start=8;else if(127==length_code){length_code=0;for(var i=0;8>i;i++)length_code=256*length_code+data[2+i];mask=data.slice(10,14),data_start=14}}else length_code=-1;else data.length>5&&(mask=data.slice(2,6));if(!(length_code>-1&&data.length>=data_start+length_code))break;var decoded=data.slice(data_start,data_start+length_code).map(function(byte,index){return byte^mask[index%4]});if(1==op&&(decoded=ary2utf8(decoded)),data=data.slice(data_start+length_code),fin&&op>0){if(!t.onFrame_(op,decoded))return}else if(fragmentedOp=fragmentedOp||op,fragmentedMessages.push(decoded),fin){var joinMessage=null;if(joinMessage=1==op?fragmentedMessagess.join(""):fragmentedMessages.reduce(function(pre,cur){return Array.prototype.push.apply(pre,cur)},[]),!t.onFrame_(fragmentedOp,joinMessage))return;fragmentedOp=0,fragmentedMessages=[]}}socket.read(t.socketId_,onDataRead)};socket.read(this.socketId_,onDataRead)},onFrame_:function(op,data){if(1==op||2==op)"string"==typeof data||data instanceof String||(Array.isArray(data)?data=new Uint8Array(data).buffer:data instanceof ArrayBuffer||(data=data.buffer)),this.dispatchEvent("message",{data:data});else if(8==op){if(1!=this.readyState)return this.close_(),!1;this.sendFrame_(8)}return!0},sendFrame_:function(op,data){var t=this,WebsocketFrameData=function(op,data){var ary=data;("string"==typeof data||data instanceof String)&&(ary=utf82ary(data)),Array.isArray(ary)&&(ary=new Uint8Array(ary)),ary instanceof ArrayBuffer&&(ary=new Uint8Array(ary)),ary=new Uint8Array(ary.buffer);var length=ary.length;length+=ary.length>65535?10:ary.length>125?4:2;var lengthBytes=0,buffer=new ArrayBuffer(length),bv=new Uint8Array(buffer);bv[0]=128|15&op,bv[1]=ary.length>65535?127:ary.length>125?126:ary.length,ary.length>65535?lengthBytes=8:ary.length>125&&(lengthBytes=2);for(var len=ary.length,i=lengthBytes-1;i>=0;i--)bv[2+i]=255&len,len>>=8;for(var dataStart=lengthBytes+2,i=0;i<ary.length;i++)bv[dataStart+i]=ary[i];return buffer},array=WebsocketFrameData(op,data||"");socket.write(this.socketId_,array,function(writeInfo){(writeInfo.resultCode<0||writeInfo.bytesWritten!==array.byteLength)&&t.close_()})},close_:function(){chrome.socket.disconnect(this.socketId_),chrome.socket.destroy(this.socketId_),this.readyState=3,this.dispatchEvent("close")}},{Server:HttpServer,WebSocketServer:WebSocketServer}}();!function(){function adjustMadtarasToastPosition(){var currentToast=document.querySelector(".madtaras-toast");document.documentElement.clientWidth>1024?(madtarasToast.changeConfig({style:{left:"252px"}}),currentToast&&(currentToast.style.left="252px")):document.documentElement.clientWidth>568?(madtarasToast.changeConfig({style:{left:"12px"}}),currentToast&&(currentToast.style.left="12px")):(madtarasToast.changeConfig({style:{left:"0"}}),currentToast&&(currentToast.style.left="0"))}var appRouter={},currentSection=document.getElementById("my-audios-section"),currentDrawerPanelNavLink=document.querySelector('.drawer-panel_nav_link[data-open="#my-audios-section"]'),drawerPanel=document.getElementById("drawer-panel");appRouter.navigateTo=function(sectionId){currentSection.classList.remove("current"),currentDrawerPanelNavLink.classList.remove("current"),document.documentElement.clientWidth<=1024&&slideout.close(),currentSection=document.querySelector(sectionId),currentDrawerPanelNavLink=document.querySelector('.drawer-panel_nav_link[data-open="'+sectionId+'"]'),currentSection.classList.add("current"),currentDrawerPanelNavLink.classList.add("current"),drawerPanel.classList.contains("is-visible")&&drawerPanel.classList.remove("is-visible")},Array.prototype.forEach.call(document.querySelectorAll(".drawer-panel_nav_link"),function(drawerPanelNavLink){drawerPanelNavLink.addEventListener("click",function(event){appRouter.navigateTo(event.target.dataset.open)})}),adjustMadtarasToastPosition();var slideout=new Slideout({panel:document.getElementById("content"),menu:document.getElementById("drawer-panel"),padding:240});document.documentElement.clientWidth>1024&&slideout.open(),window.addEventListener("resize",function(){document.documentElement.clientWidth>1024&&slideout.open(),adjustMadtarasToastPosition()}),window.addEventListener("resize",function(){document.documentElement.clientWidth<=1024&&slideout.close(),adjustMadtarasToastPosition()}),Array.prototype.forEach.call(document.querySelectorAll(".section_header_drawer-toggle-btn"),function(button){button.addEventListener("click",function(){slideout.toggle()})}),window.appRouter=appRouter}(),function(namespace){function objectToRequestParam(obj){return"?"+Object.keys(obj).reduce(function(a,k){return a.push(k+"="+encodeURIComponent(obj[k])),a},[]).join("&")}var BASE_URL="https://api.vk.com/method/";namespace.send=function(requestOptions){return new Promise(function(resolve,reject){requestOptions.requestParams.v="5.40";var requestUrl=BASE_URL+requestOptions.method+objectToRequestParam(requestOptions.requestParams);window.fetch(requestUrl).then(function(response){return response.json()}).then(function(parsedResponse){parsedResponse.response?resolve(parsedResponse.response):reject(parsedResponse.error)})["catch"](function(err){reject(err)})})}}(this.vkRequest=this.vkRequest||{}),function(global,factory){"object"==typeof exports&&exports&&"string"!=typeof exports.nodeName?factory(exports):"function"==typeof define&&define.amd?define(["exports"],factory):(global.Mustache={},factory(Mustache))}(this,function(mustache){function isFunction(object){return"function"==typeof object}function typeStr(obj){return isArray(obj)?"array":typeof obj}function escapeRegExp(string){return string.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function hasProperty(obj,propName){return null!=obj&&"object"==typeof obj&&propName in obj}function testRegExp(re,string){return regExpTest.call(re,string)}function isWhitespace(string){return!testRegExp(nonSpaceRe,string)}function escapeHtml(string){return String(string).replace(/[&<>"'\/]/g,function(s){return entityMap[s]})}function parseTemplate(template,tags){function stripSpace(){if(hasTag&&!nonSpace)for(;spaces.length;)delete tokens[spaces.pop()];else spaces=[];hasTag=!1,nonSpace=!1}function compileTags(tagsToCompile){if("string"==typeof tagsToCompile&&(tagsToCompile=tagsToCompile.split(spaceRe,2)),!isArray(tagsToCompile)||2!==tagsToCompile.length)throw new Error("Invalid tags: "+tagsToCompile);openingTagRe=new RegExp(escapeRegExp(tagsToCompile[0])+"\\s*"),closingTagRe=new RegExp("\\s*"+escapeRegExp(tagsToCompile[1])),closingCurlyRe=new RegExp("\\s*"+escapeRegExp("}"+tagsToCompile[1]))}if(!template)return[];var openingTagRe,closingTagRe,closingCurlyRe,sections=[],tokens=[],spaces=[],hasTag=!1,nonSpace=!1;compileTags(tags||mustache.tags);for(var start,type,value,chr,token,openSection,scanner=new Scanner(template);!scanner.eos();){if(start=scanner.pos,value=scanner.scanUntil(openingTagRe))for(var i=0,valueLength=value.length;valueLength>i;++i)chr=value.charAt(i),isWhitespace(chr)?spaces.push(tokens.length):nonSpace=!0,tokens.push(["text",chr,start,start+1]),start+=1,"\n"===chr&&stripSpace();if(!scanner.scan(openingTagRe))break;if(hasTag=!0,type=scanner.scan(tagRe)||"name",scanner.scan(whiteRe),"="===type?(value=scanner.scanUntil(equalsRe),scanner.scan(equalsRe),scanner.scanUntil(closingTagRe)):"{"===type?(value=scanner.scanUntil(closingCurlyRe),scanner.scan(curlyRe),scanner.scanUntil(closingTagRe),type="&"):value=scanner.scanUntil(closingTagRe),!scanner.scan(closingTagRe))throw new Error("Unclosed tag at "+scanner.pos);if(token=[type,value,start,scanner.pos],tokens.push(token),"#"===type||"^"===type)sections.push(token);else if("/"===type){if(openSection=sections.pop(),!openSection)throw new Error('Unopened section "'+value+'" at '+start);if(openSection[1]!==value)throw new Error('Unclosed section "'+openSection[1]+'" at '+start)}else"name"===type||"{"===type||"&"===type?nonSpace=!0:"="===type&&compileTags(value)}if(openSection=sections.pop())throw new Error('Unclosed section "'+openSection[1]+'" at '+scanner.pos);return nestTokens(squashTokens(tokens))}function squashTokens(tokens){for(var token,lastToken,squashedTokens=[],i=0,numTokens=tokens.length;numTokens>i;++i)token=tokens[i],token&&("text"===token[0]&&lastToken&&"text"===lastToken[0]?(lastToken[1]+=token[1],lastToken[3]=token[3]):(squashedTokens.push(token),lastToken=token));return squashedTokens}function nestTokens(tokens){for(var token,section,nestedTokens=[],collector=nestedTokens,sections=[],i=0,numTokens=tokens.length;numTokens>i;++i)switch(token=tokens[i],token[0]){case"#":case"^":collector.push(token),sections.push(token),collector=token[4]=[];break;case"/":section=sections.pop(),section[5]=token[2],collector=sections.length>0?sections[sections.length-1][4]:nestedTokens;break;default:collector.push(token)}return nestedTokens}function Scanner(string){this.string=string,this.tail=string,this.pos=0}function Context(view,parentContext){this.view=view,this.cache={".":this.view},this.parent=parentContext}function Writer(){this.cache={}}var objectToString=Object.prototype.toString,isArray=Array.isArray||function(object){return"[object Array]"===objectToString.call(object)},regExpTest=RegExp.prototype.test,nonSpaceRe=/\S/,entityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},whiteRe=/\s*/,spaceRe=/\s+/,equalsRe=/\s*=/,curlyRe=/\s*\}/,tagRe=/#|\^|\/|>|\{|&|=|!/;Scanner.prototype.eos=function(){return""===this.tail},Scanner.prototype.scan=function(re){var match=this.tail.match(re);if(!match||0!==match.index)return"";var string=match[0];return this.tail=this.tail.substring(string.length),this.pos+=string.length,string},Scanner.prototype.scanUntil=function(re){var match,index=this.tail.search(re);switch(index){case-1:match=this.tail,this.tail="";break;case 0:match="";break;default:match=this.tail.substring(0,index),this.tail=this.tail.substring(index)}return this.pos+=match.length,match},Context.prototype.push=function(view){return new Context(view,this)},Context.prototype.lookup=function(name){var value,cache=this.cache;if(cache.hasOwnProperty(name))value=cache[name];else{for(var names,index,context=this,lookupHit=!1;context;){if(name.indexOf(".")>0)for(value=context.view,names=name.split("."),index=0;null!=value&&index<names.length;)index===names.length-1&&(lookupHit=hasProperty(value,names[index])),value=value[names[index++]];else value=context.view[name],lookupHit=hasProperty(context.view,name);if(lookupHit)break;context=context.parent}cache[name]=value}return isFunction(value)&&(value=value.call(this.view)),value},Writer.prototype.clearCache=function(){this.cache={}},Writer.prototype.parse=function(template,tags){var cache=this.cache,tokens=cache[template];return null==tokens&&(tokens=cache[template]=parseTemplate(template,tags)),tokens},Writer.prototype.render=function(template,view,partials){var tokens=this.parse(template),context=view instanceof Context?view:new Context(view);return this.renderTokens(tokens,context,partials,template)},Writer.prototype.renderTokens=function(tokens,context,partials,originalTemplate){for(var token,symbol,value,buffer="",i=0,numTokens=tokens.length;numTokens>i;++i)value=void 0,token=tokens[i],symbol=token[0],"#"===symbol?value=this.renderSection(token,context,partials,originalTemplate):"^"===symbol?value=this.renderInverted(token,context,partials,originalTemplate):">"===symbol?value=this.renderPartial(token,context,partials,originalTemplate):"&"===symbol?value=this.unescapedValue(token,context):"name"===symbol?value=this.escapedValue(token,context):"text"===symbol&&(value=this.rawValue(token)),void 0!==value&&(buffer+=value);return buffer},Writer.prototype.renderSection=function(token,context,partials,originalTemplate){function subRender(template){return self.render(template,context,partials)}var self=this,buffer="",value=context.lookup(token[1]);if(value){if(isArray(value))for(var j=0,valueLength=value.length;valueLength>j;++j)buffer+=this.renderTokens(token[4],context.push(value[j]),partials,originalTemplate);else if("object"==typeof value||"string"==typeof value||"number"==typeof value)buffer+=this.renderTokens(token[4],context.push(value),partials,originalTemplate);else if(isFunction(value)){if("string"!=typeof originalTemplate)throw new Error("Cannot use higher-order sections without the original template");value=value.call(context.view,originalTemplate.slice(token[3],token[5]),subRender),null!=value&&(buffer+=value)}else buffer+=this.renderTokens(token[4],context,partials,originalTemplate);return buffer}},Writer.prototype.renderInverted=function(token,context,partials,originalTemplate){var value=context.lookup(token[1]);return!value||isArray(value)&&0===value.length?this.renderTokens(token[4],context,partials,originalTemplate):void 0},Writer.prototype.renderPartial=function(token,context,partials){if(partials){var value=isFunction(partials)?partials(token[1]):partials[token[1]];return null!=value?this.renderTokens(this.parse(value),context,partials,value):void 0}},Writer.prototype.unescapedValue=function(token,context){var value=context.lookup(token[1]);return null!=value?value:void 0},Writer.prototype.escapedValue=function(token,context){var value=context.lookup(token[1]);return null!=value?mustache.escape(value):void 0},Writer.prototype.rawValue=function(token){return token[1]},mustache.name="mustache.js",mustache.version="2.2.0",mustache.tags=["{{","}}"];var defaultWriter=new Writer;mustache.clearCache=function(){return defaultWriter.clearCache()},mustache.parse=function(template,tags){return defaultWriter.parse(template,tags)},mustache.render=function(template,view,partials){if("string"!=typeof template)throw new TypeError('Invalid template! Template should be a "string" but "'+typeStr(template)+'" was given as the first argument for mustache#render(template, view, partials)');return defaultWriter.render(template,view,partials)},mustache.to_html=function(template,view,partials,send){var result=mustache.render(template,view,partials);return isFunction(send)?void send(result):result},mustache.escape=escapeHtml,mustache.Scanner=Scanner,mustache.Context=Context,mustache.Writer=Writer}),function(namespace){function isAudioAttachedToPost(postsInfoItem){var audioAttachedToPost=!1;return postsInfoItem.attachments?(postsInfoItem.attachments.forEach(function(attachment){"audio"===attachment.type&&(audioAttachedToPost=!0)}),audioAttachedToPost):audioAttachedToPost}var profileTemplate=document.getElementById("profileTemplate").innerHTML,broadcastingProfileTemplate=document.getElementById("broadcastingProfileTemplate").innerHTML,songlistItemTemplate=document.getElementById("songlistItemTemplate").innerHTML,postslistItemTemplate=document.getElementById("postslistItemTemplate").innerHTML;namespace.insertUserInfoIntoDrawerHeader=function(userInfo){if(document.getElementById("drawer-panel_header_user-name").innerHTML=userInfo.first_name+" "+userInfo.last_name,isServer){var xhr=new window.XMLHttpRequest;xhr.open("GET",userInfo.photo_50,!0),xhr.responseType="blob",xhr.onload=function(){document.getElementById("drawer-panel_header_user-avatar").src=window.URL.createObjectURL(this.response)},xhr.send()}else document.getElementById("drawer-panel_header_user-avatar").src=userInfo.photo_50},namespace.insertItemsIntoSonglist=function(args){if(args.songInfo){var songlistInnerHTML=args.songInfo.reduce(function(songlistInnerHTML,current){return songlistInnerHTML+Mustache.render(songlistItemTemplate,current)},"");args.position||(args.position="beforeend");var songlistToInsertInto=document.getElementById(args.songlistId);songlistToInsertInto.insertAdjacentHTML(args.position,songlistInnerHTML)}},namespace.insertItemsIntoPostslist=function(args){var parser=new window.DOMParser,postslistInnerHTML=args.postsInfo.reduce(function(postslistInnerHTML,current){if(!isAudioAttachedToPost(current))return postslistInnerHTML;var post=parser.parseFromString(Mustache.render(postslistItemTemplate,current),"text/html");return post.querySelector(".postlists_item_songlist").innerHTML=current.attachments.reduce(function(songlistInnerHTML,current){return"audio"!==current.type?songlistInnerHTML:songlistInnerHTML+Mustache.render(songlistItemTemplate,current.audio)},""),postslistInnerHTML+post.body.innerHTML},"");args.position||(args.position="beforeend"),document.getElementById(args.postslistId).insertAdjacentHTML(args.position,postslistInnerHTML)},namespace.insertItemsIntoProfileslist=function(args){var profileslistInnerHTML=args.profilesInfo.reduce(function(profileslistInnerHTML,current){return profileslistInnerHTML+Mustache.render(profileTemplate,current)},"");args.position||(args.position="beforeend"),document.getElementById(args.profileslistId).insertAdjacentHTML(args.position,profileslistInnerHTML)},namespace.insertItemsIntoBroadcastingProfileslist=function(args){var broadcastingProfileslistInnerHTML=args.profilesInfo.reduce(function(broadcastingProfileslistInnerHTML,current){return broadcastingProfileslistInnerHTML+Mustache.render(broadcastingProfileTemplate,current)},"");args.position||(args.position="beforeend"),document.getElementById(args.profileslistId).insertAdjacentHTML(args.position,broadcastingProfileslistInnerHTML)},namespace.removeElem=function(args){var elemsToDelete=document.querySelectorAll(args.selector);Array.prototype.forEach.call(elemsToDelete,function(elem){elem.remove()})},namespace.dispatchEventOnElem=function(args){var elemToDispatchEventOn=document.querySelector(args.selector);if(!elemToDispatchEventOn)throw new Error("Can't find element by selector: "+args.selector);elemToDispatchEventOn.dispatchEvent(new window.Event(args.event,args.flags))},namespace.setElemValue=function(args){var elemToSetValueTo=document.querySelector(args.selector);if(!elemToSetValueTo)throw new Error("Can't find element by selector: "+args.selector);elemToSetValueTo.value=args.value},namespace.setElemInnerHTML=function(args){var elemToSetInnerHTMLTo=document.querySelector(args.selector);if(!elemToSetInnerHTMLTo)throw new Error("Can't find element by selector: "+args.selector);elemToSetInnerHTMLTo.innerHTML=args.html},namespace.addClassToElem=function(args){var elemsToAddClassTo=document.querySelectorAll(args.selector);if(!elemsToAddClassTo.length)throw new Error("Can't find elements by selector: "+args.selector);Array.prototype.forEach.call(elemsToAddClassTo,function(elemToAddClassTo){elemToAddClassTo.classList.contains(args.className)||(elemToAddClassTo.className+=" "+args.className)})},namespace.removeClassFromElem=function(args){var elemsToRemoveClassFrom=document.querySelectorAll(args.selector);if(!elemsToRemoveClassFrom.length)throw new Error("Can't find elements by selector: "+args.selector);Array.prototype.forEach.call(elemsToRemoveClassFrom,function(elemToRemoveClassFrom){elemToRemoveClassFrom.classList.contains(args.className)&&elemToRemoveClassFrom.classList.remove(args.className)})},namespace.addAttributeToElem=function(args){var elemToAddAttributeTo=document.querySelector(args.selector);if(!elemToAddAttributeTo)throw new Error("Can't find element by selector: "+args.selector);elemToAddAttributeTo.setAttribute(args.attrName,args.attrValue)},namespace.removeAttributeFromElem=function(args){var elemToRemoveAttributeFrom=document.querySelector(args.selector);if(!elemToRemoveAttributeFrom)throw new Error("Can't find element by selector: "+args.selector);elemToRemoveAttributeFrom.removeAttribute(args.attrName)},namespace.cleanElemContent=function(args){var elemToCleanContent=document.querySelector(args.selector);if(!elemToCleanContent)throw new Error("Can't find element by selector: "+args.selector);elemToCleanContent.innerHTML=""},namespace.prependElemWithHTML=function(args){var elemToPrepend=document.querySelector(args.parentElemSelector);if(!elemToPrepend)throw new Error("Can't find element by selector: "+args.parentElemSelector);elemToPrepend.insertAdjacentHTML("afterbegin",args.html)},namespace.showToast=madtarasToast.show;var spinner=document.getElementById("spinner");namespace.showSpinner=function(){spinner.hidden=!1},namespace.hideSpinner=function(){spinner.hidden=!0},namespace.setGlobalVariable=function(args){window[args.propertyName]=args.propertyValue},namespace.updateProfilesSectionSearch=function(){profilesSectionSearch.friends.update(),profilesSectionSearch.groups.update(),profilesSectionSearch.broadcasting.update()},namespace.setProfileSectionTitle=function(args){args.title||appRouter.navigateTo("#profiles-section"),document.getElementById("profile-section_title").innerHTML=args.title,document.getElementById("drawer-panel_nav_link_profile").innerHTML=args.title},namespace.getProfileSectionTitle=function(){return document.getElementById("profile-section_title").innerHTML},namespace.setProfileSectionCurrentUserId=function(args){document.getElementById("profiles-section").dataset.currentUserId=args.currentUserId},namespace.getProfileSectionCurrentUserId=function(){return document.getElementById("profiles-section").dataset.currentUserId},namespace.cleanPlayer=function(){this.changeSliderValue({selector:"#player-controller_song-range",value:0}),this.cleanElemContent({selector:"#player-controller_song-info"}),this.cleanElemContent({selector:"#player-controller_current-time"}),this.cleanElemContent({selector:"#player-controller_song-duration"}),this.setPlayPauseBtnIcon({icon:"play_arrow"})},namespace.setPlayPauseBtnIcon=function(args){document.querySelector("#player-controller_play-pause-btn_icon").innerHTML=args.icon},namespace.navigateTo=function(args){appRouter.navigateTo(args.sectionId)},namespace.changeSliderValue=function(args){var slider=document.querySelector(args.selector);slider.value=+args.value},namespace.injectStyles=function(args){var style=document.createElement("style");style.appendChild(document.createTextNode("")),document.head.appendChild(style),args.rules.forEach(function(rule){style.sheet.insertRule(rule,0)})}}(this.domManipulations=this.domManipulations||{});var isServer=!0;!function(){function chooseAppPortAndListen(port){chrome.socket.connect(socketPortTesterId,"localhost",port,function(result){0===result?(chrome.socket.disconnect(socketPortTesterId),chooseAppPortAndListen(port+1)):(chrome.socket.destroy(socketPortTesterId),server.listen(port),chrome.system.network.getNetworkInterfaces(function(networkInterfaces){networkInterfaces.forEach(function(networkInterface){if(addressRegEx.test(networkInterface.address)){var address=networkInterface.address+":"+port;document.getElementById("settings-section_connection-info_address").innerText=address,domManipulations.showToast({innerText:(chrome.i18n.getMessage("enterAddressMsgPart1")||"Введіть")+' <span class="addressInToast">'+address+"</span> "+(chrome.i18n.getMessage("enterAddressMsgPart2")||"в адресний рядок браузера на вашому мобільному пристрої для використання його, як пульта для плеєра."),duration:9999999})}})}))})}function objToRequestParam(obj){return"?"+Object.keys(obj).reduce(function(a,k){return a.push(k+"="+encodeURIComponent(obj[k])),a},[]).join("&")}function requestParamToObj(query){query=query.substring(query.indexOf("?")+1).split("&");for(var pair,params={},d=decodeURIComponent,i=query.length-1;i>=0;i--)pair=query[i].split("="),
params[d(pair[0])]=d(pair[1]);return params}function handleSocketsMessage(e){var requestParams=requestParamToObj(e.data);0===e.data.indexOf("domManipulations?")?(requestParams.args&&"undefined"!==requestParams.args&&"null"!==requestParams.args&&(requestParams.args=JSON.parse(requestParams.args)),domManipulations[requestParams["function"]](requestParams.args)):0===e.data.indexOf("sendRequestAndRemoveAudio?")?(requestParams.args&&"undefined"!==requestParams.args&&"null"!==requestParams.args&&(requestParams.args=JSON.parse(requestParams.args)),sendRequestAndRemoveAudio({songlistItemSelector:requestParams.args.songlistItemSelector})):0===e.data.indexOf("sendRequestAndAddAudio?")&&(requestParams.args&&"undefined"!==requestParams.args&&"null"!==requestParams.args&&(requestParams.args=JSON.parse(requestParams.args)),sendRequestAndAddAudio({songlistItemSelector:requestParams.args.songlistItemSelector}))}function sendDomManipulationsMessage(options){options.socket.send("domManipulations"+objToRequestParam({"function":options["function"],args:JSON.stringify(options.args)}))}function handleClickOnSonglist(event){event.target.classList.contains("songlist_item_menu-btn")?(event.stopPropagation(),openContextMenuOnSonglistItem(event.target,event)):event.target.classList.contains("songlist_item_menu-btn_icon")?(event.stopPropagation(),openContextMenuOnSonglistItem(event.target.parentNode,event)):event.currentTarget.classList.contains("current")?document.querySelector("#player-controller_play-pause-btn").dispatchEvent(new window.Event("click")):player.playSong(event.currentTarget)}function openContextMenuOnSonglistItem(menuBtn,event){function hideContextMenuAndRemoveEventListener(e){menuBtn.parentNode.parentNode&&menuBtn.parentNode.parentNode.removeEventListener("scroll",hideContextMenuAndRemoveEventListener),document.body.removeEventListener("click",hideContextMenuAndRemoveEventListener),hideContextMenu()}hideContextMenu(),event.stopPropagation();var songlistItemElem=menuBtn.parentNode,contextMenuContent="";contextMenuContent+=0===songlistItemElem.dataset.songClass.indexOf(vkUserID)?'<li class="mdl-menu__item remove-from-audios">'+(chrome.i18n.getMessage("deleteSong")||"Видалити з моїх аудіозаписів")+"</li>":'<li class="mdl-menu__item add-to-audios">'+(chrome.i18n.getMessage("addSong")||"Додати до моїх аудіозаписів")+"</li>";var menuBtnId=guid();menuBtn.id=menuBtnId,document.body.insertAdjacentHTML("beforeend",'<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect"for="'+menuBtnId+'">'+contextMenuContent+"</ul>"),componentHandler.upgradeElement(document.querySelector(".mdl-menu")),menuBtn.dispatchEvent(new window.Event("click"));var menuContainer=document.querySelector(".mdl-menu__container");menuContainer.style.top=menuBtn.getBoundingClientRect().top+"px",menuBtn.id="",document.body.addEventListener("click",hideContextMenuAndRemoveEventListener),menuBtn.parentNode.parentNode.parentNode.addEventListener("scroll",hideContextMenuAndRemoveEventListener),menuContainer.querySelector(".remove-from-audios")?menuContainer.querySelector(".remove-from-audios").addEventListener("click",function(){sendRequestAndRemoveAudio({songlistItemSelector:'div[data-song-class="'+songlistItemElem.dataset.songClass+'"]'})}):menuContainer.querySelector(".add-to-audios")&&menuContainer.querySelector(".add-to-audios").addEventListener("click",function(){sendRequestAndAddAudio({songlistItemSelector:'div[data-song-class="'+songlistItemElem.dataset.songClass+'"]'})})}function hideContextMenu(){var contextMenu=document.querySelector(".mdl-menu__container");null!==contextMenu&&contextMenu.remove()}function sendRequestAndRemoveAudio(args){domManipulations.showSpinner(),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"showSpinner"})});var songlistItemElem=document.querySelector(args.songlistItemSelector);return songlistItemElem?void vkRequest.send({method:"audio.delete",requestParams:{access_token:vkAccessToken,user_id:vkUserID,audio_id:songlistItemElem.dataset.songClass.split("_")[1],owner_id:songlistItemElem.dataset.songClass.split("_")[0]}}).then(function(response){if(1!==response)throw new Error("Сталася помилка");domManipulations.removeElem({selector:'div[data-song-class="'+songlistItemElem.dataset.songClass+'"]'}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"removeElem",args:{selector:'div[data-song-class="'+songlistItemElem.dataset.songClass+'"]'}})}),domManipulations.hideSpinner(),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"hideSpinner"})}),domManipulations.showToast({innerText:chrome.i18n.getMessage("deleted")||"Видалено"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"showToast",args:{innerText:chrome.i18n.getMessage("deleted")||"Видалено"}})})})["catch"](function(err){domManipulations.hideSpinner(),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"hideSpinner"})}),domManipulations.showToast({innerText:chrome.i18n.getMessage("errorOccurred")||"Сталася помилка"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"showToast",args:{innerText:chrome.i18n.getMessage("errorOccurred")||"Сталася помилка"}})}),console.error(err)}):void console.error("No elements by selector")}function sendRequestAndAddAudio(args){domManipulations.showSpinner(),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"showSpinner"})});var songlistItemElem=document.querySelector(args.songlistItemSelector);return songlistItemElem?void vkRequest.send({method:"audio.add",requestParams:{access_token:vkAccessToken,user_id:vkUserID,audio_id:songlistItemElem.dataset.songClass.split("_")[1],owner_id:songlistItemElem.dataset.songClass.split("_")[0]}}).then(function(response){if("number"!=typeof response)throw new Error("Сталася помилка");var newSonglistItemElem=songlistItemElem.cloneNode(!0);newSonglistItemElem.dataset.songClass=vkUserID+"_"+response,domManipulations.prependElemWithHTML({html:newSonglistItemElem.outerHTML,parentElemSelector:"#my-audios-section_songlist"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"prependElemWithHTML",args:{html:newSonglistItemElem.outerHTML,parentElemSelector:"#my-audios-section_songlist"}})}),domManipulations.hideSpinner(),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"hideSpinner"})}),domManipulations.showToast({innerText:chrome.i18n.getMessage("added")||"Додано"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"showToast",args:{innerText:chrome.i18n.getMessage("added")||"Додано"}})})})["catch"](function(err){domManipulations.hideSpinner(),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"hideSpinner"})}),domManipulations.showToast({innerText:chrome.i18n.getMessage("errorOccurred")||"Сталася помилка"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"showToast",args:{innerText:chrome.i18n.getMessage("errorOccurred")||"Сталася помилка"}})}),console.error(err)}):void console.error("No elements by selector")}function handleClickOnProfileslistItem(profileslistItem){var profileId=profileslistItem.dataset.profileId,profileName=profileslistItem.querySelector(".profiles_item_title").innerText;domManipulations.showSpinner(),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"showSpinner"})}),vkRequest.send({method:"execute.vkExecGetProfileAudioAndWallData",requestParams:{access_token:vkAccessToken,user_id:vkUserID,owner_id:profileId}}).then(function(response){domManipulations.cleanElemContent({selector:"#profile-section_songlist"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"cleanElemContent",args:{selector:"#profile-section_songlist"}})}),domManipulations.insertItemsIntoSonglist({songlistId:"profile-section_songlist",songInfo:response.userAudios.items}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"insertItemsIntoSonglist",args:{songlistId:"profile-section_songlist",songInfo:response.userAudios.items}})}),response.userAudiosCount<21?(domManipulations.addAttributeToElem({selector:"#profile-section_load-more-songs-btn",attrName:"hidden",attrValue:"true"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"addAttributeToElem",args:{selector:"#profile-section_load-more-songs-btn",attrName:"hidden",attrValue:"true"}})})):(domManipulations.removeAttributeFromElem({selector:"#profile-section_load-more-songs-btn",attrName:"hidden"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"removeAttributeFromElem",args:{selector:"#profile-section_load-more-songs-btn",attrName:"hidden"}})}),profileSectionSonglist.dataset.userAudiosCount=response.userAudiosCount,profileSectionSonglist.dataset.userAudiosLoaded=20),profileSectionPostslist.dataset.postsLoaded=20,domManipulations.cleanElemContent({selector:"#profile-section_postslist"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"cleanElemContent",args:{selector:"#profile-section_postslist"}})}),domManipulations.insertItemsIntoPostslist({postslistId:"profile-section_postslist",postsInfo:response.wallPosts.items}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"insertItemsIntoPostslist",args:{postslistId:"profile-section_postslist",postsInfo:response.wallPosts.items}})}),0===document.getElementById("profile-section_postslist").children.length?(domManipulations.addAttributeToElem({selector:"#profile-section_load-more-posts-btn",attrName:"hidden",attrValue:"true"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"addAttributeToElem",args:{selector:"#profile-section_load-more-posts-btn",attrName:"hidden",attrValue:"true"}})})):(domManipulations.removeAttributeFromElem({selector:"#profile-section_load-more-posts-btn",attrName:"hidden"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"removeAttributeFromElem",args:{selector:"#profile-section_load-more-posts-btn",attrName:"hidden"}})})),domManipulations.setProfileSectionTitle({title:profileName}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"setProfileSectionTitle",args:{title:profileName}})}),domManipulations.setProfileSectionCurrentUserId({currentUserId:profileId}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"setProfileSectionCurrentUserId",args:{currentUserId:profileId}})}),domManipulations.navigateTo({sectionId:"#profile-section"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"navigateTo",args:{sectionId:"#profile-section"}})}),domManipulations.hideSpinner(),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"hideSpinner"})})})["catch"](function(err){domManipulations.hideSpinner(),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"hideSpinner"})}),domManipulations.showToast({innerText:chrome.i18n.getMessage("errorOccurred")||"Сталася помилка"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"showToast",args:{innerText:chrome.i18n.getMessage("errorOccurred")||"Сталася помилка"}})}),console.error(err)})}function handleAddedSonglistItemAndSyncWithCurrentPlaylistSonglist(){domManipulations.cleanElemContent({selector:"#current-playlist-section_songlist"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"cleanElemContent",args:{selector:"#current-playlist-section_songlist"}})}),domManipulations.prependElemWithHTML({html:document.querySelector('.songlist[data-syncing-with-current-playlist-section-songlist="true"]').innerHTML,parentElemSelector:"#current-playlist-section_songlist"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"prependElemWithHTML",args:{html:document.querySelector('.songlist[data-syncing-with-current-playlist-section-songlist="true"]').innerHTML,parentElemSelector:"#current-playlist-section_songlist"}})})}function handleRemovedSonglistItemAndSyncWithCurrentPlaylistSonglist(){domManipulations.cleanElemContent({selector:"#current-playlist-section_songlist"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"cleanElemContent",args:{selector:"#current-playlist-section_songlist"}})}),domManipulations.prependElemWithHTML({html:document.querySelector('.songlist[data-syncing-with-current-playlist-section-songlist="true"]').innerHTML,parentElemSelector:"#current-playlist-section_songlist"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"prependElemWithHTML",args:{html:document.querySelector('.songlist[data-syncing-with-current-playlist-section-songlist="true"]').innerHTML,parentElemSelector:"#current-playlist-section_songlist"}})})}if(function(){for(var objects=document.getElementsByTagName("*"),i=0,l=objects.length;l>i;i++)objects[i].dataset&&objects[i].dataset.i18nContent&&(objects[i].innerHTML=chrome.i18n.getMessage(objects[i].dataset.i18nContent)||objects[i].innerHTML)}(),!navigator.onLine)throw domManipulations.showToast({innerText:chrome.i18n.getMessage("connectToTheInternetAndRestartApp")||"Під'єднайтесь до інтернету і перезапустіть програму",duration:9999999}),new Error("No internet connection");var addressRegEx=/^(?:[0-9]{1,3}\.){3}[0-9]{1,3}$/;if(http.Server&&http.WebSocketServer){var socketPortTesterId,server=new http.Server,wsServer=new http.WebSocketServer(server),port=52121;chrome.socket.create("tcp",null,function(createInfo){socketPortTesterId=createInfo.socketId,chooseAppPortAndListen(port)}),server.addEventListener("request",function(req){var url=req.headers.url;if("/"===url)url="/public/mobileApp.html";else if("/localization"===url){var currentLocale=chrome.i18n.getUILanguage();url=currentLocale.indexOf("uk")>-1?"/public/_locales/uk/messages.json":currentLocale.indexOf("ru")>-1?"/public/_locales/ru/messages.json":"/public/_locales/en/messages.json"}else url="/public"+url;return req.serveUrl(url),!0});var connectedSockets=[];window.connectedSockets=connectedSockets,wsServer.addEventListener("request",function(req){var socket=req.accept();connectedSockets.push(socket),sendDomManipulationsMessage({socket:socket,"function":"showSpinner"}),socket.addEventListener("message",function(e){handleSocketsMessage(e)}),vkRequest.send({method:"execute.getDataForAppInit",requestParams:{access_token:vkAccessToken,user_id:vkUserID}}).then(function(response){sendDomManipulationsMessage({socket:socket,"function":"insertUserInfoIntoDrawerHeader",args:response.userInfo}),sendDomManipulationsMessage({socket:socket,"function":"setGlobalVariable",args:{propertyName:"vkUserID",propertyValue:vkUserID}}),sendDomManipulationsMessage({socket:socket,"function":"insertItemsIntoSonglist",args:{songInfo:response.userAudios.items,songlistId:"my-audios-section_songlist"}}),sendDomManipulationsMessage({socket:socket,"function":"addClassToElem",args:{selector:"body",className:"user-audios-loaded"}}),response.userAudios.items.length<40&&sendDomManipulationsMessage({socket:socket,"function":"addAttributeToElem",args:{selector:"#my-audios-section_load-more-songs-btn",attrName:"hidden",attrValue:"true"}}),response.friendsWithOpenedAudios.forEach(function(currentValue,index,array){array[index].profileId=array[index].id,array[index].profileType="person",array[index].profileTitle=array[index].first_name+" "+array[index].last_name}),sendDomManipulationsMessage({socket:socket,"function":"insertItemsIntoProfileslist",args:{profileslistId:"profiles-section_friends-profiles",profilesInfo:response.friendsWithOpenedAudios}}),response.userGroups.items.forEach(function(currentValue,index,array){array[index].profileId="-"+array[index].id,array[index].profileType="group",array[index].profileTitle=array[index].name}),sendDomManipulationsMessage({socket:socket,"function":"insertItemsIntoProfileslist",args:{profileslistId:"profiles-section_groups-profiles",profilesInfo:response.userGroups.items}}),player.loop&&sendDomManipulationsMessage({socket:socket,"function":"addClassToElem",args:{selector:"#player-controller_loop-btn",className:"loop-true"}}),player.shuffle&&sendDomManipulationsMessage({socket:socket,"function":"addClassToElem",args:{selector:"#player-controller_shuffle-btn",className:"shuffle-true"}}),player.broadcast&&sendDomManipulationsMessage({socket:socket,"function":"addClassToElem",args:{selector:"#player-controller_broadcast-btn",className:"broadcast-true"}});var playPauseCurrentIcon=document.querySelector("#player-controller_play-pause-btn_icon").innerHTML;sendDomManipulationsMessage({socket:socket,"function":"setPlayPauseBtnIcon",args:{icon:playPauseCurrentIcon}}),sendDomManipulationsMessage({socket:socket,"function":"changeSliderValue",args:{selector:"#player-controller_song-range",value:document.querySelector("#player-controller_song-range").value}}),sendDomManipulationsMessage({socket:socket,"function":"changeSliderValue",args:{selector:"#player-controller_volume-range",value:document.querySelector("#player-controller_volume-range").value}}),sendDomManipulationsMessage({socket:socket,"function":"setElemInnerHTML",args:{selector:"#player-controller_current-time",html:document.querySelector("#player-controller_current-time").innerHTML}}),sendDomManipulationsMessage({socket:socket,"function":"setElemInnerHTML",args:{selector:"#player-controller_song-duration",html:document.querySelector("#player-controller_song-duration").innerHTML}}),sendDomManipulationsMessage({socket:socket,"function":"setElemInnerHTML",args:{selector:"#player-controller_song-info",html:document.querySelector("#player-controller_song-info").innerHTML}}),document.querySelector("#profiles-section_broadcasting-profiles").innerHTML="",response.broadcastingFriends&&(response.broadcastingFriends.forEach(function(currentValue,index,array){"profile"===currentValue.type?(array[index].profileId=array[index].id,array[index].profileType="person",array[index].profileTitle=array[index].first_name+" "+array[index].last_name):(array[index].profileId=array[index].id,array[index].profileType="group",array[index].profileTitle=array[index].name)}),sendDomManipulationsMessage({socket:socket,"function":"insertItemsIntoBroadcastingProfileslist",args:{profileslistId:"profiles-section_broadcasting-profiles",profilesInfo:response.broadcastingFriends}}),domManipulations.insertItemsIntoBroadcastingProfileslist({profileslistId:"profiles-section_broadcasting-profiles",profilesInfo:response.broadcastingFriends})),sendDomManipulationsMessage({socket:socket,"function":"updateProfilesSectionSearch"}),sendDomManipulationsMessage({socket:socket,"function":"injectStyles",args:{rules:['.player-controller_add-songs-to-audios-btn[data-current-song-id^="'+vkUserID+'"] {pointer-events: none;display: none;}']}}),sendDomManipulationsMessage({socket:socket,"function":"addAttributeToElem",args:{selector:"#player-controller_add-songs-to-audios-btn",attrName:"data-current-song-id",attrValue:document.querySelector("#player-controller_add-songs-to-audios-btn").dataset.currentSongId}}),player.currentSong&&(connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"addClassToElem",args:{selector:'div[data-song-class="'+player.currentSong.dataset.songClass+'"]',className:"current"}})}),player.currentSong.classList.contains("is-playing")&&connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"addClassToElem",args:{selector:'div[data-song-class="'+player.currentSong.dataset.songClass+'"]',className:"is-playing"}})})),sendDomManipulationsMessage({socket:socket,"function":"hideSpinner"})});var profileSectionSonglist=document.getElementById("profile-section_songlist"),profileSectionPostslist=document.getElementById("profile-section_postslist");if(profileSectionSonglist.children.length||profileSectionPostslist.children.length){var profileSectionTitle=domManipulations.getProfileSectionTitle();sendDomManipulationsMessage({socket:socket,"function":"setProfileSectionTitle",args:{title:profileSectionTitle}}),sendDomManipulationsMessage({socket:socket,"function":"prependElemWithHTML",args:{html:profileSectionSonglist.innerHTML,parentElemSelector:"#profile-section_songlist"}}),sendDomManipulationsMessage({socket:socket,"function":"prependElemWithHTML",args:{html:profileSectionPostslist.innerHTML,parentElemSelector:"#profile-section_postslist"}})}var currentPlaylistSectionSonglist=document.getElementById("current-playlist-section_songlist");return currentPlaylistSectionSonglist.innerHTML&&sendDomManipulationsMessage({socket:socket,"function":"prependElemWithHTML",args:{html:currentPlaylistSectionSonglist.innerHTML,parentElemSelector:"#current-playlist-section_songlist"}}),socket.addEventListener("close",function(){for(var i=0;i<connectedSockets.length;i++)if(connectedSockets[i]===socket){connectedSockets.splice(i,1);break}}),!0})}window.sendDomManipulationsMessage=sendDomManipulationsMessage;var searchSectionSonglist=document.getElementById("search-section_songlist");searchSectionSonglist.dataset.audiosLoaded=0;var seacrhSectionSearchInput=document.getElementById("search-section_search-input");seacrhSectionSearchInput.addEventListener("change",function(event){return seacrhSectionSearchInput.dataset.currentValue=event.currentTarget.value,event.currentTarget.value?(domManipulations.showSpinner(),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"showSpinner"})}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"setElemValue",args:{selector:"#search-section_search-input",value:event.currentTarget.value}})}),void vkRequest.send({method:"audio.search",requestParams:{access_token:vkAccessToken,user_id:vkUserID,q:event.currentTarget.value,auto_complete:1,sort:2,search_own:0,count:20}}).then(function(searchData){var searchSectionSonglist=document.getElementById("search-section_songlist");searchSectionSonglist.dataset.audiosLoaded=20,parseBoolean(searchSectionSonglist.dataset.syncingWithCurrentPlaylistSection)&&delete searchSectionSonglist.dataset.syncingWithCurrentPlaylistSectionSonglist,domManipulations.cleanElemContent({selector:"#search-section_songlist"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"cleanElemContent",args:{selector:"#search-section_songlist"}})}),domManipulations.insertItemsIntoSonglist({songlistId:"search-section_songlist",songInfo:searchData.items}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"insertItemsIntoSonglist",args:{songlistId:"search-section_songlist",songInfo:searchData.items}})}),0===searchData.count?(domManipulations.addAttributeToElem({selector:"#search-section_load-more-songs-btn",attrName:"hidden",attrValue:"true"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"addAttributeToElem",args:{selector:"#search-section_load-more-songs-btn",attrName:"hidden",attrValue:"true"}})})):(domManipulations.removeAttributeFromElem({selector:"#search-section_load-more-songs-btn",attrName:"hidden"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"removeAttributeFromElem",args:{selector:"#search-section_load-more-songs-btn",attrName:"hidden"}})})),domManipulations.hideSpinner(),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"hideSpinner"})})})["catch"](function(err){domManipulations.hideSpinner(),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"hideSpinner"})}),domManipulations.showToast({innerText:chrome.i18n.getMessage("errorOccurred")||"Сталася помилка"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"showToast",args:{innerText:chrome.i18n.getMessage("errorOccurred")||"Сталася помилка"}})}),console.error(err)})):void connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"setElemValue",args:{selector:"#search-section_search-input",value:""}})})});var searchSectionLoadMoreBtn=document.getElementById("search-section_load-more-songs-btn");searchSectionLoadMoreBtn.addEventListener("click",function(){domManipulations.showSpinner(),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"showSpinner"})}),vkRequest.send({method:"audio.search",requestParams:{access_token:vkAccessToken,user_id:vkUserID,q:seacrhSectionSearchInput.dataset.currentValue,auto_complete:1,sort:2,search_own:0,count:10,offset:searchSectionSonglist.dataset.audiosLoaded}}).then(function(searchData){searchSectionSonglist.dataset.audiosLoaded=+searchSectionSonglist.dataset.audiosLoaded+10,0===searchData.count&&(domManipulations.addAttributeToElem({selector:"#search-section_load-more-songs-btn",attrName:"hidden",attrValue:"true"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"addAttributeToElem",args:{selector:"#search-section_load-more-songs-btn",attrName:"hidden",attrValue:"true"}})})),domManipulations.insertItemsIntoSonglist({songlistId:"search-section_songlist",songInfo:searchData.items}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"insertItemsIntoSonglist",args:{songlistId:"search-section_songlist",songInfo:searchData.items}})}),domManipulations.hideSpinner(),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"hideSpinner"})})})["catch"](function(err){domManipulations.hideSpinner(),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"hideSpinner"})}),domManipulations.showToast({innerText:chrome.i18n.getMessage("errorOccurred")||"Сталася помилка"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"showToast",args:{innerText:chrome.i18n.getMessage("errorOccurred")||"Сталася помилка"}})}),console.error(err)})}),document.body.arrive(".songlist_item",function(){this.addEventListener("click",handleClickOnSonglist)}),document.body.arrive(".broadcasting-profiles_item",function(){this.addEventListener("click",function(){this.querySelector(".songlist_item").dispatchEvent(new window.Event("click"))})});var profilesSectionSearch={friends:new Jets({searchTag:"#profiles-section_search-input",contentTag:"#profiles-section_friends-profiles"}),groups:new Jets({searchTag:"#profiles-section_search-input",contentTag:"#profiles-section_groups-profiles"}),broadcasting:new Jets({searchTag:"#profiles-section_search-input",contentTag:"#profiles-section_broadcasting-profiles"})};window.profilesSectionSearch=profilesSectionSearch,document.getElementById("profiles-section").children[1].addEventListener("click",function(){var profilesSectionSearchInput=document.getElementById("profiles-section_search-input");profilesSectionSearchInput.value="",profilesSectionSearchInput.dispatchEvent(new window.Event("change"))}),window.addEventListener("online",function(){domManipulations.showToast({innerText:chrome.i18n.getMessage("internetConnectionEstablished")||"З'єднання з інтернетом встановлено"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"showToast",args:{innerText:chrome.i18n.getMessage("internetConnectionEstablished")||"З'єднання з інтернетом встановлено"}})})},!1),window.addEventListener("offline",function(){domManipulations.showToast({innerText:chrome.i18n.getMessage("internetConnectionLost")||"З'єднання з інтернетом втрачено",duration:1e5}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"showToast",args:{innerText:chrome.i18n.getMessage("internetConnectionLost")||"З'єднання з інтернетом втрачено",duration:1e5}})})},!1);var profileSectionSonglist=document.querySelector("#profile-section_songlist"),profileSectionPostslist=document.querySelector("#profile-section_postslist"),profileSectionLoadMoreSongsBtn=document.getElementById("profile-section_load-more-songs-btn"),profileSectionLoadMorePostsBtn=document.getElementById("profile-section_load-more-posts-btn");document.getElementById("profiles-section_friends-profiles").addEventListener("click",function(event){for(var eventTarget=event.target;eventTarget!==event.currentTarget&&eventTarget!==document.body;){if(eventTarget.classList.contains("profiles_item")){handleClickOnProfileslistItem(eventTarget);break}eventTarget=eventTarget.parentNode}}),document.getElementById("profiles-section_groups-profiles").addEventListener("click",function(event){for(var eventTarget=event.target;eventTarget!==event.currentTarget&&eventTarget!==document.body;){if(eventTarget.classList.contains("profiles_item")){handleClickOnProfileslistItem(eventTarget);break}eventTarget=eventTarget.parentNode}}),profileSectionLoadMoreSongsBtn.addEventListener("click",function(){domManipulations.showSpinner(),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"showSpinner"})}),vkRequest.send({method:"audio.get",requestParams:{access_token:vkAccessToken,user_id:vkUserID,owner_id:domManipulations.getProfileSectionCurrentUserId(),offset:profileSectionSonglist.dataset.userAudiosLoaded,count:20}}).then(function(response){domManipulations.insertItemsIntoSonglist({songlistId:"profile-section_songlist",songInfo:response.items}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"insertItemsIntoSonglist",args:{songlistId:"profile-section_songlist",songInfo:response.items}})}),profileSectionSonglist.dataset.userAudiosLoaded=+profileSectionSonglist.dataset.userAudiosLoaded+20,+profileSectionSonglist.dataset.userAudiosLoaded<+profileSectionSonglist.dataset.userAudiosCount&&+profileSectionSonglist.dataset.userAudiosLoaded<6e3||(domManipulations.addAttributeToElem({selector:"#profile-section_load-more-songs-btn",attrName:"hidden",attrValue:"true"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"addAttributeToElem",args:{selector:"#profile-section_load-more-songs-btn",attrName:"hidden",attrValue:"true"}})})),domManipulations.hideSpinner(),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"hideSpinner"})})})["catch"](function(err){domManipulations.hideSpinner(),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"hideSpinner"})}),domManipulations.showToast({innerText:chrome.i18n.getMessage("errorOccurred")||"Сталася помилка"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"showToast",args:{innerText:chrome.i18n.getMessage("errorOccurred")||"Сталася помилка"}})}),console.error(err)})}),profileSectionLoadMorePostsBtn.addEventListener("click",function(){domManipulations.showSpinner(),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"showSpinner"})});var previousPostsCount=profileSectionPostslist.children.length;vkRequest.send({method:"wall.get",requestParams:{access_token:vkAccessToken,
user_id:vkUserID,owner_id:domManipulations.getProfileSectionCurrentUserId(),offset:+profileSectionPostslist.dataset.postsLoaded,count:20}}).then(function(response){domManipulations.insertItemsIntoPostslist({postsInfo:response.items,postslistId:"profile-section_postslist"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"insertItemsIntoPostslist",args:{postsInfo:response.items,postslistId:"profile-section_postslist"}})}),profileSectionPostslist.dataset.postsLoaded=+profileSectionPostslist.dataset.postsLoaded+20,previousPostsCount===profileSectionPostslist.children.length&&(domManipulations.addAttributeToElem({selector:"#profile-section_load-more-posts-btn",attrName:"hidden",attrValue:"true"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"addAttributeToElem",args:{selector:"#profile-section_load-more-posts-btn",attrName:"hidden",attrValue:"true"}})})),domManipulations.hideSpinner(),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"hideSpinner"})})})["catch"](function(err){domManipulations.hideSpinner(),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"hideSpinner"})}),domManipulations.showToast({innerText:chrome.i18n.getMessage("errorOccurred")||"Сталася помилка"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"showToast",args:{innerText:chrome.i18n.getMessage("errorOccurred")||"Сталася помилка"}})}),domManipulations.showToast({innerText:chrome.i18n.getMessage("errorOccurred")||"Сталася помилка"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"showToast",args:{innerText:chrome.i18n.getMessage("errorOccurred")||"Сталася помилка"}})}),console.error(err)})});var currentPlaylistSectionSonglist=document.getElementById("current-playlist-section_songlist"),player=(new MutationSummary({callback:function(summaries){var changeSummary=summaries[0];changeSummary.added.forEach(function(newEl){newEl.arrive(".songlist_item",handleAddedSonglistItemAndSyncWithCurrentPlaylistSonglist),newEl.leave(".songlist_item",handleRemovedSonglistItemAndSyncWithCurrentPlaylistSonglist),domManipulations.cleanElemContent({selector:"#current-playlist-section_songlist"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"cleanElemContent",args:{selector:"#current-playlist-section_songlist"}})}),domManipulations.prependElemWithHTML({html:document.querySelector('.songlist[data-syncing-with-current-playlist-section-songlist="true"]').innerHTML,parentElemSelector:"#current-playlist-section_songlist"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"prependElemWithHTML",args:{html:document.querySelector('.songlist[data-syncing-with-current-playlist-section-songlist="true"]').innerHTML,parentElemSelector:"#current-playlist-section_songlist"}})})}),changeSummary.removed.forEach(function(removedEl){removedEl.unbindArrive(".songlist_item",handleAddedSonglistItemAndSyncWithCurrentPlaylistSonglist),removedEl.unbindLeave(".songlist_item",handleRemovedSonglistItemAndSyncWithCurrentPlaylistSonglist),domManipulations.cleanElemContent({selector:"#current-playlist-section_songlist"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"cleanElemContent",args:{selector:"#current-playlist-section_songlist"}})})})},queries:[{attribute:"data-syncing-with-current-playlist-section-songlist"}]}),{});player.elem=new window.Audio,player.elem.autoplay=!1,player.elem.preload="auto",player.elem.volume=.4,player.elem.onerror=function(){""!==document.querySelector("#player-controller_song-info").innerText&&(domManipulations.showToast({innerText:chrome.i18n.getMessage("songUnavailable")||"Композиція недоступна"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"showToast",args:{innerText:chrome.i18n.getMessage("songUnavailable")||"Композиція недоступна"}})}))},player.currentSonglist=null,player.playSong=function(songlistItem){songlistItem.parentNode&&((!player.currentSonglist||player.currentSonglist.id!==songlistItem.parentNode.id&&currentPlaylistSectionSonglist.id!==songlistItem.parentNode.id)&&(document.querySelector(".songlist_item.current")&&(domManipulations.removeClassFromElem({selector:".songlist_item.current",className:"current"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"removeClassFromElem",args:{selector:".songlist_item.current",className:"current"}})})),document.querySelector(".songlist_item.is-playing")&&(domManipulations.removeClassFromElem({selector:".songlist_item.is-playing",className:"is-playing"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"removeClassFromElem",args:{selector:".songlist_item.is-playing",className:"is-playing"}})})),player.currentSong=null,player.currentSonglist&&delete player.currentSonglist.dataset.syncingWithCurrentPlaylistSectionSonglist,setTimeout(function(){songlistItem.parentNode.dataset.syncingWithCurrentPlaylistSectionSonglist=!0,player.currentSonglist=songlistItem.parentNode},1)),"current-playlist-section_songlist"!==songlistItem.parentNode.id&&setTimeout(function(){songlistItem=currentPlaylistSectionSonglist.querySelector('.songlist_item[data-song-class="'+songlistItem.dataset.songClass+'"]')},1),player.previousSong=player.currentSong,player.previousSong&&(document.querySelector(".songlist_item.current")&&(domManipulations.removeClassFromElem({selector:".songlist_item.current",className:"current"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"removeClassFromElem",args:{selector:".songlist_item.current",className:"current"}})})),document.querySelector(".songlist_item.is-playing")&&(domManipulations.removeClassFromElem({selector:".songlist_item.is-playing",className:"is-playing"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"removeClassFromElem",args:{selector:".songlist_item.is-playing",className:"is-playing"}})}))),player.currentSong=songlistItem,domManipulations.addClassToElem({selector:'div[data-song-class="'+songlistItem.dataset.songClass+'"]',className:"current"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"addClassToElem",args:{selector:'div[data-song-class="'+songlistItem.dataset.songClass+'"]',className:"current"}})}),domManipulations.addClassToElem({selector:".songlist_item.current",className:"is-playing"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"addClassToElem",args:{selector:".songlist_item.current",className:"is-playing"}})}),player.broadcast&&player.setBroadcast(player.currentSong),domManipulations.setElemInnerHTML({selector:"#player-controller_song-info",html:songlistItem.dataset.songTitle}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"setElemInnerHTML",args:{selector:"#player-controller_song-info",html:songlistItem.dataset.songTitle}})}),domManipulations.addAttributeToElem({selector:"#player-controller_add-songs-to-audios-btn",attrName:"data-current-song-id",attrValue:songlistItem.dataset.songClass}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"addAttributeToElem",args:{selector:"#player-controller_add-songs-to-audios-btn",attrName:"data-current-song-id",attrValue:songlistItem.dataset.songClass}})}),player.elem.currentTime=0,player.elem.src=songlistItem.dataset.songUrl,player.elem.play(),domManipulations.changeSliderValue({selector:"#player-controller_song-range",value:0}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"changeSliderValue",args:{selector:"#player-controller_song-range",value:0}})}),domManipulations.setElemInnerHTML({selector:"#player-controller_current-time",html:"0:00"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"setElemInnerHTML",args:{selector:"#player-controller_current-time",html:"0:00"}})}),domManipulations.setElemInnerHTML({selector:"#player-controller_song-duration",html:secondsTohhmmss(+songlistItem.dataset.songDuration)}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"setElemInnerHTML",args:{selector:"#player-controller_song-duration",html:secondsTohhmmss(+songlistItem.dataset.songDuration)}})}))},player.setBroadcast=function(songlistItem){var audio=songlistItem?songlistItem.dataset.songClass:"";vkRequest.send({method:"audio.setBroadcast",requestParams:{access_token:vkAccessToken,user_id:vkUserID,audio:audio}})},player.elem.addEventListener("timeupdate",function(event){domManipulations.setElemInnerHTML({selector:"#player-controller_current-time",html:secondsTohhmmss(event.target.currentTime,":")}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"setElemInnerHTML",args:{selector:"#player-controller_current-time",html:secondsTohhmmss(event.target.currentTime,":")}})}),domManipulations.changeSliderValue({selector:"#player-controller_song-range",value:event.target.currentTime/event.target.duration*100}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"changeSliderValue",args:{selector:"#player-controller_song-range",value:event.target.currentTime/event.target.duration*100}})})}),document.querySelector("#player-controller_song-range").addEventListener("input",function(event){isNaN(player.elem.duration)||(player.elem.currentTime=event.currentTarget.value*player.elem.duration/100)}),document.querySelector("#player-controller_volume-range").addEventListener("input",function(event){connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"changeSliderValue",args:{selector:"#player-controller_volume-range",value:event.target.value}})}),player.elem.volume=event.target.value/100}),player.clean=function(){domManipulations.cleanPlayer(),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"cleanPlayer"})}),player.previousSong=null,player.currentSong=null,player.elem.src=""},player.elem.addEventListener("play",function(){domManipulations.setPlayPauseBtnIcon({icon:"pause"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"setPlayPauseBtnIcon",args:{icon:"pause"}})})}),player.elem.addEventListener("pause",function(){domManipulations.setPlayPauseBtnIcon({icon:"play_arrow"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"setPlayPauseBtnIcon",args:{icon:"play_arrow"}})})}),document.querySelector("#player-controller_loop-btn").addEventListener("click",function(event){event.currentTarget.classList.contains("loop-true")?(domManipulations.removeClassFromElem({selector:"#player-controller_loop-btn",className:"loop-true"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"removeClassFromElem",args:{selector:"#player-controller_loop-btn",className:"loop-true"}})}),player.loop=!1):(domManipulations.addClassToElem({selector:"#player-controller_loop-btn",className:"loop-true"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"addClassToElem",args:{selector:"#player-controller_loop-btn",className:"loop-true"}})}),player.loop=!0)}),document.querySelector("#player-controller_shuffle-btn").addEventListener("click",function(event){event.currentTarget.classList.contains("shuffle-true")?(domManipulations.removeClassFromElem({selector:"#player-controller_shuffle-btn",className:"shuffle-true"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"removeClassFromElem",args:{selector:"#player-controller_shuffle-btn",className:"shuffle-true"}})}),player.shuffle=!1):(domManipulations.addClassToElem({selector:"#player-controller_shuffle-btn",className:"shuffle-true"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"addClassToElem",args:{selector:"#player-controller_shuffle-btn",className:"shuffle-true"}})}),player.shuffle=!0)}),document.querySelector("#player-controller_broadcast-btn").addEventListener("click",function(event){event.currentTarget.classList.contains("broadcast-true")?(domManipulations.removeClassFromElem({selector:"#player-controller_broadcast-btn",className:"broadcast-true"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"removeClassFromElem",args:{selector:"#player-controller_broadcast-btn",className:"broadcast-true"}})}),player.setBroadcast(),player.broadcast=!1):(domManipulations.addClassToElem({selector:"#player-controller_broadcast-btn",className:"broadcast-true"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"addClassToElem",args:{selector:"#player-controller_broadcast-btn",className:"broadcast-true"}})}),player.currentSong&&player.setBroadcast(player.currentSong),player.broadcast=!0)}),player.playNextSong=function(event){if(player.currentSong&&document.querySelector('.songlist[data-syncing-with-current-playlist-section-songlist="true"]')){if(!player.loop&&player.currentSonglist&&1===player.currentSonglist.children.length&&!player.currentSonglist.classList.contains("postlists_item_songlist"))return player.elem.pause(),void(player.elem.currentTime=0);if(player.loop&&event.target===player.elem)return player.elem.currentTime=0,void player.elem.play();if(player.shuffle&&1!==player.currentSonglist.children.length){var nextSongNum=getRandomIntFromTo(0,currentPlaylistSectionSonglist.children.length-1);player.playSong(currentPlaylistSectionSonglist.children[nextSongNum])}else if(player.currentSong.nextElementSibling)player.playSong(player.currentSong.nextElementSibling);else if(player.currentSonglist.classList.contains("postlists_item_songlist")&&player.currentSonglist.parentNode.nextElementSibling){document.querySelector(".songlist_item.is-playing")&&(domManipulations.removeClassFromElem({selector:".songlist_item.is-playing",className:"is-playing"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"removeClassFromElem",args:{selector:".songlist_item.is-playing",className:"is-playing"}})})),document.querySelector(".songlist_item.current")&&(domManipulations.removeClassFromElem({selector:".songlist_item.current",className:"current"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"removeClassFromElem",args:{selector:".songlist_item.current",className:"current"}})}));var nextSonglist=player.currentSonglist.parentNode.nextElementSibling.querySelector(".songlist");nextSonglist.firstElementChild.dispatchEvent(new window.Event("click"))}else document.querySelector(".songlist_item.is-playing")&&(domManipulations.removeClassFromElem({selector:".songlist_item.is-playing",className:"is-playing"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"removeClassFromElem",args:{selector:".songlist_item.is-playing",className:"is-playing"}})}))}},player.playPreviousSong=function(){player.previousSong&&player.playSong(player.previousSong)};var myAudioSectionSonglist=document.querySelector("#my-audios-section_songlist");player.elem.addEventListener("ended",player.playNextSong),document.querySelector("#player-controller_skip-previous-btn").addEventListener("click",player.playPreviousSong),document.querySelector("#player-controller_skip-next-btn").addEventListener("click",player.playNextSong),document.querySelector("#player-controller_play-pause-btn").addEventListener("click",function(event){player.elem.paused?player.previousSong||player.currentSong?(player.elem.play(),domManipulations.addClassToElem({selector:".songlist_item.current",className:"is-playing"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"addClassToElem",args:{selector:".songlist_item.current",className:"is-playing"}})})):myAudioSectionSonglist.firstElementChild?player.playSong(myAudioSectionSonglist.firstElementChild):(domManipulations.showToast({innerText:chrome.i18n.getMessage("noSongsInPlaylist")||"У цьому плейлисті немає пісень"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"showToast",args:{innerText:chrome.i18n.getMessage("noSongsInPlaylist")||"У цьому плейлисті немає пісень"}})})):(player.elem.pause(),domManipulations.removeClassFromElem({selector:".songlist_item.is-playing",className:"is-playing"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"removeClassFromElem",args:{selector:".songlist_item.is-playing",className:"is-playing"}})}))}),document.querySelector("#drawer-panel_header").addEventListener("click",function(){domManipulations.navigateTo({sectionId:"#my-audios-section"})}),document.querySelector("#log-out-btn").addEventListener("click",function(){chrome.storage.local.remove(["vkAccessToken","vkUserID"],function(){window.dispatchEvent(new window.CustomEvent("logOut"))})}),document.querySelector("#profiles-section_tabs_broadcasting-tab").addEventListener("click",function(){domManipulations.showSpinner(),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"showSpinner"})}),vkRequest.send({method:"audio.getBroadcastList",requestParams:{access_token:vkAccessToken,user_id:vkUserID,active:1}}).then(function(response){domManipulations.cleanElemContent({selector:"#profiles-section_broadcasting-profiles"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"cleanElemContent",args:{selector:"#profiles-section_broadcasting-profiles"}})}),response.forEach(function(currentValue,index,array){"profile"===currentValue.type?(array[index].profileId=array[index].id,array[index].profileType="person",array[index].profileTitle=array[index].first_name+" "+array[index].last_name):(array[index].profileId=array[index].id,array[index].profileType="group",array[index].profileTitle=array[index].name)}),domManipulations.insertItemsIntoBroadcastingProfileslist({profileslistId:"profiles-section_broadcasting-profiles",profilesInfo:response}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"insertItemsIntoBroadcastingProfileslist",args:{profileslistId:"profiles-section_broadcasting-profiles",profilesInfo:response}})}),domManipulations.updateProfilesSectionSearch(),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"updateProfilesSectionSearch"})}),domManipulations.hideSpinner(),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"hideSpinner"})})})["catch"](function(err){domManipulations.hideSpinner(),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"hideSpinner"})}),domManipulations.showToast({innerText:chrome.i18n.getMessage("errorOccurred")||"Сталася помилка"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"showToast",args:{innerText:chrome.i18n.getMessage("errorOccurred")||"Сталася помилка"}})}),console.error(err)})}),document.querySelector("#player-controller_add-songs-to-audios-btn").addEventListener("click",function(event){if(0!==event.currentTarget.dataset.currentSongId.indexOf(vkUserID)){domManipulations.showSpinner(),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"showSpinner"})});var songId=event.currentTarget.dataset.currentSongId;vkRequest.send({method:"audio.add",requestParams:{access_token:vkAccessToken,user_id:vkUserID,audio_id:songId.split("_")[1],owner_id:songId.split("_")[0]}}).then(function(response){if("number"!=typeof response)throw new Error("Сталася помилка");var newSonglistItemElem=player.currentSong.cloneNode(!0);newSonglistItemElem.dataset.songClass=vkUserID+"_"+response,domManipulations.prependElemWithHTML({html:newSonglistItemElem.outerHTML,parentElemSelector:"#my-audios-section_songlist"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"prependElemWithHTML",args:{html:newSonglistItemElem.outerHTML,parentElemSelector:"#my-audios-section_songlist"}})}),domManipulations.addAttributeToElem({selector:"#player-controller_add-songs-to-audios-btn",attrName:"data-current-song-id",attrValue:vkUserID+"_"+response}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"addAttributeToElem",args:{selector:"#player-controller_add-songs-to-audios-btn",attrName:"data-current-song-id",attrValue:vkUserID+"_"+response}})}),domManipulations.hideSpinner(),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"hideSpinner"})}),domManipulations.showToast({innerText:chrome.i18n.getMessage("added")||"Додано"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"showToast",args:{innerText:chrome.i18n.getMessage("added")||"Додано"}})})})["catch"](function(err){domManipulations.hideSpinner(),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"hideSpinner"})}),domManipulations.showToast({innerText:chrome.i18n.getMessage("errorOccurred")||"Сталася помилка"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"showToast",args:{innerText:chrome.i18n.getMessage("errorOccurred")||"Сталася помилка"}})}),console.error(err)})}})}(),chrome.storage.local.get(["vkAccessToken","vkUserID"],function(userAuthData){window.vkAccessToken=userAuthData.vkAccessToken,window.vkUserID=userAuthData.vkUserID,domManipulations.showSpinner(),vkRequest.send({method:"execute.getDataForAppInit",requestParams:{access_token:vkAccessToken,user_id:vkUserID}}).then(function(response){domManipulations.insertUserInfoIntoDrawerHeader(response.userInfo),domManipulations.insertItemsIntoSonglist({songlistId:"my-audios-section_songlist",songInfo:response.userAudios.items}),document.body.classList.add("user-audios-loaded");var myAudiosSectionLoadMoreBtn=document.getElementById("my-audios-section_load-more-songs-btn"),myAudioSectionSonglist=document.getElementById("my-audios-section_songlist");+response.userAudiosCount<41?domManipulations.addAttributeToElem({selector:"#my-audios-section_load-more-songs-btn",attrName:"hidden",attrValue:"true"}):(myAudioSectionSonglist.dataset.userAudiosCount=response.userAudiosCount,myAudioSectionSonglist.dataset.userAudiosLoaded=40,myAudiosSectionLoadMoreBtn.addEventListener("click",function(){domManipulations.showSpinner(),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"showSpinner"})}),vkRequest.send({method:"audio.get",requestParams:{access_token:vkAccessToken,user_id:vkUserID,count:20,offset:myAudioSectionSonglist.dataset.userAudiosLoaded}}).then(function(audioData){domManipulations.insertItemsIntoSonglist({songlistId:"my-audios-section_songlist",songInfo:audioData.items}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"insertItemsIntoSonglist",args:{songlistId:"my-audios-section_songlist",songInfo:audioData.items}})}),myAudioSectionSonglist.dataset.userAudiosLoaded=+myAudioSectionSonglist.dataset.userAudiosLoaded+20,myAudioSectionSonglist.children.length<+myAudioSectionSonglist.dataset.userAudiosCount&&myAudioSectionSonglist.children.length<6e3||(domManipulations.addAttributeToElem({selector:"#my-audios-section_load-more-songs-btn",attrName:"hidden",attrValue:"true"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"addAttributeToElem",args:{selector:"#my-audios-section_load-more-songs-btn",attrName:"hidden",attrValue:"true"}})})),domManipulations.hideSpinner(),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"hideSpinner"})})})["catch"](function(err){domManipulations.hideSpinner(),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"hideSpinner"})}),domManipulations.showToast({innerText:chrome.i18n.getMessage("errorOccurred")||"Сталася помилка"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"showToast",args:{innerText:chrome.i18n.getMessage("errorOccurred")||"Сталася помилка"}})}),console.error(err)})})),response.friendsWithOpenedAudios.forEach(function(currentValue,index,array){array[index].profileId=array[index].id,array[index].profileType="person",array[index].profileTitle=array[index].first_name+" "+array[index].last_name}),domManipulations.insertItemsIntoProfileslist({profileslistId:"profiles-section_friends-profiles",profilesInfo:response.friendsWithOpenedAudios}),response.userGroups.items.forEach(function(currentValue,index,array){array[index].profileId="-"+array[index].id,array[index].profileType="group",array[index].profileTitle=array[index].name}),domManipulations.insertItemsIntoProfileslist({profileslistId:"profiles-section_groups-profiles",profilesInfo:response.userGroups.items}),response.broadcastingFriends.forEach(function(currentValue,index,array){"profile"===currentValue.type?(array[index].profileId=array[index].id,array[index].profileType="person",array[index].profileTitle=array[index].first_name+" "+array[index].last_name):(array[index].profileId=array[index].id,array[index].profileType="group",array[index].profileTitle=array[index].name)}),response.broadcastingFriends&&domManipulations.insertItemsIntoBroadcastingProfileslist({profileslistId:"profiles-section_broadcasting-profiles",profilesInfo:response.broadcastingFriends}),domManipulations.updateProfilesSectionSearch(),domManipulations.injectStyles({rules:['.player-controller_add-songs-to-audios-btn[data-current-song-id^="'+vkUserID+'"] {pointer-events: none;display: none;}']}),domManipulations.hideSpinner()})["catch"](function(err){domManipulations.hideSpinner(),domManipulations.showToast({innerText:chrome.i18n.getMessage("errorOccurred")||"Сталася помилка"}),connectedSockets.forEach(function(socket){sendDomManipulationsMessage({socket:socket,"function":"showToast",args:{innerText:chrome.i18n.getMessage("errorOccurred")||"Сталася помилка"}})}),console.error(err)})});